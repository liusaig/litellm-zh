"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3502],{36904:(e,t,s)=>{s.d(t,{$n:()=>r.A,BF:()=>l.A,Hj:()=>c.A,M_:()=>i.A,XI:()=>a.A,nA:()=>n.A,nd:()=>o.A});var r=s(38983),a=s(30489),l=s(96961),n=s(95517),o=s(8179),i=s(31556),c=s(95171)},43502:(e,t,s)=>{s.d(t,{A:()=>eV});var r=s(95155),a=s(12115),l=s(67667),n=s(3373),o=s(28436),i=s(36904),c=s(45588),d=s(14992),m=s(17293),p=s(73946),x=s(22277),h=s(34537),u=s(37621),g=s(3134),f=s(90314);let j=e=>{let t=new Set,s=/\{\{(\w+)\}\}/g;if(e.messages.forEach(e=>{let r;for(;null!==(r=s.exec(e.content));)t.add(r[1])}),e.developerMessage){let r;for(;null!==(r=s.exec(e.developerMessage));)t.add(r[1])}return Array.from(t)},y=e=>{let t=j(e),s=`---
model: ${e.model}
`;return void 0!==e.config.temperature&&(s+=`temperature: ${e.config.temperature}
`),void 0!==e.config.max_tokens&&(s+=`max_tokens: ${e.config.max_tokens}
`),void 0!==e.config.top_p&&(s+=`top_p: ${e.config.top_p}
`),s+=`input:
  schema:
`,t.forEach(e=>{s+=`    ${e}: string
`}),s+=`output:
  format: text
`,e.tools&&e.tools.length>0&&(s+=`tools:
`,e.tools.forEach(e=>{let t=JSON.parse(e.json);s+=`  - ${JSON.stringify(t)}
`})),s+=`---

`,e.developerMessage&&""!==e.developerMessage.trim()&&(s+=`Developer: ${e.developerMessage.trim()}

`),e.messages.forEach(e=>{let t=e.role.charAt(0).toUpperCase()+e.role.slice(1);s+=`${t}: ${e.content}

`}),s.trim()},v=e=>{let t=Number(e);return Number.isFinite(t)?t:void 0},b=e=>{let t=e?.prompt_spec?.litellm_params?.dotprompt_content||"";if(!t)throw Error("No dotprompt_content found in API response");let s=t.split("---");if(s.length<3)throw Error("Invalid dotprompt format");let r=s[1],a=s.slice(2).join("---").trim(),l=(e=>{let t={config:{},tools:[]},s=e.split("\n");for(let e of(t.tools=(e=>{let t=[],s=!1;for(let r of e){let e=r.trim();if(!s){("tools:"===e||e.startsWith("tools:"))&&(s=!0);continue}if(r.length>0&&!/^\s/.test(r)&&"-"!==e&&!e.startsWith("-"))break;let a=e.match(/^-+\s*(.+)$/);if(!a)continue;let l=a[1].trim();if(l)try{let e=JSON.parse(l);t.push({name:e?.function?.name||"Unnamed Tool",description:e?.function?.description||"",json:JSON.stringify(e,null,2)})}catch{}}return t})(s),s)){let s=e.trim();if(!s||s.startsWith("input:")||s.startsWith("output:")||s.startsWith("schema:")||s.startsWith("format:")||s.startsWith("tools:")||s.startsWith("-"))continue;let r=s.indexOf(":");if(r<=0)continue;let a=s.substring(0,r).trim(),l=s.substring(r+1).trim();if("model"===a){t.model=l;continue}"temperature"===a&&(t.config.temperature=v(l)),"max_tokens"===a&&(t.config.max_tokens=v(l)),"top_p"===a&&(t.config.top_p=v(l))}return t})(r),n=(e=>{let t=/^(System|Developer|User|Assistant):(?:\s(.*)|\s*)$/,s=[],r="",a=null,l=[],n=()=>{if(!a)return;let e=l.join("\n").trim();"developer"===a?e&&(r=r?`${r}

${e}`:e):e?s.push({role:a,content:e}):s.push({role:a,content:""})};for(let s of e.split("\n")){let e=s.match(t);if(e){n(),a=e[1].toLowerCase(),l=[e[2]??""];continue}a&&l.push(s)}return n(),{developerMessage:r,messages:s}})(a),o=e?.prompt_spec?.prompt_id||"Unnamed Prompt";return{name:N(o)||o,model:l.model||"gpt-4o",config:l.config,tools:l.tools,developerMessage:n.developerMessage,messages:n.messages.length>0?n.messages:[{role:"user",content:"Enter task specifics. Use {{template_variables}} for dynamic inputs"}]}},N=e=>e?e.replace(/[._-]v\d+$/,""):"",w=e=>e?.prompt_id||"",A=e=>{try{let t=e.litellm_params;if(t?.dotprompt_content){let e=t.dotprompt_content.match(/model:\s*([^\n]+)/);if(e)return e[1].trim()}if(t?.prompt_data?.model)return t.prompt_data.model;if(t?.model)return t.model;return null}catch(e){return console.error("Error extracting model:",e),null}},_=({promptsList:e,isLoading:t,onPromptClick:s,onDeleteClick:l,accessToken:n,isAdmin:j})=>{let[y,v]=(0,a.useState)([{id:"created_at",desc:!0}]),[b,N]=(0,a.useState)(new Map);(0,a.useEffect)(()=>{(async()=>{if(n)try{let e=await (0,o.modelHubCall)(n);if(e?.data){let t=new Map;e.data.forEach(e=>{t.set(e.model_group,e)}),N(t)}}catch(e){console.error("Error fetching model hub data:",e)}})()},[n]);let w=e=>e?new Date(e).toLocaleString():"-",_=[{header:"Prompt ID",accessorKey:"prompt_id",cell:e=>{let t=String(e.getValue()||""),a=t.length>25?`${t.slice(0,25)}...`:t;return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(x.A,{title:t,children:(0,r.jsx)(i.$n,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate min-w-[220px] justify-start",onClick:()=>e.getValue()&&s?.(e.getValue()),children:a})}),(0,r.jsx)(x.A,{title:"Copy prompt ID",children:(0,r.jsx)(h.A,{onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(t)},className:"cursor-pointer text-gray-500 hover:text-blue-500 text-xs"})})]})}},{header:"Model",accessorKey:"model",cell:({row:e})=>{let t=A(e.original);if(!t)return(0,r.jsx)("span",{className:"text-xs text-gray-400",children:"-"});let s=((e,t)=>{if(!e)return null;let s=t.get(e);return s&&s.providers&&s.providers.length>0?s.providers[0]:null})(t,b),{logo:a}=(0,f.li)(s||"");return(0,r.jsx)(x.A,{title:t,children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:s&&a?(0,r.jsx)("img",{src:a,alt:`${s} logo`,className:"w-4 h-4",onError:e=>{let t=e.currentTarget,r=t.parentElement;if(r&&r.contains(t))try{let e=document.createElement("div");e.className="w-4 h-4 rounded-full bg-gray-200 flex items-center justify-center text-xs",e.textContent=s?.charAt(0)||"-",r.replaceChild(e,t)}catch(e){console.error("Failed to replace provider logo fallback:",e)}}}):(0,r.jsx)("div",{className:"w-4 h-4 rounded-full bg-gray-200 flex items-center justify-center text-xs",children:"-"})}),(0,r.jsx)("span",{className:"max-w-[15ch] truncate block",children:t})]})})}},{header:"Created At",accessorKey:"created_at",cell:({row:e})=>{let t=e.original;return(0,r.jsx)(x.A,{title:t.created_at,children:(0,r.jsx)("span",{className:"text-xs",children:w(t.created_at)})})}},{header:"Updated At",accessorKey:"updated_at",cell:({row:e})=>{let t=e.original;return(0,r.jsx)(x.A,{title:t.updated_at,children:(0,r.jsx)("span",{className:"text-xs",children:w(t.updated_at)})})}},{header:"Type",accessorKey:"prompt_info.prompt_type",cell:({row:e})=>{let t=e.original;return(0,r.jsx)(x.A,{title:t.prompt_info.prompt_type,children:(0,r.jsx)("span",{className:"text-xs",children:t.prompt_info.prompt_type})})}},...j?[{header:"Actions",id:"actions",enableSorting:!1,cell:({row:e})=>{let t=e.original,s=t.prompt_id||"Unknown Prompt";return(0,r.jsx)("div",{className:"flex items-center gap-1",children:(0,r.jsx)(x.A,{title:"Delete prompt",children:(0,r.jsx)(i.$n,{size:"xs",variant:"light",color:"red",onClick:e=>{e.stopPropagation(),l?.(t.prompt_id,s)},icon:c.A,className:"text-red-500 hover:text-red-700 hover:bg-red-50"})})})}}]:[]],k=(0,u.N4)({data:e,columns:_,state:{sorting:y},onSortingChange:v,getCoreRowModel:(0,g.HT)(),getSortedRowModel:(0,g.h5)(),enableSorting:!0});return(0,r.jsx)("div",{className:"rounded-lg custom-border relative",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(i.XI,{className:"[&_td]:py-0.5 [&_th]:py-1",children:[(0,r.jsx)(i.nd,{children:k.getHeaderGroups().map(e=>(0,r.jsx)(i.Hj,{children:e.headers.map(e=>(0,r.jsx)(i.M_,{className:"py-1 h-8",onClick:e.column.getToggleSortingHandler(),children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:"flex items-center",children:e.isPlaceholder?null:(0,u.Kv)(e.column.columnDef.header,e.getContext())}),(0,r.jsx)("div",{className:"w-4",children:e.column.getIsSorted()?({asc:(0,r.jsx)(d.A,{className:"h-4 w-4 text-blue-500"}),desc:(0,r.jsx)(m.A,{className:"h-4 w-4 text-blue-500"})})[e.column.getIsSorted()]:(0,r.jsx)(p.A,{className:"h-4 w-4 text-gray-400"})})]})},e.id))},e.id))}),(0,r.jsx)(i.BF,{children:t?(0,r.jsx)(i.Hj,{children:(0,r.jsx)(i.nA,{colSpan:_.length,className:"h-8 text-center",children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:(0,r.jsx)("p",{children:"Loading..."})})})}):e.length>0?k.getRowModel().rows.map(e=>(0,r.jsx)(i.Hj,{className:"h-8",children:e.getVisibleCells().map(e=>(0,r.jsx)(i.nA,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,u.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,r.jsx)(i.Hj,{children:(0,r.jsx)(i.nA,{colSpan:_.length,className:"h-8 text-center",children:(0,r.jsx)("div",{className:"text-center text-gray-500",children:(0,r.jsx)("p",{children:"No prompts found"})})})})})]})})})};var k=s(16252),C=s(87278),S=s(44926),$=s(44993),E=s(88534),P=s(94514),T=s(67635),O=s(12120),D=s(23060),I=s(99904),z=s(99749),L=s(50410),F=s(27397),M=s(8470);let B=({promptId:e,model:t,promptVariables:s={},accessToken:l,version:o="1",proxySettings:i})=>{let[c,d]=(0,a.useState)(!1),[m,p]=(0,a.useState)("curl"),[x,h]=(0,a.useState)("basic"),[u,g]=(0,a.useState)(""),f=window.location.origin,j=i?.LITELLM_UI_API_DOC_BASE_URL;j&&j.trim()?f=j:i?.PROXY_BASE_URL&&(f=i.PROXY_BASE_URL);let y=l||"sk-1234";return a.useEffect(()=>{c&&g((()=>{let r=Object.keys(s).length>0;if("curl"===m)if("basic"===x)return`curl -X POST '${f}/chat/completions' \\
  -H 'Content-Type: application/json' \\
  -H 'Authorization: Bearer ${y}' \\
  -d '{
    "model": "${t}",
    "prompt_id": "${e}"${r?`,
    "prompt_variables": ${JSON.stringify(s,null,6).replace(/\n/g,"\n    ")}`:""}
  }' | jq`;else if("messages"===x)return`curl -X POST '${f}/chat/completions' \\
  -H 'Content-Type: application/json' \\
  -H 'Authorization: Bearer ${y}' \\
  -d '{
    "model": "${t}",
    "prompt_id": "${e}"${r?`,
    "prompt_variables": ${JSON.stringify(s,null,6).replace(/\n/g,"\n    ")}`:""},
    "messages": [
      {
        "role": "user",
        "content": "hi"
      }
    ]
  }' | jq`;else return`curl -X POST '${f}/chat/completions' \\
  -H 'Content-Type: application/json' \\
  -H 'Authorization: Bearer ${y}' \\
  -d '{
    "model": "${t}",
    "prompt_id": "${e}",
    "prompt_version": ${o},
    "messages": [
      {
        "role": "user",
        "content": "Who are u"
      }
    ]
  }' | jq`;if("python"===m){let a=`import openai

client = openai.OpenAI(
    api_key="${y}",
    base_url="${f}"
)
`;return"basic"===x?`${a}
response = client.chat.completions.create(
    model="${t}",
    extra_body={
        "prompt_id": "${e}"${r?`,
        "prompt_variables": ${JSON.stringify(s,null,8).replace(/\n/g,"\n        ")}`:""}
    }
)

print(response)`:"messages"===x?`${a}
response = client.chat.completions.create(
    model="${t}",
    messages=[
        {"role": "user", "content": "hi"}
    ],
    extra_body={
        "prompt_id": "${e}"${r?`,
        "prompt_variables": ${JSON.stringify(s,null,8).replace(/\n/g,"\n        ")}`:""}
    }
)

print(response)`:`${a}
response = client.chat.completions.create(
    model="${t}",
    messages=[
        {"role": "user", "content": "Who are u"}
    ],
    extra_body={
        "prompt_id": "${e}",
        "prompt_version": ${o}
    }
)

print(response)`}{let a=`import OpenAI from 'openai';

const client = new OpenAI({
    apiKey: "${y}",
    baseURL: "${f}"
});
`;return"basic"===x?`${a}
async function main() {
    const response = await client.chat.completions.create({
        model: "${t}",
        ${r?`prompt_id: "${e}",
        prompt_variables: ${JSON.stringify(s,null,8).replace(/\n/g,"\n        ")}`:`prompt_id: "${e}"`}
    });
    
    console.log(response);
}

main();`:"messages"===x?`${a}
async function main() {
    const response = await client.chat.completions.create({
        model: "${t}",
        messages: [
            { role: "user", content: "hi" }
        ],
        ${r?`prompt_id: "${e}",
        prompt_variables: ${JSON.stringify(s,null,8).replace(/\n/g,"\n        ")}`:`prompt_id: "${e}"`}
    });
    
    console.log(response);
}

main();`:`${a}
async function main() {
    const response = await client.chat.completions.create({
        model: "${t}",
        messages: [
            { role: "user", content: "Who are u" }
        ],
        prompt_id: "${e}",
        prompt_version: ${o}
    });
    
    console.log(response);
}

main();`}})())},[c,m,x,e,t,s]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L.$,{variant:"secondary",icon:z.A,onClick:()=>{d(!0)},children:"Get Code"}),(0,r.jsxs)(n.A,{title:"Generated Code",open:c,onCancel:()=>{d(!1)},footer:null,width:800,children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(L.E,{className:"font-medium block mb-1 text-gray-700",children:"Language"}),(0,r.jsx)(D.A,{value:m,onChange:e=>p(e),style:{width:180},options:[{value:"curl",label:"cURL"},{value:"python",label:"Python (OpenAI SDK)"},{value:"javascript",label:"JavaScript (OpenAI SDK)"}]})]}),(0,r.jsx)(C.Ay,{onClick:()=>{navigator.clipboard.writeText(u),O.Ay.success("Copied to clipboard!")},children:"Copy to Clipboard"})]}),(0,r.jsx)(I.A,{activeKey:x,onChange:h,items:[{label:"Basic",key:"basic"},{label:"With Messages",key:"messages"},{label:"With Version",key:"version"}]}),(0,r.jsx)(F.A,{language:"curl"===m?"bash":"python"===m?"python":"javascript",style:M.A,wrapLines:!0,wrapLongLines:!0,className:"rounded-md mt-0",customStyle:{maxHeight:"60vh",overflowY:"auto",marginTop:0,borderTopLeftRadius:0,borderTopRightRadius:0},children:u})]})]})},J=({promptId:e,onClose:t,accessToken:s,isAdmin:l,onDelete:i,onEdit:d})=>{let[m,p]=(0,a.useState)(null),[x,h]=(0,a.useState)(null),[u,g]=(0,a.useState)(null),[f,j]=(0,a.useState)(!0),[y,v]=(0,a.useState)({}),[b,N]=(0,a.useState)(!1),[_,D]=(0,a.useState)(!1),I=async()=>{try{if(j(!0),!s)return;let t=await (0,o.getPromptInfo)(s,e);p(t.prompt_spec),h(t.raw_prompt_template),g(t)}catch(e){O.Ay.fromBackend("Failed to load prompt information"),console.error("Error fetching prompt info:",e)}finally{j(!1)}};if((0,a.useEffect)(()=>{I()},[e,s]),f)return(0,r.jsx)("div",{className:"p-4",children:"Loading..."});if(!m)return(0,r.jsx)("div",{className:"p-4",children:"Prompt not found"});let z=e=>e?new Date(e).toLocaleString():"-",L=async(e,t)=>{await (0,E.lW)(e)&&(v(e=>({...e,[t]:!0})),setTimeout(()=>{v(e=>({...e,[t]:!1}))},2e3))},F=async()=>{if(s&&m){D(!0);try{await (0,o.deletePromptCall)(s,J),O.Ay.success(`Prompt "${J}" deleted successfully`),i?.(),t()}catch(e){console.error("Error deleting prompt:",e),O.Ay.fromBackend("Failed to delete prompt")}finally{D(!1),N(!1)}}},M=m&&A(m)||"gpt-4o",J=w(m),R=(e=>{let t;if(e?.version)return String(e.version);var s=(t=w(e),e?.litellm_params?.prompt_id||t);if(!s)return"1";let r=s.match(/[._-]v(\d+)$/);return r?r[1]:"1"})(m);return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(k.$n,{icon:S.A,variant:"light",onClick:t,className:"mb-4",children:"Back to Prompts"}),(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(k.hE,{children:"Prompt Details"}),(0,r.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,r.jsx)(k.EY,{className:"text-gray-500 font-mono",children:J}),(0,r.jsx)(C.Ay,{type:"text",size:"small",icon:y["prompt-id"]?(0,r.jsx)(P.A,{size:12}):(0,r.jsx)(T.A,{size:12}),onClick:()=>L(J,"prompt-id"),className:`left-2 z-10 transition-all duration-200 ${y["prompt-id"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(B,{promptId:J,model:M,promptVariables:(e=>{let t;if(!e)return{};let s={},r=/\{\{(\w+)\}\}/g;for(;null!==(t=r.exec(e));){let e=t[1];s[e]||(s[e]=`example_${e}`)}return s})(x?.content),accessToken:s,version:R}),(0,r.jsx)(k.$n,{icon:$.A,variant:"primary",onClick:()=>d?.(u),className:"flex items-center",children:"Prompt Studio"}),l&&(0,r.jsx)(k.$n,{icon:c.A,variant:"secondary",onClick:()=>{N(!0)},className:"flex items-center",children:"Delete Prompt"})]})]})]}),(0,r.jsxs)(k.fu,{children:[(0,r.jsxs)(k.wb,{className:"mb-4",children:[(0,r.jsx)(k.oz,{children:"Overview"},"overview"),x?(0,r.jsx)(k.oz,{children:"Prompt Template"},"prompt-template"):(0,r.jsx)(r.Fragment,{}),l?(0,r.jsx)(k.oz,{children:"Details"},"details"):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)(k.oz,{children:"Raw JSON"},"raw-json")]}),(0,r.jsxs)(k.T2,{children:[(0,r.jsxs)(k.Kp,{children:[(0,r.jsxs)(k.xA,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.EY,{children:"Prompt ID"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(k.hE,{className:"font-mono text-sm",children:J})})]}),(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.EY,{children:"Version"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)(k.hE,{children:R}),(0,r.jsxs)(k.Ex,{color:"blue",className:"mt-1",children:["v",R]})]})]}),(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.EY,{children:"Prompt Type"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)(k.hE,{children:m.prompt_info?.prompt_type||"-"}),(0,r.jsx)(k.Ex,{color:"blue",className:"mt-1",children:m.prompt_info?.prompt_type||"Unknown"})]})]}),(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.EY,{children:"Created At"}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)(k.hE,{children:z(m.created_at)}),(0,r.jsxs)(k.EY,{children:["Last Updated: ",z(m.updated_at)]})]})]})]}),m.litellm_params&&Object.keys(m.litellm_params).length>0&&(0,r.jsxs)(k.Zp,{className:"mt-6",children:[(0,r.jsx)(k.EY,{className:"font-medium",children:"Silinex Parameters"}),(0,r.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md",children:(0,r.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap",children:JSON.stringify(m.litellm_params,null,2)})})]})]}),x&&(0,r.jsx)(k.Kp,{children:(0,r.jsxs)(k.Zp,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)(k.hE,{children:"Prompt Template"}),(0,r.jsx)(C.Ay,{type:"text",size:"small",icon:y["prompt-content"]?(0,r.jsx)(P.A,{size:16}):(0,r.jsx)(T.A,{size:16}),onClick:()=>L(x.content,"prompt-content"),className:`transition-all duration-200 ${y["prompt-content"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:y["prompt-content"]?"Copied!":"Copy Content"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(k.EY,{className:"font-medium",children:"Template ID"}),(0,r.jsx)("div",{className:"font-mono text-sm bg-gray-50 p-2 rounded",children:x.litellm_prompt_id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(k.EY,{className:"font-medium",children:"Content"}),(0,r.jsx)("div",{className:"mt-2 p-4 bg-gray-50 rounded-md border overflow-auto max-h-96",children:(0,r.jsx)("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:x.content})})]}),x.metadata&&Object.keys(x.metadata).length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)(k.EY,{className:"font-medium",children:"Template Metadata"}),(0,r.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:(0,r.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap overflow-auto max-h-64",children:JSON.stringify(x.metadata,null,2)})})]})]})]})}),l&&(0,r.jsx)(k.Kp,{children:(0,r.jsxs)(k.Zp,{children:[(0,r.jsx)(k.hE,{className:"mb-4",children:"Prompt Details"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(k.EY,{className:"font-medium",children:"Prompt ID"}),(0,r.jsx)("div",{className:"font-mono text-sm bg-gray-50 p-2 rounded",children:J})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(k.EY,{className:"font-medium",children:"Prompt Type"}),(0,r.jsx)("div",{children:m.prompt_info?.prompt_type||"-"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(k.EY,{className:"font-medium",children:"Created At"}),(0,r.jsx)("div",{children:z(m.created_at)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(k.EY,{className:"font-medium",children:"Last Updated"}),(0,r.jsx)("div",{children:z(m.updated_at)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(k.EY,{className:"font-medium",children:"Silinex Parameters"}),(0,r.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:(0,r.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap overflow-auto max-h-96",children:JSON.stringify(m.litellm_params,null,2)})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(k.EY,{className:"font-medium",children:"Prompt Info"}),(0,r.jsx)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border",children:(0,r.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap",children:JSON.stringify(m.prompt_info,null,2)})})]})]})]})}),(0,r.jsx)(k.Kp,{children:(0,r.jsxs)(k.Zp,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)(k.hE,{children:"Raw API Response"}),(0,r.jsx)(C.Ay,{type:"text",size:"small",icon:y["raw-json"]?(0,r.jsx)(P.A,{size:16}):(0,r.jsx)(T.A,{size:16}),onClick:()=>L(JSON.stringify(u,null,2),"raw-json"),className:`transition-all duration-200 ${y["raw-json"]?"text-green-600 bg-green-50 border-green-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:y["raw-json"]?"Copied!":"Copy JSON"})]}),(0,r.jsx)("div",{className:"p-4 bg-gray-50 rounded-md border overflow-auto",children:(0,r.jsx)("pre",{className:"text-xs text-gray-800 whitespace-pre-wrap",children:JSON.stringify(u,null,2)})})]})})]})]}),(0,r.jsxs)(n.A,{title:"Delete Prompt",open:b,onOk:F,onCancel:()=>{N(!1)},confirmLoading:_,okText:"Delete",okButtonProps:{danger:!0},children:[(0,r.jsxs)("p",{children:["Are you sure you want to delete prompt: ",(0,r.jsx)("strong",{children:J}),"?"]}),(0,r.jsx)("p",{children:"This action cannot be undone."})]})]})};var R=s(25387),U=s(7339),H=s(62823),V=s(73648),Y=s(46732);let{Option:W}=D.A,K=({visible:e,onClose:t,accessToken:s,onSuccess:l})=>{let[i]=R.A.useForm(),[c,d]=(0,a.useState)(!1),[m,p]=(0,a.useState)([]),[x,h]=(0,a.useState)("dotprompt"),u=()=>{i.resetFields(),p([]),h("dotprompt"),t()},g=async()=>{try{let e=await i.validateFields();if(console.log("values: ",e),!s)return void O.Ay.fromBackend("Access token is required");if("dotprompt"===x&&0===m.length)return void O.Ay.fromBackend("Please upload a .prompt file");d(!0);let t={};if("dotprompt"===x&&m.length>0){let r=m[0].originFileObj;try{let a=await (0,o.convertPromptFileToJson)(s,r);console.log("Conversion result:",a),t={prompt_id:e.prompt_id,litellm_params:{prompt_integration:"dotprompt",prompt_id:a.prompt_id,prompt_data:a.json_data},prompt_info:{prompt_type:"db"}}}catch(e){console.error("Error converting prompt file:",e),O.Ay.fromBackend("Failed to convert prompt file to JSON"),d(!1);return}}try{await (0,o.createPromptCall)(s,t),O.Ay.success("Prompt created successfully!"),u(),l()}catch(e){console.error("Error creating prompt:",e),O.Ay.fromBackend("Failed to create prompt")}}catch(e){console.error("Form validation error:",e)}finally{d(!1)}};return(0,r.jsx)(n.A,{title:"Add New Prompt",open:e,onCancel:u,footer:[(0,r.jsx)(C.Ay,{onClick:u,children:"Cancel"},"cancel"),(0,r.jsx)(C.Ay,{loading:c,onClick:g,children:"Create Prompt"},"submit")],width:600,children:(0,r.jsxs)(R.A,{form:i,layout:"vertical",requiredMark:!1,children:[(0,r.jsx)(R.A.Item,{label:"Prompt ID",name:"prompt_id",rules:[{required:!0,message:"Please enter a prompt ID"},{pattern:/^[a-zA-Z0-9_-]+$/,message:"Prompt ID can only contain letters, numbers, underscores, and hyphens"}],children:(0,r.jsx)(V.k,{placeholder:"Enter unique prompt ID (e.g., my_prompt_id)"})}),(0,r.jsx)(R.A.Item,{label:"Prompt Integration",name:"prompt_integration",initialValue:"dotprompt",children:(0,r.jsx)(D.A,{value:x,onChange:h,children:(0,r.jsx)(W,{value:"dotprompt",children:"dotprompt"})})}),"dotprompt"===x&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.A,{}),(0,r.jsxs)(R.A.Item,{label:"Prompt File",extra:"Upload a .prompt file that follows the Dotprompt specification",children:[(0,r.jsx)(H.A,{...{beforeUpload:e=>(e.name.endsWith(".prompt")||O.Ay.fromBackend("Please upload a .prompt file"),!1),fileList:m,onChange:({fileList:e})=>{p(e.slice(-1))},onRemove:()=>{p([])}},children:(0,r.jsx)(C.Ay,{icon:(0,r.jsx)(Y.A,{}),children:"Select .prompt File"})}),m.length>0&&(0,r.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",m[0].name]})]})]})]})})},q=`{
  "type": "function",
  "function": {
    "name": "get_current_weather",
    "description": "Get the current weather in a given location",
    "parameters": {
      "type": "object",
      "properties": {
        "location": {
          "type": "string",
          "description": "The city and state, e.g. San Francisco, CA"
        },
        "unit": {
          "type": "string",
          "enum": ["celsius", "fahrenheit"]
        }
      },
      "required": ["location"]
    }
  }
}`,Z=({visible:e,initialJson:t,onSave:s,onClose:l})=>{let[o,i]=(0,a.useState)(t||q),[c,d]=(0,a.useState)(null),m=()=>{d(null),l()};return(0,r.jsx)(n.A,{title:(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsx)("span",{className:"text-lg font-medium",children:"Add Tool"})}),open:e,onCancel:m,width:800,footer:[(0,r.jsx)(C.Ay,{onClick:m,children:"Cancel"},"cancel"),(0,r.jsx)(C.Ay,{type:"primary",onClick:()=>{try{JSON.parse(o),d(null),s(o)}catch(e){d("Invalid JSON format. Please check your syntax.")}},children:"Add"},"save")],children:(0,r.jsxs)("div",{className:"space-y-3",children:[c&&(0,r.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-red-600 text-sm",children:c}),(0,r.jsx)("textarea",{value:o,onChange:e=>i(e.target.value),className:"w-full min-h-[400px] px-4 py-3 border border-gray-300 rounded-lg text-sm font-mono focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Paste your tool JSON here..."})]})})};var X=s(91808),G=s(80723),Q=s(84980),ee=s(55243);let et=({promptName:e,onNameChange:t,onBack:s,onSave:a,isSaving:n,editMode:o=!1,onShowHistory:i,version:c,promptModel:d="gpt-4o",promptVariables:m={},accessToken:p,proxySettings:x})=>(0,r.jsxs)("div",{className:"bg-white border-b border-gray-200 px-6 py-3 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(l.$,{icon:G.A,variant:"light",onClick:s,size:"xs",children:"Back"}),(0,r.jsx)(X.A,{value:e,onChange:e=>t(e.target.value),className:"text-base font-medium border-none shadow-none",style:{width:"200px"}}),c&&(0,r.jsx)("span",{className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-700 rounded font-medium",children:c}),(0,r.jsx)("span",{className:"px-2 py-0.5 text-xs bg-gray-100 text-gray-600 rounded",children:"Draft"}),(0,r.jsx)("span",{className:"text-xs text-gray-400",children:"Unsaved changes"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(B,{promptId:e,model:d,promptVariables:m,accessToken:p,version:c?.replace("v","")||"1",proxySettings:x}),o&&i&&(0,r.jsx)(l.$,{icon:Q.A,variant:"secondary",onClick:i,children:"History"}),(0,r.jsx)(l.$,{icon:ee.A,onClick:a,loading:n,disabled:n,children:o?"Update":"Save"})]})]});var es=s(21796),er=s(89363),ea=s(78585);let el=({model:e,temperature:t=1,maxTokens:s=1e3,accessToken:l,onModelChange:n,onTemperatureChange:o,onMaxTokensChange:i})=>{let[c,d]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-[300px]",children:(0,r.jsx)(ea.A,{accessToken:l||"",value:e,onChange:n,showLabel:!1})}),(0,r.jsxs)("button",{onClick:()=>d(!c),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[(0,r.jsx)(er.A,{size:16}),(0,r.jsx)("span",{children:"Parameters"})]}),c&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Model Parameters"}),(0,r.jsx)("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)(es.E,{className:"text-sm text-gray-700",children:"Temperature"}),(0,r.jsx)(X.A,{type:"number",size:"small",min:0,max:2,step:.1,value:t,onChange:e=>o(parseFloat(e.target.value)||0),className:"w-20"})]})}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)(es.E,{className:"text-sm text-gray-700",children:"Max Tokens"}),(0,r.jsx)(X.A,{type:"number",size:"small",min:1,max:32768,value:s,onChange:e=>i(parseInt(e.target.value)||1e3),className:"w-24"})]})})]})]})})]})};var en=s(99988),eo=s(51914),ei=s(44440);let ec=({tools:e,onAddTool:t,onEditTool:s,onRemoveTool:a})=>(0,r.jsxs)(en.Z,{className:"p-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)(en.E,{className:"text-sm font-medium",children:"Tools"}),(0,r.jsxs)("button",{onClick:t,className:"text-xs text-blue-600 hover:text-blue-700 flex items-center",children:[(0,r.jsx)(eo.A,{size:14,className:"mr-1"}),"Add"]})]}),0===e.length?(0,r.jsx)(en.E,{className:"text-gray-500 text-xs",children:"No tools added"}):(0,r.jsx)("div",{className:"space-y-2",children:e.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 rounded",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("div",{className:"font-medium text-xs truncate",children:e.name}),(0,r.jsx)("div",{className:"text-xs text-gray-500 truncate",children:e.description})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 ml-2",children:[(0,r.jsx)("button",{onClick:()=>s(t),className:"text-xs text-blue-600 hover:text-blue-700",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>a(t),className:"text-gray-400 hover:text-red-500",children:(0,r.jsx)(ei.A,{size:14})})]})]},t))})]});var ed=s(23022),em=s(48849),ep=s(18404);let{TextArea:ex}=X.A,eh=({value:e,onChange:t,placeholder:s,rows:l=4,className:n})=>{let[o,i]=(0,a.useState)(null),[c,d]=(0,a.useState)(""),m=()=>{c.trim()&&o&&(t(e.substring(0,o.start)+`{{${c}}}`+e.substring(o.end)),i(null),d(""))},p=(()=>{let t,s=/\{\{(\w+)\}\}/g,r=[];for(;null!==(t=s.exec(e));)r.push({name:t[1],start:t.index,end:t.index+t[0].length});return r})();return(0,r.jsxs)("div",{className:`variable-textarea-container ${n}`,children:[(0,r.jsx)("style",{children:`
          .variable-highlight-text {
            color: #f97316;
            background-color: #fff7ed;
            border-radius: 4px;
            padding: 0 2px;
            border: 1px solid #fed7aa;
            font-family: monospace;
          }
        `}),(0,r.jsx)(ex,{value:e,onChange:e=>t(e.target.value),placeholder:s,rows:l,className:"font-sans"}),p.length>0&&(0,r.jsxs)("div",{className:"mt-2 flex flex-wrap gap-2 items-center",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500 mr-1",children:"Detected variables:"}),p.map((e,t)=>(0,r.jsx)(ed.A,{content:(0,r.jsxs)("div",{className:"p-2",style:{minWidth:"200px"},children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"Edit variable name"}),(0,r.jsx)(X.A,{size:"small",value:c,onChange:e=>d(e.target.value),onPressEnter:m,placeholder:"Variable name",autoFocus:!0}),(0,r.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,r.jsx)("button",{onClick:m,className:"text-xs px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Save"}),(0,r.jsx)("button",{onClick:()=>{i(null),d("")},className:"text-xs px-2 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:"Cancel"})]})]}),open:o?.start===e.start,onOpenChange:e=>{e||(i(null),d(""))},trigger:"click",children:(0,r.jsx)(em.A,{color:"orange",className:"cursor-pointer hover:opacity-80 transition-all m-0",icon:(0,r.jsx)(ep.A,{}),onClick:()=>{i({oldName:e.name,start:e.start,end:e.end}),d(e.name)},children:e.name})},`${e.start}-${t}`))]})]})},eu=({value:e,onChange:t})=>(0,r.jsxs)(en.Z,{className:"p-3",children:[(0,r.jsx)(en.E,{className:"block mb-2 text-sm font-medium",children:"Developer message"}),(0,r.jsx)(en.E,{className:"text-gray-500 text-xs mb-2",children:"Optional system instructions for the model"}),(0,r.jsx)(eh,{value:e,onChange:t,rows:3,placeholder:"e.g., You are a helpful assistant..."})]});var eg=s(59883);let{Option:ef}=D.A,ej=({messages:e,onAddMessage:t,onUpdateMessage:s,onRemoveMessage:l,onMoveMessage:n})=>{let[o,i]=(0,a.useState)(null),[c,d]=(0,a.useState)(null),m=()=>{i(null),d(null)};return(0,r.jsxs)(en.Z,{className:"p-3",children:[(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsx)(en.E,{className:"text-sm font-medium",children:"Prompt messages"}),(0,r.jsxs)(en.E,{className:"text-gray-500 text-xs mt-1",children:["Use ",(0,r.jsx)("code",{className:"bg-gray-100 px-1 rounded text-xs",children:"{{variable}}"})," syntax for template variables"]})]}),(0,r.jsx)("div",{className:"space-y-2",children:e.map((t,a)=>(0,r.jsxs)("div",{draggable:!0,onDragStart:()=>{i(a)},onDragOver:e=>{e.preventDefault(),d(a)},onDrop:e=>{e.preventDefault(),null!==o&&o!==a&&n(o,a),i(null),d(null)},onDragEnd:m,className:`border border-gray-300 rounded overflow-hidden bg-white transition-all ${o===a?"opacity-50":""} ${c===a&&o!==a?"border-blue-500 border-2":""}`,children:[(0,r.jsxs)("div",{className:"bg-gray-50 px-2 py-1.5 border-b border-gray-300 flex items-center justify-between",children:[(0,r.jsxs)(D.A,{value:t.role,onChange:e=>s(a,"role",e),style:{width:100},size:"small",bordered:!1,children:[(0,r.jsx)(ef,{value:"user",children:"User"}),(0,r.jsx)(ef,{value:"assistant",children:"Assistant"}),(0,r.jsx)(ef,{value:"system",children:"System"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[e.length>1&&(0,r.jsx)("button",{onClick:()=>l(a),className:"text-gray-400 hover:text-red-500",children:(0,r.jsx)(ei.A,{size:14})}),(0,r.jsx)("div",{className:"cursor-grab active:cursor-grabbing text-gray-400 hover:text-gray-600",children:(0,r.jsx)(eg.A,{size:16})})]})]}),(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(eh,{value:t.content,onChange:e=>s(a,"content",e),rows:3,placeholder:"Enter prompt content..."})})]},a))}),(0,r.jsxs)("button",{onClick:t,className:"mt-2 text-xs text-blue-600 hover:text-blue-700 flex items-center",children:[(0,r.jsx)(eo.A,{size:14,className:"mr-1"}),"Add message"]})]})};var ey=s(5723);let ev=({extractedVariables:e,variables:t,onVariableChange:s})=>0===e.length?null:(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200 bg-blue-50",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Fill in template variables to start testing"}),(0,r.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-xs text-gray-600 mb-1 font-medium",children:["{{",e,"}}"]}),(0,r.jsx)(X.A,{value:t[e]||"",onChange:t=>s(e,t.target.value),placeholder:`Enter value for ${e}`,size:"small"})]},e))})]});var eb=s(34568),eN=s(95049),ew=s(19910);let eA=({hasVariables:e})=>(0,r.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[(0,r.jsx)(ew.A,{style:{fontSize:"48px",marginBottom:"16px"}}),(0,r.jsx)("span",{className:"text-base",children:e?"Fill in the variables above, then type a message to start testing":"Type a message below to start testing your prompt"})]});var e_=s(24805),ek=s(76444),eC=s(79586);let eS=({message:e})=>(0,r.jsx)("div",{className:`mb-4 flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,r.jsxs)("div",{className:"max-w-[85%] rounded-lg shadow-sm p-3.5 px-4",style:{backgroundColor:"user"===e.role?"#f0f8ff":"#ffffff",border:"user"===e.role?"1px solid #e6f0fa":"1px solid #f0f0f0"},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full mr-1",style:{backgroundColor:"user"===e.role?"#e6f0fa":"#f5f5f5"},children:"user"===e.role?(0,r.jsx)(e_.A,{style:{fontSize:"12px",color:"#2563eb"}}):(0,r.jsx)(ew.A,{style:{fontSize:"12px",color:"#4b5563"}})}),(0,r.jsx)("strong",{className:"text-sm capitalize",children:e.role}),"assistant"===e.role&&e.model&&(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-100 text-gray-600 font-normal",children:e.model})]}),(0,r.jsxs)("div",{className:"whitespace-pre-wrap break-words max-w-full message-content",style:{wordWrap:"break-word",overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},children:["assistant"===e.role?(0,r.jsx)(ek.oz,{components:{code({node:e,inline:t,className:s,children:a,...l}){let n=/language-(\w+)/.exec(s||"");return!t&&n?(0,r.jsx)(F.A,{style:M.A,language:n[1],PreTag:"div",className:"rounded-md my-2",wrapLines:!0,wrapLongLines:!0,...l,children:String(a).replace(/\n$/,"")}):(0,r.jsx)("code",{className:`${s} px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono`,style:{wordBreak:"break-word"},...l,children:a})},pre:({node:e,...t})=>(0,r.jsx)("pre",{style:{overflowX:"auto",maxWidth:"100%"},...t})},children:e.content}):(0,r.jsx)("div",{className:"whitespace-pre-wrap",children:e.content}),"assistant"===e.role&&(e.timeToFirstToken||e.totalLatency||e.usage)&&(0,r.jsx)(eC.A,{timeToFirstToken:e.timeToFirstToken,totalLatency:e.totalLatency,usage:e.usage})]})]})}),e$=({messages:e,isLoading:t,hasVariables:s,messagesEndRef:a})=>{let l=(0,r.jsx)(eb.A,{style:{fontSize:24},spin:!0});return(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 pb-0",children:[0===e.length&&(0,r.jsx)(eA,{hasVariables:s}),e.map((e,t)=>(0,r.jsx)(eS,{message:e},t)),t&&(0,r.jsx)("div",{className:"flex justify-center items-center my-4",children:(0,r.jsx)(eN.A,{indicator:l})}),(0,r.jsx)("div",{ref:a,style:{height:"1px"}})]})},eE=({extractedVariables:e,variables:t})=>{let s=e.filter(e=>!t[e]||""===t[e].trim());return 0===s.length?null:(0,r.jsx)("div",{className:"mb-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-yellow-600 text-sm",children:"⚠️"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-sm text-yellow-800 font-medium mb-1",children:"Please fill in all template variables above"}),(0,r.jsxs)("p",{className:"text-xs text-yellow-700",children:["Missing: ",s.map(e=>`{{${e}}}`).join(", ")]})]})]})})};var eP=s(58872);let{TextArea:eT}=X.A,eO=({inputMessage:e,isLoading:t,isDisabled:s,onInputChange:a,onSend:n,onKeyDown:o,onCancel:i})=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center flex-1 bg-white border border-gray-300 rounded-xl px-3 py-1 min-h-[44px]",children:[(0,r.jsx)(eT,{value:e,onChange:e=>a(e.target.value),onKeyDown:o,placeholder:"Type your message... (Shift+Enter for new line)",disabled:t,className:"flex-1",autoSize:{minRows:1,maxRows:4},style:{resize:"none",border:"none",boxShadow:"none",background:"transparent",padding:"4px 0",fontSize:"14px",lineHeight:"20px"}}),(0,r.jsx)(l.$,{onClick:n,disabled:s,className:"flex-shrink-0 ml-2 !w-8 !h-8 !min-w-8 !p-0 !rounded-full !bg-blue-600 hover:!bg-blue-700 disabled:!bg-gray-300 !border-none !text-white disabled:!text-gray-500 !flex !items-center !justify-center",children:(0,r.jsx)(eP.A,{style:{fontSize:"14px"}})})]}),t&&(0,r.jsx)(l.$,{onClick:i,className:"bg-red-50 hover:bg-red-100 text-red-600 border-red-200",children:"Cancel"})]}),eD=({prompt:e,accessToken:t})=>{let{isLoading:s,messages:n,inputMessage:i,variables:c,variablesFilled:d,extractedVariables:m,allVariablesFilled:p,messagesEndRef:x,setInputMessage:h,handleSendMessage:u,handleCancelRequest:g,handleClearConversation:f,handleKeyDown:v,handleVariableChange:b}=((e,t)=>{let[s,r]=(0,a.useState)(!1),[l,n]=(0,a.useState)([]),[i,c]=(0,a.useState)(""),[d,m]=(0,a.useState)({}),[p,x]=(0,a.useState)(!1),[h,u]=(0,a.useState)(null),g=(0,a.useRef)(null),f=j(e),v=f.every(e=>d[e]&&""!==d[e].trim());(0,a.useEffect)(()=>{g.current&&setTimeout(()=>{g.current?.scrollIntoView({behavior:"smooth",block:"end"})},100)},[l]);let b=async()=>{let s;if(!t)return void O.Ay.fromBackend("Access token is required");if(f.length>0&&!v)return void O.Ay.fromBackend("Please fill in all template variables");if(!i.trim())return;!p&&f.length>0&&x(!0);let a={role:"user",content:i};n(e=>[...e,a]),c("");let m=new AbortController;u(m),r(!0);let h=Date.now();try{let r,a,c=y(e),p=(0,o.getProxyBaseUrl)(),x={dotprompt_content:c};0===l.length?x.prompt_variables=d:x.conversation_history=[...l.map(e=>({role:e.role,content:e.content})),{role:"user",content:i}];let u=await fetch(`${p}/prompts/test`,{method:"POST",headers:{[(0,o.getGlobalLitellmHeaderName)()]:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify(x),signal:m.signal});if(!u.ok){let e=await u.text();throw Error(`HTTP error! status: ${u.status}, ${e}`)}if(!u.body)throw Error("No response body");let g=u.body.getReader(),f=new TextDecoder,j="";for(n(e=>[...e,{role:"assistant",content:""}]);;){let{done:e,value:t}=await g.read();if(e)break;for(let e of f.decode(t).split("\n"))if(e.startsWith("data: ")){let t=e.slice(6);if("[DONE]"===t)continue;try{let e=JSON.parse(t);!r&&e.model&&(r=e.model),e.usage&&(a=e.usage);let l=e.choices?.[0]?.delta?.content;l&&(s||(s=Date.now()-h),j+=l,n(e=>{let t=[...e];return t[t.length-1]={role:"assistant",content:j,model:r,timeToFirstToken:s},t}))}catch(e){console.error("Error parsing chunk:",e)}}}let v=Date.now()-h;n(e=>{let t=[...e];return t[t.length-1]={...t[t.length-1],totalLatency:v,usage:a},t})}catch(e){"AbortError"===e.name?console.log("Request was cancelled"):(console.error("Error testing prompt:",e),n(t=>{let s=t[t.length-1];return s&&"assistant"===s.role&&""===s.content?[...t.slice(0,-1),{role:"assistant",content:`Error: ${e.message}`}]:[...t,{role:"assistant",content:`Error: ${e.message}`}]}))}finally{r(!1),u(null)}};return{isLoading:s,messages:l,inputMessage:i,variables:d,variablesFilled:p,extractedVariables:f,allVariablesFilled:v,messagesEndRef:g,setInputMessage:c,handleSendMessage:b,handleCancelRequest:()=>{h&&(h.abort(),u(null),r(!1),O.Ay.info("Request cancelled"))},handleClearConversation:()=>{n([]),x(!1),O.Ay.success("Chat history cleared.")},handleKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),b())},handleVariableChange:(e,t)=>{m({...d,[e]:t})}}})(e,t);return(0,r.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[!d&&(0,r.jsx)(ev,{extractedVariables:m,variables:c,onVariableChange:b}),n.length>0&&(0,r.jsx)("div",{className:"p-3 border-b border-gray-200 bg-white flex justify-end",children:(0,r.jsx)(l.$,{onClick:f,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300",icon:ey.A,children:"Clear Chat"})}),(0,r.jsx)(e$,{messages:n,isLoading:s,hasVariables:m.length>0,messagesEndRef:x}),(0,r.jsxs)("div",{className:"p-4 border-t border-gray-200 bg-white",children:[(0,r.jsx)(eE,{extractedVariables:m,variables:c}),(0,r.jsx)(eO,{inputMessage:i,isLoading:s,isDisabled:s||!i.trim()||m.length>0&&!p,onInputChange:h,onSend:u,onKeyDown:v,onCancel:g})]})]})},eI=({visible:e,promptName:t,isSaving:s,onNameChange:a,onPublish:l,onCancel:o})=>(0,r.jsx)(n.A,{title:"Publish Prompt",open:e,onCancel:o,footer:[(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(L.$,{variant:"secondary",onClick:o,children:"Cancel"}),(0,r.jsx)(L.$,{onClick:l,loading:s,children:"Publish"})]},"footer")],children:(0,r.jsxs)("div",{className:"py-4",children:[(0,r.jsx)(L.E,{className:"mb-2",children:"Name"}),(0,r.jsx)(X.A,{value:t,onChange:e=>a(e.target.value),placeholder:"Enter prompt name",onPressEnter:l,autoFocus:!0}),(0,r.jsx)(L.E,{className:"text-gray-500 text-xs mt-2",children:"Published prompts can be used in API calls and are versioned for easy tracking."})]})}),ez=({prompt:e})=>{let t=y(e);return(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Generated .prompt file"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"This is the dotprompt format that will be saved to the database"})]}),(0,r.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 overflow-auto",children:(0,r.jsx)("pre",{className:"text-sm text-gray-900 font-mono whitespace-pre-wrap",children:t})})]})};var eL=s(41326),eF=s(9194),eM=s(8536),eB=s(21034);let{Text:eJ}=eL.A,eR=({isOpen:e,onClose:t,accessToken:s,promptId:l,activeVersionId:n,onSelectVersion:i})=>{let[c,d]=(0,a.useState)([]),[m,p]=(0,a.useState)(!1);(0,a.useEffect)(()=>{e&&s&&l&&x()},[e,s,l]);let x=async()=>{p(!0);try{let e=l.includes(".v")?l.split(".v")[0]:l,t=await (0,o.getPromptVersions)(s,e);d(t.prompts)}catch(e){console.error("Error fetching prompt versions:",e)}finally{p(!1)}},h=e=>{if(e.version)return`v${e.version}`;let t=e.litellm_params?.prompt_id||e.prompt_id;return t.includes(".v")?`v${t.split(".v")[1]}`:t.includes("_v")?`v${t.split("_v")[1]}`:"v1"};return(0,r.jsx)(eF.A,{title:"Version History",placement:"right",onClose:t,open:e,width:400,mask:!1,maskClosable:!1,children:m?(0,r.jsx)(eM.A,{active:!0,paragraph:{rows:4}}):0===c.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No version history available."}):(0,r.jsx)(eB.A,{dataSource:c,renderItem:(e,t)=>{var s;let a=e.version||parseInt(h(e).replace("v","")),l=null;n&&(n.includes(".v")?l=parseInt(n.split(".v")[1]):n.includes("_v")&&(l=parseInt(n.split("_v")[1])));let o=l?a===l:0===t;return(0,r.jsxs)("div",{className:`mb-4 p-4 rounded-lg border cursor-pointer transition-all hover:shadow-md ${o?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-blue-300"}`,onClick:()=>i?.(e),children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(em.A,{className:"m-0",children:h(e)}),0===t&&(0,r.jsx)(em.A,{color:"blue",className:"m-0",children:"Latest"})]}),o&&(0,r.jsx)(em.A,{color:"green",className:"m-0",children:"Active"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)(eJ,{className:"text-sm text-gray-600 font-medium",children:(s=e.created_at)?new Date(s).toLocaleString():"-"}),(0,r.jsx)(eJ,{type:"secondary",className:"text-xs",children:e.prompt_info?.prompt_type==="db"?"Saved to Database":"Config Prompt"})]})]},`${e.prompt_id}-v${e.version||a}`)}})})},eU=({onClose:e,onSuccess:t,accessToken:s,initialPromptData:l})=>{let[n,i]=(0,a.useState)((()=>{if(l)try{return b(l)}catch(e){console.error("Error parsing existing prompt:",e),O.Ay.fromBackend("Failed to parse prompt data")}return{name:"New prompt",model:"gpt-4o",config:{temperature:1,max_tokens:1e3},tools:[],developerMessage:"",messages:[{role:"user",content:"Enter task specifics. Use {{template_variables}} for dynamic inputs"}]}})()),[c,d]=(0,a.useState)(!!l),[m,p]=(0,a.useState)(!1),[x,h]=(0,a.useState)((()=>{if(!l?.prompt_spec)return;let e=l.prompt_spec.prompt_id,t=l.prompt_spec.version||l.prompt_spec.litellm_params?.prompt_id;return"number"==typeof t?`${e}.v${t}`:"string"==typeof t&&(t.includes(".v")||t.includes("_v"))?t:e})()),[u,g]=(0,a.useState)(!1),[f,j]=(0,a.useState)(!1),[v,N]=(0,a.useState)(null),[w,A]=(0,a.useState)(!1),[_,k]=(0,a.useState)("pretty"),C=e=>{void 0!==e?N(e):N(null),g(!0)},S=async()=>{if(!s)return void O.Ay.fromBackend("Access token is required");if(!n.name||""===n.name.trim())return void O.Ay.fromBackend("Please enter a valid prompt name");A(!0);try{let r=n.name.replace(/[^a-zA-Z0-9_-]/g,"_").toLowerCase(),a=y(n),i={prompt_id:r,litellm_params:{prompt_integration:"dotprompt",prompt_id:r,dotprompt_content:a},prompt_info:{prompt_type:"db"}};c&&l?.prompt_spec?.prompt_id?(await (0,o.updatePromptCall)(s,l.prompt_spec.prompt_id,i),O.Ay.success("Prompt updated successfully!")):(await (0,o.createPromptCall)(s,i),O.Ay.success("Prompt created successfully!")),t(),e()}catch(e){console.error("Error saving prompt:",e),O.Ay.fromBackend(c?"Failed to update prompt":"Failed to save prompt")}finally{A(!1),j(!1)}},$=x&&x.includes(".v")?`v${x.split(".v")[1]}`:null;return(0,r.jsxs)("div",{className:"flex h-full bg-white",children:[(0,r.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,r.jsx)(et,{promptName:n.name,onNameChange:e=>i({...n,name:e}),onBack:e,onSave:()=>{n.name&&""!==n.name.trim()&&"New prompt"!==n.name?S():j(!0)},isSaving:w,editMode:c,onShowHistory:()=>p(!0),version:$,promptModel:n.model,promptVariables:(()=>{let e,t={},s=[n.developerMessage,...n.messages.map(e=>e.content)].join(" "),r=/\{\{(\w+)\}\}/g;for(;null!==(e=r.exec(s));){let s=e[1];t[s]||(t[s]=`example_${s}`)}return t})(),accessToken:s}),(0,r.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,r.jsxs)("div",{className:"w-1/2 overflow-y-auto bg-white border-r border-gray-200 flex-shrink-0",children:[(0,r.jsxs)("div",{className:"border-b border-gray-200 bg-white px-6 py-4 flex items-center gap-3",children:[(0,r.jsx)(el,{model:n.model,temperature:n.config.temperature,maxTokens:n.config.max_tokens,accessToken:s,onModelChange:e=>i({...n,model:e}),onTemperatureChange:e=>i({...n,config:{...n.config,temperature:e}}),onMaxTokensChange:e=>i({...n,config:{...n.config,max_tokens:e}})}),(0,r.jsxs)("div",{className:"ml-auto inline-flex items-center bg-gray-200 rounded-full p-0.5",children:[(0,r.jsx)("button",{className:`px-3 py-1 text-xs font-medium rounded-full transition-colors ${"pretty"===_?"bg-white text-gray-900 shadow-sm":"text-gray-600"}`,onClick:()=>k("pretty"),children:"PRETTY"}),(0,r.jsx)("button",{className:`px-3 py-1 text-xs font-medium rounded-full transition-colors ${"dotprompt"===_?"bg-white text-gray-900 shadow-sm":"text-gray-600"}`,onClick:()=>k("dotprompt"),children:"DOTPROMPT"})]})]}),"pretty"===_?(0,r.jsxs)("div",{className:"p-6 space-y-4 pb-20",children:[(0,r.jsx)(ec,{tools:n.tools,onAddTool:()=>C(),onEditTool:C,onRemoveTool:e=>{i({...n,tools:n.tools.filter((t,s)=>s!==e)})}}),(0,r.jsx)(eu,{value:n.developerMessage,onChange:e=>i({...n,developerMessage:e})}),(0,r.jsx)(ej,{messages:n.messages,onAddMessage:()=>{i({...n,messages:[...n.messages,{role:"user",content:""}]})},onUpdateMessage:(e,t,s)=>{let r=[...n.messages];r[e][t]=s,i({...n,messages:r})},onRemoveMessage:e=>{n.messages.length>1&&i({...n,messages:n.messages.filter((t,s)=>s!==e)})},onMoveMessage:(e,t)=>{let s=[...n.messages],[r]=s.splice(e,1);s.splice(t,0,r),i({...n,messages:s})}})]}):(0,r.jsx)(ez,{prompt:n})]}),(0,r.jsx)("div",{className:"w-1/2 flex-shrink-0",children:(0,r.jsx)(eD,{prompt:n,accessToken:s})})]})]}),(0,r.jsx)(eI,{visible:f,promptName:n.name,isSaving:w,onNameChange:e=>i({...n,name:e}),onPublish:S,onCancel:()=>j(!1)}),u&&(0,r.jsx)(Z,{visible:u,initialJson:null!==v?n.tools[v].json:"",onSave:e=>{try{let t=JSON.parse(e),s={name:t.function?.name||"Unnamed Tool",description:t.function?.description||"",json:e};if(null!==v){let e=[...n.tools];e[v]=s,i({...n,tools:e})}else i({...n,tools:[...n.tools,s]});g(!1),N(null)}catch(e){O.Ay.fromBackend("Invalid JSON format")}},onClose:()=>{g(!1),N(null)}}),(0,r.jsx)(eR,{isOpen:m,onClose:()=>p(!1),accessToken:s,promptId:l?.prompt_spec?.prompt_id||n.name,activeVersionId:x,onSelectVersion:e=>{try{let t=b({prompt_spec:e});i(t);let s=e.version||1;h(`${e.prompt_id}.v${s}`)}catch(e){console.error("Error loading version:",e),O.Ay.fromBackend("Failed to load prompt version")}}})]})};var eH=s(90550);let eV=({accessToken:e,userRole:t})=>{let[s,i]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[m,p]=(0,a.useState)(null),[x,h]=(0,a.useState)(!1),[u,g]=(0,a.useState)(!1),[f,j]=(0,a.useState)(null),[y,v]=(0,a.useState)(!1),[b,N]=(0,a.useState)(null),w=!!t&&(0,eH.OY)(t),A=async()=>{if(e){d(!0);try{let t=await (0,o.getPromptsList)(e);console.log(`prompts: ${JSON.stringify(t)}`),i(t.prompts)}catch(e){console.error("Error fetching prompts:",e)}finally{d(!1)}}};(0,a.useEffect)(()=>{A()},[e]);let k=()=>{A(),g(!1),j(null),p(null)},C=async()=>{if(b&&e){v(!0);try{await (0,o.deletePromptCall)(e,b.id),O.Ay.success(`Prompt "${b.name}" deleted successfully`),A()}catch(e){console.error("Error deleting prompt:",e),O.Ay.fromBackend("Failed to delete prompt")}finally{v(!1),N(null)}}};return(0,r.jsxs)("div",{className:"w-full mx-auto flex-auto overflow-y-auto m-8 p-2",children:[u?(0,r.jsx)(eU,{onClose:()=>{g(!1),j(null)},onSuccess:k,accessToken:e,initialPromptData:f}):m?(0,r.jsx)(J,{promptId:m,onClose:()=>p(null),accessToken:e,isAdmin:w,onDelete:A,onEdit:e=>{j(e),g(!0)}}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(l.$,{onClick:()=>{m&&p(null),j(null),g(!0)},disabled:!e,children:"+ Add New Prompt"}),(0,r.jsx)(l.$,{onClick:()=>{m&&p(null),h(!0)},disabled:!e,variant:"secondary",children:"Upload .prompt File"})]})}),(0,r.jsx)(_,{promptsList:s,isLoading:c,onPromptClick:e=>{p(e)},onDeleteClick:(e,t)=>{N({id:e,name:t})},accessToken:e,isAdmin:w})]}),(0,r.jsx)(K,{visible:x,onClose:()=>{h(!1)},accessToken:e,onSuccess:k}),b&&(0,r.jsxs)(n.A,{title:"Delete Prompt",open:null!==b,onOk:C,onCancel:()=>{N(null)},confirmLoading:y,okText:"Delete",okButtonProps:{danger:!0},children:[(0,r.jsxs)("p",{children:["Are you sure you want to delete prompt: ",b.name," ?"]}),(0,r.jsx)("p",{children:"This action cannot be undone."})]})]})}}}]);