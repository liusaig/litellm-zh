"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3581],{53581:(e,t,l)=>{l.d(t,{A:()=>eL});var s=l(95155),a=l(38983),r=l(42837),n=l(13121),i=l(22054),o=l(88636),c=l(2212),d=l(87927),u=l(56680),m=l(73806),h=l(79363),g=l(30489),x=l(96961),y=l(95517),f=l(8179),p=l(31556),j=l(95171),A=l(75892),b=l(34487),C=l(12115),k=l(41326),v=l(91808),_=l(23060),w=l(25387),N=l(3373),S=l(87278),E=l(12120),T=l(28436),F=l(7339),P=l(95049),I=l(61484);let{Title:O}=k.A,z=({accessToken:e})=>{let[t,l]=(0,C.useState)(!0),[n,i]=(0,C.useState)([]);(0,C.useEffect)(()=>{o()},[e]);let o=async()=>{if(e){l(!0);try{let t=await (0,T.getEmailEventSettings)(e);i(t.settings)}catch(e){console.error("Failed to fetch email event settings:",e),E.Ay.fromBackend(e)}finally{l(!1)}}},c=async()=>{if(e)try{await (0,T.updateEmailEventSettings)(e,{settings:n}),E.Ay.success("Email event settings updated successfully")}catch(e){console.error("Failed to update email event settings:",e),E.Ay.fromBackend(e)}},d=async()=>{if(e)try{await (0,T.resetEmailEventSettings)(e),E.Ay.success("Email event settings reset to defaults"),o()}catch(e){console.error("Failed to reset email event settings:",e),E.Ay.fromBackend(e)}};return(0,s.jsxs)(r.A,{children:[(0,s.jsx)(O,{level:4,children:"Email Notifications"}),(0,s.jsx)(A.A,{children:"Select which events should trigger email notifications."}),(0,s.jsx)(F.A,{}),t?(0,s.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:(0,s.jsx)(P.A,{size:"large"})}):(0,s.jsx)("div",{className:"space-y-4",children:n.map(e=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(I.A,{checked:e.enabled,onChange:t=>{var l,s;return l=e.event,s=t.target.checked,void i(n.map(e=>e.event===l?{...e,enabled:s}:e))}}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)(A.A,{children:e.event}),(0,s.jsx)("div",{className:"text-sm text-gray-500 block",children:(e=>{if(e.includes("Virtual Key Created"))return"An email will be sent to the user when a new virtual key is created with their user ID";{if(e.includes("New User Invitation"))return"An email will be sent to the email address of the user when a new user is created";let t=e.split(/(?=[A-Z])/).join(" ").toLowerCase();return`Receive an email notification when ${t}`}})(e.event)})]})]},e.event))}),(0,s.jsxs)("div",{className:"mt-6 flex space-x-4",children:[(0,s.jsx)(a.A,{onClick:c,disabled:t,children:"Save Changes"}),(0,s.jsx)(a.A,{onClick:d,variant:"secondary",disabled:t,children:"Reset to Defaults"})]})]})},{Title:L}=k.A,D=({accessToken:e,premiumUser:t,alerts:l})=>{let i=async()=>{if(!e)return;let t={};l.filter(e=>"email"===e.name).forEach(e=>{Object.entries(e.variables??{}).forEach(([e,l])=>{let s=document.querySelector(`input[name="${e}"]`);s&&s.value&&(t[e]=s?.value)})}),console.log("updatedVariables",t);try{await (0,T.setCallbacksCall)(e,{general_settings:{alerting:["email"]},environment_variables:t}),E.Ay.success("Email settings updated successfully")}catch(e){E.Ay.fromBackend(e)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mt-6 mb-6",children:(0,s.jsx)(z,{accessToken:e})}),(0,s.jsxs)(r.A,{children:[(0,s.jsx)(L,{level:4,children:"Email Server Settings"}),(0,s.jsxs)(A.A,{children:[(0,s.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/email",target:"_blank",style:{color:"blue"},children:[" ","Silinex Docs: email alerts"]})," ",(0,s.jsx)("br",{})]}),(0,s.jsx)("div",{className:"flex w-full",children:l.filter(e=>"email"===e.name).map((e,l)=>(0,s.jsx)(y.A,{children:(0,s.jsx)("ul",{children:(0,s.jsx)(n.A,{numItems:2,children:Object.entries(e.variables??{}).map(([e,l])=>(0,s.jsxs)("li",{className:"mx-2 my-2",children:[!0!=t&&("EMAIL_LOGO_URL"===e||"EMAIL_SUPPORT_CONTACT"===e)?(0,s.jsxs)("div",{children:[(0,s.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:(0,s.jsxs)(A.A,{className:"mt-2",children:[" ✨ ",e]})}),(0,s.jsx)(b.A,{name:e,defaultValue:l,type:"password",disabled:!0,style:{width:"400px"}})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)(A.A,{className:"mt-2",children:e}),(0,s.jsx)(b.A,{name:e,defaultValue:l,type:"password",style:{width:"400px"}})]}),(0,s.jsxs)("p",{style:{fontSize:"small",fontStyle:"italic"},children:["SMTP_HOST"===e&&(0,s.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP host address, e.g. `smtp.resend.com`",(0,s.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_PORT"===e&&(0,s.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP port number, e.g. `587`",(0,s.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_USERNAME"===e&&(0,s.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP username, e.g. `username`",(0,s.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_PASSWORD"===e&&(0,s.jsx)("span",{style:{color:"red"},children:" Required * "}),"SMTP_SENDER_EMAIL"===e&&(0,s.jsxs)("div",{style:{color:"gray"},children:["Enter the sender email address, e.g. `sender@berri.ai`",(0,s.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"TEST_EMAIL_ADDRESS"===e&&(0,s.jsxs)("div",{style:{color:"gray"},children:["Email Address to send `Test Email Alert` to. example: `info@berri.ai`",(0,s.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"EMAIL_LOGO_URL"===e&&(0,s.jsx)("div",{style:{color:"gray"},children:"(Optional) Customize the Logo that appears in the email, pass a url to your logo"}),"EMAIL_SUPPORT_CONTACT"===e&&(0,s.jsx)("div",{style:{color:"gray"},children:"(Optional) Customize the support email address that appears in the email. Default is support@berri.ai"})]})]},e))})})},l))}),(0,s.jsx)(a.A,{className:"mt-2",onClick:()=>i(),children:"Save Changes"}),(0,s.jsx)(a.A,{onClick:async()=>{if(e)try{await (0,T.serviceHealthCheck)(e,"email"),E.Ay.success("Email test triggered. Check your configured email inbox/logs.")}catch(e){E.Ay.fromBackend(e)}},className:"mx-2",children:"Test Email Alerts"})]})]})};var Z=l(59987),U=l(8208),R=l(92982),B=l(45588),$=l(34254),q=l(19602);let M=({alertingSettings:e,handleInputChange:t,handleResetField:l,handleSubmit:r,premiumUser:n})=>{let[i]=w.A.useForm();return(0,s.jsxs)(w.A,{form:i,onFinish:()=>{console.log("INSIDE ONFINISH");let e=i.getFieldsValue(),t=Object.entries(e).every(([e,t])=>"boolean"!=typeof t&&(""===t||null==t));console.log(`formData: ${JSON.stringify(e)}, isEmpty: ${t}`),t?console.log("Some form fields are empty."):r(e)},labelAlign:"left",children:[e.map((e,r)=>(0,s.jsxs)(j.A,{children:[(0,s.jsxs)(y.A,{align:"center",children:[(0,s.jsx)(A.A,{children:e.field_name}),(0,s.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:e.field_description})]}),e.premium_field?n?(0,s.jsx)(w.A.Item,{name:e.field_name,children:(0,s.jsx)(y.A,{children:"Integer"===e.field_type?(0,s.jsx)(U.A,{step:1,value:e.field_value,onChange:l=>t(e.field_name,l)}):"Boolean"===e.field_type?(0,s.jsx)(o.A,{checked:e.field_value,onChange:l=>t(e.field_name,l)}):(0,s.jsx)(v.A,{value:e.field_value,onChange:l=>t(e.field_name,l)})})}):(0,s.jsx)(y.A,{children:(0,s.jsx)(a.A,{className:"flex items-center justify-center",children:(0,s.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"✨ Enterprise Feature"})})}):(0,s.jsx)(w.A.Item,{name:e.field_name,className:"mb-0",valuePropName:"Boolean"===e.field_type?"checked":"value",children:(0,s.jsx)(y.A,{children:"Integer"===e.field_type?(0,s.jsx)(U.A,{step:1,value:e.field_value,onChange:l=>t(e.field_name,l),className:"p-0"}):"Boolean"===e.field_type?(0,s.jsx)(o.A,{checked:e.field_value,onChange:l=>{t(e.field_name,l),i.setFieldsValue({[e.field_name]:l})}}):(0,s.jsx)(v.A,{value:e.field_value,onChange:l=>t(e.field_name,l)})})}),(0,s.jsx)(y.A,{children:!0==e.stored_in_db?(0,s.jsx)($.A,{icon:R.A,className:"text-white",children:"In DB"}):!1==e.stored_in_db?(0,s.jsx)($.A,{className:"text-gray bg-white outline",children:"In Config"}):(0,s.jsx)($.A,{className:"text-gray bg-white outline",children:"Not Set"})}),(0,s.jsx)(y.A,{children:(0,s.jsx)(q.A,{icon:B.A,color:"red",onClick:()=>l(e.field_name,r),children:"Reset"})})]},r)),(0,s.jsx)("div",{children:(0,s.jsx)(S.Ay,{htmlType:"submit",children:"Update Settings"})})]})},H=({accessToken:e,premiumUser:t})=>{let[l,a]=(0,C.useState)([]);return(0,C.useEffect)(()=>{e&&(0,T.alertingSettingsCall)(e).then(e=>{a(e)})},[e]),(0,s.jsx)(M,{alertingSettings:l,handleInputChange:(e,t)=>{let s=l.map(l=>l.field_name===e?{...l,field_value:t}:l);console.log(`updatedSettings: ${JSON.stringify(s)}`),a(s)},handleResetField:(t,s)=>{if(e)try{let e=l.map(e=>e.field_name===t?{...e,stored_in_db:null,field_value:e.field_default_value}:e);a(e)}catch(e){console.log("ERROR OCCURRED!")}},handleSubmit:t=>{if(!e)return;if(console.log(`formValues: ${t}`),null==t||void 0==t)return;let s={};l.forEach(e=>{s[e.field_name]=e.field_value});let a={...t,...s};console.log(`mergedFormValues: ${JSON.stringify(a)}`);let{slack_alerting:r,...n}=a;console.log(`slack_alerting: ${r}, alertingArgs: ${JSON.stringify(n)}`);try{(0,T.updateConfigFieldSetting)(e,"alerting_args",n),"boolean"==typeof r&&(!0==r?(0,T.updateConfigFieldSetting)(e,"alerting",["slack"]):(0,T.updateConfigFieldSetting)(e,"alerting",[])),E.Ay.success("Wait 10s for proxy to update.")}catch(e){}},premiumUser:t})};var W=l(26708),G=l(35625),J=l(48934),K=l(90078);let V=(0,K.D)("cloudZeroSettings"),Q=async e=>{let t=(0,T.getProxyBaseUrl)(),l=t?`${t}/cloudzero/settings`:"/cloudzero/settings",s=await fetch(l,{method:"GET",headers:{[(0,T.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"}});if(!s.ok){let e="Failed to fetch CloudZero settings";try{let t=await s.json();"object"==typeof t&&null!==t?e=t?.error?.message||t?.error||t?.message||t?.detail||("string"==typeof t?.error?t.error:e):"string"==typeof t&&(e=t)}catch{e=s.statusText||e}throw Error(e)}let a=await s.json();return a&&(a.api_key_masked||a.connection_id)?a:null},X=async(e,t)=>{let l=(0,T.getProxyBaseUrl)(),s=l?`${l}/cloudzero/settings`:"/cloudzero/settings",a=await fetch(s,{method:"PUT",headers:{[(0,T.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({...t.connection_id&&{connection_id:t.connection_id},...t.timezone&&{timezone:t.timezone},...t.api_key&&{api_key:t.api_key}})});if(!a.ok){let e="Failed to update CloudZero settings";try{let t=await a.json();"object"==typeof t&&null!==t?e=t?.error?.message||t?.error||t?.message||t?.detail||("string"==typeof t?.error?t.error:e):"string"==typeof t&&(e=t)}catch{e=a.statusText||e}throw Error(e)}return await a.json()},Y=async e=>{let t=(0,T.getProxyBaseUrl)(),l=t?`${t}/cloudzero/delete`:"/cloudzero/delete",s=await fetch(l,{method:"DELETE",headers:{[(0,T.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"}});if(!s.ok){let e="Failed to delete CloudZero settings";try{let t=await s.json();"object"==typeof t&&null!==t?e=t?.error?.message||t?.error||t?.message||t?.detail||("string"==typeof t?.error?t.error:e):"string"==typeof t&&(e=t)}catch{e=s.statusText||e}throw Error(e)}return await s.json()};var ee=l(42696),et=l(69779),el=l(25339);let{Title:es,Paragraph:ea}=k.A;function er({startCreation:e}){return(0,s.jsx)("div",{className:"bg-white p-12 rounded-lg border border-dashed border-gray-300 text-center max-w-2xl mx-auto mt-8",children:(0,s.jsx)(el.A,{image:el.A.PRESENTED_IMAGE_SIMPLE,description:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(es,{level:4,children:"No CloudZero Integration Found"}),(0,s.jsx)(ea,{type:"secondary",className:"max-w-md mx-auto",children:"Connect your CloudZero account to start tracking and analyzing your cloud costs directly from Silinex."})]}),children:(0,s.jsx)(S.Ay,{type:"primary",size:"large",onClick:e,className:"flex items-center gap-2 mx-auto mt-4",children:"Add CloudZero Integration"})})})}var en=l(87056);let ei=async(e,t)=>{let l=(0,T.getProxyBaseUrl)(),s=l?`${l}/cloudzero/init`:"/cloudzero/init",a=await fetch(s,{method:"POST",headers:{[(0,T.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({connection_id:t.connection_id,timezone:t.timezone??"UTC",...t.api_key&&{api_key:t.api_key}})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e?.error?.message||e?.message||e?.detail||"Failed to create CloudZero integration")}return await a.json()};function eo({open:e,onOk:t,onCancel:l}){let a,{accessToken:r}=(0,ee.A)(),[n]=w.A.useForm(),i=(a=r||"",(0,J.n)({mutationFn:async e=>{if(!a)throw Error("Access token is required");return await ei(a,e)}}));(0,C.useEffect)(()=>{e&&n.resetFields()},[e,n]);let o=async()=>{try{let e=await n.validateFields();i.mutate({connection_id:e.connection_id,timezone:e.timezone||"UTC",...e.api_key&&{api_key:e.api_key}},{onSuccess:()=>{en.Ay.success("CloudZero integration created successfully"),n.resetFields(),t()},onError:e=>{e?.errorFields||en.Ay.error(e?.message||"Failed to create CloudZero integration")}})}catch(e){if(e?.errorFields)return;en.Ay.error(e?.message||"Failed to create CloudZero integration")}};return(0,s.jsx)(N.A,{title:"Create CloudZero Integration",open:e,onOk:o,onCancel:()=>{n.resetFields(),l()},confirmLoading:i.isPending,okText:i.isPending?"Creating...":"Create",cancelText:"Cancel",okButtonProps:{disabled:i.isPending},cancelButtonProps:{disabled:i.isPending},children:(0,s.jsxs)(w.A,{form:n,layout:"vertical",onFinish:o,children:[(0,s.jsx)(w.A.Item,{label:"CloudZero API Key",name:"api_key",rules:[{required:!0,message:"Please enter your CloudZero API key"}],children:(0,s.jsx)(v.A.Password,{placeholder:"Enter your CloudZero API key"})}),(0,s.jsx)(w.A.Item,{label:"Connection ID",name:"connection_id",rules:[{required:!0,message:"Please enter your CloudZero connection ID"}],children:(0,s.jsx)(v.A,{placeholder:"Enter your CloudZero connection ID"})}),(0,s.jsx)(w.A.Item,{label:"Timezone",name:"timezone",tooltip:"Timezone for date handling (defaults to UTC if not provided)",children:(0,s.jsx)(v.A,{placeholder:"UTC"})})]})})}let ec=async(e,t={})=>{let l=(0,T.getProxyBaseUrl)(),s=l?`${l}/cloudzero/dry-run`:"/cloudzero/dry-run",a=await fetch(s,{method:"POST",headers:{[(0,T.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({limit:t.limit??10})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e?.error?.message||e?.message||e?.detail||"Failed to perform dry run")}return await a.json()},ed=async(e,t={})=>{let l=(0,T.getProxyBaseUrl)(),s=l?`${l}/cloudzero/export`:"/cloudzero/export",a=await fetch(s,{method:"POST",headers:{[(0,T.getGlobalLitellmHeaderName)()]:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({operation:t.operation??"replace_hourly"})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e?.error?.message||e?.message||e?.detail||"Failed to export data")}return await a.json()};var eu=l(66793),em=l(48849),eh=l(30648),eg=l(80483),ex=l(99876),ey=l(89823),ef=l(68459),ep=l(20232),ej=l(21975),eA=l(52484);function eb({open:e,onOk:t,onCancel:l,settings:a}){var r;let n,{accessToken:i}=(0,ee.A)(),[o]=w.A.useForm(),c=(r=i||"",n=(0,G.jE)(),(0,J.n)({mutationFn:async e=>{if(!r)throw Error("Access token is required");return await X(r,e)},onSuccess:()=>{n.invalidateQueries({queryKey:V.list({})})}}));(0,C.useEffect)(()=>{e&&a?o.setFieldsValue({connection_id:a.connection_id,timezone:a.timezone||"UTC",api_key:""}):e&&o.resetFields()},[e,a,o]);let d=async()=>{try{let e=await o.validateFields();c.mutate({connection_id:e.connection_id,timezone:e.timezone||"UTC",...e.api_key&&{api_key:e.api_key}},{onSuccess:()=>{en.Ay.success("CloudZero integration updated successfully"),o.resetFields(),t()},onError:e=>{e?.errorFields||en.Ay.error(e?.message||"Failed to update CloudZero integration")}})}catch(e){if(e?.errorFields)return;en.Ay.error(e?.message||"Failed to update CloudZero integration")}};return(0,s.jsx)(N.A,{title:"Edit CloudZero Integration",open:e,onOk:d,onCancel:()=>{o.resetFields(),l()},confirmLoading:c.isPending,okText:c.isPending?"Updating...":"Update",cancelText:"Cancel",okButtonProps:{disabled:c.isPending},cancelButtonProps:{disabled:c.isPending},children:(0,s.jsxs)(w.A,{form:o,layout:"vertical",onFinish:d,children:[(0,s.jsx)(w.A.Item,{label:"CloudZero API Key",name:"api_key",rules:[{required:!1,message:"Please enter your CloudZero API key"}],tooltip:"Leave empty to keep the existing API key",children:(0,s.jsx)(v.A.Password,{placeholder:"Leave empty to keep existing"})}),(0,s.jsx)(w.A.Item,{label:"Connection ID",name:"connection_id",rules:[{required:!0,message:"Please enter your CloudZero connection ID"}],children:(0,s.jsx)(v.A,{placeholder:"Enter your CloudZero connection ID"})}),(0,s.jsx)(w.A.Item,{label:"Timezone",name:"timezone",tooltip:"Timezone for date handling (defaults to UTC if not provided)",children:(0,s.jsx)(v.A,{placeholder:"UTC"})})]})})}function eC({settings:e,onSettingsUpdated:t}){var l;let a,r,n,{accessToken:i}=(0,ee.A)(),[o,c]=(0,C.useState)(!1),[d,u]=(0,C.useState)(!1),m=(a=i||"",(0,J.n)({mutationFn:async(e={})=>{if(!a)throw Error("Access token is required");return await ec(a,e)}})),h=(r=i||"",(0,J.n)({mutationFn:async(e={})=>{if(!r)throw Error("Access token is required");return await ed(r,e)}})),g=(l=i||"",n=(0,G.jE)(),(0,J.n)({mutationFn:async()=>{if(!l)throw Error("Access token is required");return await Y(l)},onSuccess:()=>{n.invalidateQueries({queryKey:V.list({})})}})),x=m.data?JSON.stringify(m.data,null,2):null,y=async()=>{c(!1),t()};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"space-y-6 w-full max-w-4xl mx-auto",children:(0,s.jsxs)(et.A,{title:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-lg font-semibold",children:"CloudZero Configuration"}),(0,s.jsx)(em.A,{color:"success",className:"ml-2 capitalize",children:e.status||"Active"})]}),extra:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(S.Ay,{icon:(0,s.jsx)(ey.A,{size:16}),onClick:()=>{c(!0)},className:"flex items-center gap-2",children:"Edit"}),(0,s.jsx)(S.Ay,{danger:!0,icon:(0,s.jsx)(ef.A,{size:16}),onClick:()=>{u(!0)},className:"flex items-center gap-2",children:"Delete"})]}),className:"shadow-sm",children:[(0,s.jsxs)(eh.A,{bordered:!0,column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1},children:[(0,s.jsx)(eh.A.Item,{label:"API Key (Redacted)",children:(0,s.jsx)("span",{className:"font-mono text-gray-600",children:e.api_key_masked||(0,s.jsx)("span",{className:"text-gray-400 italic",children:"Not configured"})})}),(0,s.jsx)(eh.A.Item,{label:"Connection ID",children:(0,s.jsx)("span",{className:"font-mono text-gray-600",children:e.connection_id||(0,s.jsx)("span",{className:"text-gray-400 italic",children:"Not configured"})})}),(0,s.jsx)(eh.A.Item,{label:"Timezone",children:e.timezone||(0,s.jsx)("span",{className:"text-gray-400 italic",children:"Default (UTC)"})})]}),(0,s.jsx)(F.A,{orientation:"left",className:"text-gray-500",children:"Actions"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-4 mb-6",children:[(0,s.jsx)(S.Ay,{onClick:()=>{i&&m.mutate({limit:10},{onSuccess:e=>{en.Ay.success("Dry run completed successfully")},onError:e=>{en.Ay.error(e?.message||"Failed to perform dry run")}})},loading:m.isPending,icon:(0,s.jsx)(ep.A,{size:16}),className:"flex items-center gap-2",children:"Run Dry Run Simulation"}),(0,s.jsx)(eg.A,{title:"Export Data to CloudZero",description:"This will push the current accumulated cost data to CloudZero. Continue?",onConfirm:()=>{i&&h.mutate({operation:"replace_hourly"},{onSuccess:()=>{en.Ay.success("Data successfully exported to CloudZero")},onError:e=>{en.Ay.error(e?.message||"Failed to export data")}})},okText:"Export",cancelText:"Cancel",children:(0,s.jsx)(S.Ay,{type:"primary",loading:h.isPending,icon:(0,s.jsx)(ej.A,{size:16}),className:"flex items-center gap-2",children:"Export Data Now"})})]}),x&&(0,s.jsx)("div",{className:"mt-6 animate-in fade-in slide-in-from-top-4 duration-300",children:(0,s.jsx)(ex.A,{message:"Dry Run Results",description:(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsxs)("p",{className:"mb-2 text-gray-600",children:["Simulation output for connection: ",e.connection_id]}),(0,s.jsx)("pre",{className:"bg-gray-50 p-4 rounded-md border border-gray-200 overflow-x-auto text-xs font-mono text-gray-800",children:x})]}),type:"info",showIcon:!0,icon:(0,s.jsx)(eA.A,{className:"text-blue-500"})})})]})}),(0,s.jsx)(eb,{open:o,onOk:y,onCancel:()=>{c(!1)},settings:e}),(0,s.jsx)(eu.A,{isOpen:d,title:"Delete CloudZero Integration?",message:"Are you sure you want to delete this CloudZero integration? All associated settings and configurations will be permanently removed.",resourceInformationTitle:"Integration Details",resourceInformation:[{label:"Connection ID",value:e.connection_id,code:!0},{label:"Timezone",value:e.timezone||"Default (UTC)"}],onCancel:()=>{u(!1)},onOk:()=>{i&&g.mutate(void 0,{onSuccess:()=>{en.Ay.success("CloudZero integration deleted successfully"),u(!1),t()},onError:e=>{en.Ay.error(e?.message||"Failed to delete CloudZero integration")}})},confirmLoading:g.isPending})]})}function ek(){let{accessToken:e}=(0,ee.A)(),{data:t,isLoading:l,error:a}=(0,W.I)({queryKey:V.list({}),queryFn:async()=>await Q(e),enabled:!!e,staleTime:36e5,gcTime:36e5}),r=(0,G.jE)(),n=(0,K.D)("cloudZeroSettings"),[i,o]=(0,C.useState)(!1),c=async()=>{o(!1),await r.invalidateQueries({queryKey:n.list({})})};return l?(0,s.jsx)(et.A,{children:(0,s.jsx)(k.A.Text,{children:"Loading CloudZero settings..."})}):a?(0,s.jsx)(et.A,{children:(0,s.jsxs)(k.A.Text,{className:"text-red-600",children:["Error loading CloudZero settings: ",a instanceof Error?a.message:String(a)]})}):t?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(eC,{settings:t,onSettingsUpdated:c})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(er,{startCreation:()=>o(!0)}),(0,s.jsx)(eo,{open:i,onOk:c,onCancel:()=>{o(!1)}})]})}var ev=l(67667),e_=l(50139),ew=l(80692),eN=l(82426);let eS=[{value:"success",label:"Success"},{value:"failure",label:"Failure"},{value:"success_and_failure",label:"Success & Failure"}],eE=({callbacks:e,availableCallbacks:t={},onTest:l=()=>{},onEdit:a=()=>{},onDelete:r=()=>{},onAdd:n=()=>{}})=>{let i=[{title:(0,s.jsx)("span",{className:"font-medium text-gray-700",children:"Callback Name"}),dataIndex:"name",key:"name",render:(e,l)=>{let a=l.name;console.log("availableCallbacks",t);let r=t[a]?.ui_callback_name||a;return(0,s.jsx)("div",{className:"font-medium text-gray-800",children:r})}},{title:(0,s.jsx)("span",{className:"font-medium text-gray-700",children:"Mode"}),key:"mode",render:(e,t)=>{let l=t.mode||"success",a=eS.find(e=>e.value===l)?.label||l,r="success"===l?"bg-green-100 text-green-800":"failure"===l?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800";return(0,s.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r}`,children:a})},width:240},{title:(0,s.jsx)("span",{className:"font-medium text-gray-700 text-right w-full block",children:"Actions"}),key:"actions",align:"right",render:(e,t)=>(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(eN.A,{variant:"Test",tooltipText:"Test Callback",onClick:()=>l(t)}),(0,s.jsx)(eN.A,{variant:"Edit",tooltipText:"Edit Callback",onClick:()=>a(t)}),(0,s.jsx)(eN.A,{variant:"Delete",tooltipText:"Delete Callback",onClick:()=>r(t)})]}),width:240}];return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"w-full mt-4",children:[(0,s.jsx)(ev.$,{onClick:n,className:"mx-auto",children:"+ Add Callback"}),(0,s.jsx)("div",{className:"flex justify-between items-center my-2",children:(0,s.jsx)(ew.A,{level:4,children:"Active Logging Callbacks"})}),0===e.length?(0,s.jsx)("div",{className:"flex flex-col items-center justify-center p-8 bg-gray-50 border border-gray-200 rounded-lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No callbacks configured"}),(0,s.jsx)("p",{className:"text-gray-500",children:"Add your first callback to start logging data to external services."})]})}):(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:(0,s.jsx)(e_.A,{columns:i,dataSource:e,rowKey:e=>e.name,pagination:!1,rowClassName:()=>"hover:bg-gray-50"})})]})})};var eT=l(34425);let{Title:eF,Paragraph:eP}=k.A,eI=({params:e,callbackConfigs:t,selectedCallback:l})=>e&&0!==e.length?(0,s.jsx)("div",{className:"space-y-4 mt-6 p-4 bg-gray-50 rounded-lg border",children:e.map(e=>{let a=t.find(e=>e.id===l),r=a?.dynamic_params?.[e]||{},n=r.type||"text",i=r.ui_name||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),o=r.required||!1;return(0,s.jsx)(Z.A,{label:(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[i," "]}),name:e,className:"mb-4",rules:o?[{required:!0,message:`Please enter the ${i.toLowerCase()}`}]:void 0,children:"password"===n?(0,s.jsx)(v.A.Password,{size:"large",placeholder:`Enter your ${i.toLowerCase()}`,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}):"number"===n?(0,s.jsx)(v.A,{type:"number",size:"large",placeholder:`Enter ${i.toLowerCase()}`,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:0,max:1,step:.1}):(0,s.jsx)(v.A,{size:"large",placeholder:`Enter your ${i.toLowerCase()}`,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})},e)})}):null,eO=({callbackConfigs:e,selectedCallback:t,onCallbackChange:l,disabled:a=!1})=>(0,s.jsx)(Z.A,{label:"Callback",name:"callback",rules:a?void 0:[{required:!0,message:"Please select a callback"}],children:(0,s.jsx)(_.A,{placeholder:"Choose a logging callback...",size:"large",className:"w-full",showSearch:!0,disabled:a,value:t,filterOption:(e,t)=>(t?.value?.toString()??"").toLowerCase().includes(e.toLowerCase()),onChange:l,children:e.map(e=>{let t=e.logo,l=t&&(t.includes("/")||t.startsWith("data:")||t.startsWith("http"))?t:`../ui/assets/logos/${t}`;return(0,s.jsx)(i.A,{value:e.id,children:(0,s.jsxs)("div",{className:"flex items-center space-x-3 py-1",children:[(0,s.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,s.jsx)("img",{src:l,alt:`${e.displayName} logo`,className:"w-6 h-6 rounded object-contain",onError:e=>{e.currentTarget.style.display="none"}})}),(0,s.jsx)("span",{className:"font-medium text-gray-900",children:e.displayName})]})},e.id)})})}),ez=(e,t,l)=>{if(!e)return l?Object.keys(l):[];let s=t.find(t=>t.id===e);return s?.dynamic_params?Object.keys(s.dynamic_params):l?Object.keys(l):[]},eL=({accessToken:e,userRole:t,userID:l,premiumUser:i})=>{let[k,v]=(0,C.useState)([]),[_,F]=(0,C.useState)([]),[P,I]=(0,C.useState)(!1),[O]=w.A.useForm(),[z]=w.A.useForm(),[L,Z]=(0,C.useState)(null),[U,R]=(0,C.useState)(""),[B,$]=(0,C.useState)({}),[q,M]=(0,C.useState)([]),[W,G]=(0,C.useState)(!1),[J,K]=(0,C.useState)([]),[V,Q]=(0,C.useState)({}),[X,Y]=(0,C.useState)([]),[ee,et]=(0,C.useState)(!1),[el,es]=(0,C.useState)(null),[ea,er]=(0,C.useState)(!1),[en,ei]=(0,C.useState)(null),[eo,ec]=(0,C.useState)(!1),[ed,em]=(0,C.useState)(!1),[eh,eg]=(0,C.useState)(!1);(0,C.useEffect)(()=>{e&&(0,T.getCallbackConfigsCall)(e).then(e=>{K(e||[])}).catch(e=>{E.Ay.fromBackend("Failed to load callback configs: "+(0,eT.x)(e))})},[e]),(0,C.useEffect)(()=>{if(ee&&el){let e=Object.fromEntries(Object.entries(el.variables||{}).map(([e,t])=>[e,t??""]));z.setFieldsValue({...e,callback:el.name})}},[ee,el,z]);let ex=e=>{q.includes(e)?M(q.filter(t=>t!==e)):M([...q,e])},ey={llm_exceptions:"LLM Exceptions",llm_too_slow:"LLM Responses Too Slow",llm_requests_hanging:"LLM Requests Hanging",budget_alerts:"Budget Alerts (API Keys, Users)",db_exceptions:"Database Exceptions (Read/Write)",daily_reports:"Weekly/Monthly Spend Reports",outage_alerts:"Outage Alerts",region_outage_alerts:"Region Outage Alerts"};(0,C.useEffect)(()=>{e&&t&&l&&(0,T.getCallbacksCall)(e,l,t).then(e=>{v(e.callbacks),Q(e.available_callbacks);let t=e.alerts;if(t&&t.length>0){let e=t[0],l=e.variables.SLACK_WEBHOOK_URL;M(e.active_alerts),R(l),$(e.alerts_to_webhook)}F(t)})},[e,t,l]);let ef=e=>q&&q.includes(e),ep=async(s,a,r)=>{if(e){r?ec(!0):em(!0);try{if(await (0,T.setCallbacksCall)(e,{environment_variables:s,litellm_settings:{success_callback:[a]}}),E.Ay.success(r?"Callback updated successfully":`Callback ${a} added successfully`),r?(et(!1),z.resetFields(),es(null)):(G(!1),O.resetFields(),Z(null),Y([])),l&&t){let s=await (0,T.getCallbacksCall)(e,l,t);v(s.callbacks)}}catch(e){E.Ay.fromBackend(e)}finally{r?ec(!1):em(!1)}}},ej=async e=>{el&&await ep(e,el.name,!0)},eA=async e=>{let t=e?.callback;t&&await ep(e,t,!1)},eb=async()=>{if(!e)return;let t={};Object.entries(ey).forEach(([e,l])=>{let s=document.querySelector(`input[name="${e}"]`),a=s?.value||"";t[e]=a});try{await (0,T.setCallbacksCall)(e,{general_settings:{alert_to_webhook_url:t,alert_types:q}})}catch(e){E.Ay.fromBackend(e)}E.Ay.success("Alerts updated successfully")},eC=async()=>{if(en&&e)try{if(eg(!0),await (0,T.deleteCallback)(e,en.name),E.Ay.success(`Callback ${en.name} deleted successfully`),l&&t){let s=await (0,T.getCallbacksCall)(e,l,t);v(s.callbacks)}er(!1),ei(null)}catch(e){console.error("Failed to delete callback:",e),E.Ay.fromBackend(e)}finally{eg(!1)}};return e?(0,s.jsxs)("div",{className:"w-full mx-4",children:[(0,s.jsx)(n.A,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,s.jsxs)(d.A,{children:[(0,s.jsxs)(u.A,{variant:"line",defaultValue:"1",children:[(0,s.jsx)(c.A,{value:"1",children:"Logging Callbacks"}),(0,s.jsx)(c.A,{value:"2",children:"CloudZero Cost Tracking"}),(0,s.jsx)(c.A,{value:"2",children:"Alerting Types"}),(0,s.jsx)(c.A,{value:"3",children:"Alerting Settings"}),(0,s.jsx)(c.A,{value:"4",children:"Email Alerts"})]}),(0,s.jsxs)(h.A,{children:[(0,s.jsx)(m.A,{children:(0,s.jsx)(eE,{callbacks:k,availableCallbacks:V,onAdd:()=>G(!0),onEdit:e=>{es(e),et(!0)},onDelete:e=>{ei(e),er(!0)},onTest:async t=>{try{await (0,T.serviceHealthCheck)(e,t.name),E.Ay.success("Health check triggered")}catch(e){E.Ay.fromBackend((0,eT.x)(e))}}})}),(0,s.jsx)(m.A,{children:(0,s.jsx)("div",{className:"p-8",children:(0,s.jsx)(ek,{})})}),(0,s.jsx)(m.A,{children:(0,s.jsxs)(r.A,{children:[(0,s.jsxs)(A.A,{className:"my-2",children:["Alerts are only supported for Slack Webhook URLs. Get your webhook urls from"," ",(0,s.jsx)("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",style:{color:"blue"},children:"here"})]}),(0,s.jsxs)(g.A,{children:[(0,s.jsx)(f.A,{children:(0,s.jsxs)(j.A,{children:[(0,s.jsx)(p.A,{}),(0,s.jsx)(p.A,{}),(0,s.jsx)(p.A,{children:"Slack Webhook URL"})]})}),(0,s.jsx)(x.A,{children:Object.entries(ey).map(([e,t],l)=>(0,s.jsxs)(j.A,{children:[(0,s.jsx)(y.A,{children:"region_outage_alerts"==e?i?(0,s.jsx)(o.A,{id:"switch",name:"switch",checked:ef(e),onChange:()=>ex(e)}):(0,s.jsx)(a.A,{className:"flex items-center justify-center",children:(0,s.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"✨ Enterprise Feature"})}):(0,s.jsx)(o.A,{id:"switch",name:"switch",checked:ef(e),onChange:()=>ex(e)})}),(0,s.jsx)(y.A,{children:(0,s.jsx)(A.A,{children:t})}),(0,s.jsx)(y.A,{children:(0,s.jsx)(b.A,{name:e,type:"password",defaultValue:B&&B[e]?B[e]:U})})]},l))})]}),(0,s.jsx)(a.A,{size:"xs",className:"mt-2",onClick:eb,children:"Save Changes"}),(0,s.jsx)(a.A,{onClick:async()=>{try{await (0,T.serviceHealthCheck)(e,"slack"),E.Ay.success("Alert test triggered. Test request to slack made - check logs/alerts on slack to verify")}catch(e){E.Ay.fromBackend((0,eT.x)(e))}},className:"mx-2",children:"Test Alerts"})]})}),(0,s.jsx)(m.A,{children:(0,s.jsx)(H,{accessToken:e,premiumUser:i})}),(0,s.jsx)(m.A,{children:(0,s.jsx)(D,{accessToken:e,premiumUser:i,alerts:_})})]})]})}),(0,s.jsxs)(N.A,{title:"Add Logging Callback",open:W,width:800,onCancel:()=>{G(!1),Z(null),Y([])},footer:null,children:[(0,s.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/logging",className:"mb-8 mt-4",target:"_blank",style:{color:"blue"},children:[" ","Silinex Docs: Logging"]}),(0,s.jsxs)(w.A,{form:O,onFinish:eA,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,s.jsx)(eO,{callbackConfigs:J,selectedCallback:L,onCallbackChange:e=>{Z(e),Y(ez(e,J))}}),(0,s.jsx)(eI,{params:X,callbackConfigs:J,selectedCallback:L}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 mt-6 border-t border-gray-200",children:[(0,s.jsx)(S.Ay,{onClick:()=>{G(!1),Z(null),Y([]),O.resetFields()},disabled:ed,children:"Cancel"}),(0,s.jsx)(S.Ay,{htmlType:"submit",loading:ed,disabled:ed,children:ed?"Adding...":"Add Callback"})]})]})]}),(0,s.jsx)(N.A,{open:ee,width:800,title:"Edit Callback Settings",onCancel:()=>{et(!1),es(null),z.resetFields()},footer:null,children:(0,s.jsxs)(w.A,{form:z,onFinish:ej,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[el&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eO,{callbackConfigs:J,selectedCallback:el.name,onCallbackChange:()=>{},disabled:!0}),(0,s.jsx)(eI,{params:ez(el.name,J,el.variables),callbackConfigs:J,selectedCallback:el.name})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 mt-6 border-t border-gray-200",children:[(0,s.jsx)(S.Ay,{onClick:()=>{et(!1),es(null),z.resetFields()},disabled:eo,children:"Cancel"}),(0,s.jsx)(S.Ay,{onClick:()=>{z.submit()},loading:eo,disabled:eo,children:eo?"Saving...":"Save Changes"})]})]})}),(0,s.jsx)(eu.A,{isOpen:ea,title:"Delete Callback",message:"Are you sure you want to delete this callback? This action cannot be undone.",resourceInformationTitle:"Callback Information",resourceInformation:[{label:"Callback Name",value:en?.name},{label:"Mode",value:en?.mode||"success"}],onCancel:()=>{er(!1),ei(null)},onOk:eC,confirmLoading:eh})]}):null}}}]);