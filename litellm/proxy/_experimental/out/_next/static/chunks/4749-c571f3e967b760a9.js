"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4749],{34749:(e,s,a)=>{a.r(s),a.d(s,{default:()=>en});var t=a(95155),r=a(12115),l=a(47583),n=a(12120),i=a(5723),o=a(22864),d=a(85286),c=a(24611),m=a(23060),x=a(91808),g=a(87278),u=a(22277),h=a(98825),p=a(74220),v=a(10134),f=a(4761),y=a(22603),j=a(28743),b=a(27081),N=a(33210),A=a(89363),w=a(22368),k=a(49619),C=a(6296),T=a(76444),S=a(27397),L=a(8470),P=a(52158),M=a(24777),U=a(79586),R=a(73362);function _({messages:e,isLoading:s}){if(0===e.length)return(0,t.jsx)("div",{className:"h-full"});let a=[],r=0;for(;r<e.length;){let s=e[r];if("user"===s.role){let t=e[r+1];if(t?.role==="assistant"){a.push({user:s,assistant:t}),r+=2;continue}a.push({user:s})}else"assistant"===s.role&&a.push({assistant:s});r+=1}let l=e=>(0,t.jsxs)("div",{className:"whitespace-pre-wrap break-words",style:{wordWrap:"break-word",overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},children:[(0,t.jsx)(P.A,{message:e}),(0,t.jsx)(T.oz,{components:{code({node:e,inline:s,className:a,children:r,...l}){let n=/language-(\w+)/.exec(a||"");return!s&&n?(0,t.jsx)(S.A,{style:L.A,language:n[1],PreTag:"div",className:"rounded-md my-2",wrapLines:!0,wrapLongLines:!0,...l,children:String(r).replace(/\n$/,"")}):(0,t.jsx)("code",{className:`${a} px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono`,...l,children:r})},pre:({node:e,...s})=>(0,t.jsx)("pre",{style:{overflowX:"auto",maxWidth:"100%"},...s})},children:"string"==typeof e.content?e.content:""})]});return(0,t.jsxs)("div",{className:"flex flex-col gap-6 min-w-0 w-full p-4",children:[a.map((e,r)=>{let n=e.assistant,i=n?.model||"助手";return(0,t.jsxs)("div",{className:"space-y-4",children:[e.user&&(0,t.jsxs)("div",{className:"space-y-2 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-blue-100 text-blue-600",children:(0,t.jsx)(w.A,{size:16})}),(0,t.jsx)("div",{className:"text-sm font-semibold text-gray-700",children:"你"})]}),l(e.user)]}),(0,t.jsx)("div",{className:"border-t border-gray-200"}),n?(0,t.jsxs)("div",{className:"space-y-3 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-gray-100 text-gray-600",children:(0,t.jsx)(k.A,{size:16})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-gray-700",children:i}),n.toolName&&(0,t.jsx)("span",{className:"rounded bg-gray-100 px-2 py-0.5 text-xs text-gray-600",children:n.toolName})]})]}),n.reasoningContent&&(0,t.jsx)(M.A,{reasoningContent:n.reasoningContent}),n.searchResults&&(0,t.jsx)(R.X,{searchResults:n.searchResults}),l(n),(n.timeToFirstToken||n.totalLatency||n.usage)&&(0,t.jsx)(U.A,{timeToFirstToken:n.timeToFirstToken,totalLatency:n.totalLatency,usage:n.usage,toolName:n.toolName})]}):s&&r===a.length-1?(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,t.jsx)(C.A,{size:18,className:"animate-spin"}),(0,t.jsx)("span",{children:"正在生成响应..."})]}):(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"等待响应中..."})]},r)}),s&&0===a.length&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,t.jsx)(C.A,{size:18,className:"animate-spin"}),(0,t.jsx)("span",{children:"正在生成响应..."})]})]})}var I=a(95049);function E({value:e,options:s,loading:a,config:r,onChange:l}){return(0,t.jsx)(m.A,{value:e||void 0,placeholder:a?`正在加载${r.selectorLabel}...`:r.selectorPlaceholder,onChange:l,loading:a,showSearch:!0,filterOption:(e,s)=>(s?.label??"").toLowerCase().includes(e.toLowerCase()),options:s,className:"w-48 md:w-64 lg:w-72",notFoundContent:a?(0,t.jsx)("div",{className:"flex items-center justify-center py-2",children:(0,t.jsx)(I.A,{size:"small"})}):`暂无可用${r.selectorLabel}`})}var z=a(6702),O=a(66927),$=a(87433),B=a(61484),D=a(7339),F=a(80609),K=a(23022);let W="/v1/chat/completions",X="/a2a",H={[W]:{id:W,label:"/v1/chat/completions",selectorType:"model",selectorLabel:"模型",selectorPlaceholder:"选择模型",inputPlaceholder:"发送提示词以对比模型",loadingMessage:"正在汇总所有模型的响应...",validationMessage:"发送消息前请先选择模型。"},[X]:{id:X,label:"/a2a（智能体）",selectorType:"agent",selectorLabel:"智能体",selectorPlaceholder:"选择智能体",inputPlaceholder:"发送消息以对比智能体",loadingMessage:"正在汇总所有智能体的响应...",validationMessage:"发送消息前请先选择智能体。"}},Y=e=>"agent"===H[e].selectorType,Q=(e,s)=>Y(s)?e.agent:e.model;function q({comparison:e,onUpdate:s,onRemove:a,canRemove:l,selectorOptions:n,isLoadingOptions:i,endpointConfig:o,apiKey:d}){let c=Y(o.id),m=Q(e,o.id),[x,g]=(0,r.useState)(!1),u=(a,t)=>{s({[a]:t},e.applyAcrossModels?{applyToAll:!0,keysToApply:[a]}:void 0)},h=e.useAdvancedParams?1:.4,p=e.useAdvancedParams?"text-gray-700":"text-gray-400",v=(0,t.jsxs)("div",{className:"w-[300px] max-h-[65vh] overflow-y-auto relative",children:[(0,t.jsx)("button",{onClick:()=>{g(!1)},className:"absolute top-0 right-0 p-1 hover:bg-gray-100 rounded transition-colors text-gray-500 hover:text-gray-700 z-10",children:(0,t.jsx)(N.A,{size:14})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(B.A,{checked:e.applyAcrossModels,onChange:a=>{a.target.checked?s({applyAcrossModels:!0,temperature:e.temperature,maxTokens:e.maxTokens,tags:[...e.tags],vectorStores:[...e.vectorStores],guardrails:[...e.guardrails],useAdvancedParams:e.useAdvancedParams},{applyToAll:!0,keysToApply:["temperature","maxTokens","tags","vectorStores","guardrails","useAdvancedParams"]}):s({applyAcrossModels:!1})},children:(0,t.jsx)("span",{className:"text-xs font-medium",children:"跨模型同步设置"})})}),(0,t.jsx)(D.A,{className:"border-gray-200"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-wide",children:"通用设置"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-600 block mb-0.5",children:"标签"}),(0,t.jsx)(z.A,{value:e.tags,onChange:e=>u("tags",e),accessToken:d})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-600 block mb-0.5",children:"向量库"}),(0,t.jsx)(O.A,{value:e.vectorStores,onChange:e=>u("vectorStores",e),accessToken:d})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-600 block mb-0.5",children:"护栏"}),(0,t.jsx)($.A,{value:e.guardrails,onChange:e=>u("guardrails",e),accessToken:d})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-wide",children:"高级设置"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex items-center gap-2 pb-1",children:(0,t.jsx)(B.A,{checked:e.useAdvancedParams,onChange:a=>{s({useAdvancedParams:a.target.checked},e.applyAcrossModels?{applyToAll:!0,keysToApply:["useAdvancedParams"]}:void 0)},children:(0,t.jsx)("span",{className:"text-sm font-medium",children:"启用高级参数"})})}),(0,t.jsxs)("div",{className:"space-y-2 transition-opacity duration-200",style:{opacity:h},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("label",{className:`text-xs font-medium ${p}`,children:"温度"}),(0,t.jsx)("span",{className:`text-xs ${p}`,children:e.temperature.toFixed(2)})]}),(0,t.jsx)(F.A,{min:0,max:2,step:.01,value:e.temperature,onChange:e=>{u("temperature",Math.min(2,Math.max(0,Number((Array.isArray(e)?e[0]:e).toFixed(2)))))},disabled:!e.useAdvancedParams})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("label",{className:`text-xs font-medium ${p}`,children:"最大 Tokens"}),(0,t.jsx)("span",{className:`text-xs ${p}`,children:e.maxTokens})]}),(0,t.jsx)(F.A,{min:1,max:32768,step:1,value:e.maxTokens,onChange:e=>{u("maxTokens",Math.min(32768,Math.max(1,Math.round(Array.isArray(e)?e[0]:e))))},disabled:!e.useAdvancedParams})]})]})]})]})]})]});return(0,t.jsxs)("div",{className:"bg-white first:border-l-0 border-l border-gray-200 flex flex-col min-h-0",children:[(0,t.jsxs)("div",{className:"border-b flex items-center justify-between gap-3 px-4 py-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,t.jsx)(E,{value:m,options:n,loading:i,config:o,onChange:e=>s(c?{agent:e}:{model:e})}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(K.A,{content:v,trigger:[],open:x,onOpenChange:()=>{},placement:"bottomRight",destroyOnHidden:!1,children:(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),g(e=>!e)},className:`p-2 rounded-lg transition-colors ${x?"bg-gray-200 text-gray-700":"hover:bg-gray-100 text-gray-600"}`,children:(0,t.jsx)(A.A,{size:18})})})})]}),l&&(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),a()},className:"p-2 hover:bg-red-50 text-red-600 rounded-lg transition-colors",children:(0,t.jsx)(N.A,{size:18})})]}),(0,t.jsx)("div",{className:"relative flex-1 flex flex-col min-h-0",children:(0,t.jsx)("div",{className:"flex-1 max-h-[calc(100vh-385px)] overflow-auto rounded-b-2xl",children:(0,t.jsx)(_,{messages:e.messages,isLoading:e.isLoading})})})]})}var G=a(58872);let{TextArea:J}=x.A;function V({value:e,onChange:s,onSend:a,disabled:r,hasAttachment:l,uploadComponent:n}){let i=!r&&(e.trim().length>0||!!l);return(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("div",{className:"flex items-center flex-1 bg-white border border-gray-300 rounded-xl px-3 py-1 min-h-[44px]",children:[n&&(0,t.jsx)("div",{className:"flex-shrink-0 mr-2",children:n}),(0,t.jsx)(J,{value:e,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),i&&a())},placeholder:"输入你的消息...（Shift+Enter 换行）",disabled:r,className:"flex-1",autoSize:{minRows:1,maxRows:4},style:{resize:"none",border:"none",boxShadow:"none",background:"transparent",padding:"4px 0",fontSize:"14px",lineHeight:"20px"}}),(0,t.jsx)(g.Ay,{onClick:a,disabled:!i,icon:(0,t.jsx)(G.A,{}),shape:"circle"})]})})}let Z=["请总结关键要点。","你做了哪些假设？","下一步建议是什么？"],ee=["写一首诗","解释一下量子计算","帮我起草一封礼貌的会议邀请邮件"];function es({accessToken:e,disabledPersonalKeyCreation:s}){let[a,l]=(0,r.useState)([{id:"1",model:"",agent:"",messages:[],isLoading:!1,tags:[],mcpTools:[],vectorStores:[],guardrails:[],temperature:1,maxTokens:2048,applyAcrossModels:!1,useAdvancedParams:!1},{id:"2",model:"",agent:"",messages:[],isLoading:!1,tags:[],mcpTools:[],vectorStores:[],guardrails:[],temperature:1,maxTokens:2048,applyAcrossModels:!1,useAdvancedParams:!1}]),[N,A]=(0,r.useState)([]),[w,k]=(0,r.useState)([]),[C,T]=(0,r.useState)(!1),[S,L]=(0,r.useState)(!1),[P,M]=(0,r.useState)(W),U=H[P],R=Y(P),_=R?w.map(e=>({value:e.agent_name,label:e.agent_name||e.agent_id})):N.map(e=>({value:e,label:e})),I=R?S:C,[E,z]=(0,r.useState)(""),[O,$]=(0,r.useState)(null),[B,D]=(0,r.useState)(null),[F,K]=(0,r.useState)(s?"custom":"session"),[X,G]=(0,r.useState)(""),[J,es]=(0,r.useState)(""),[ea]=(0,r.useState)(()=>sessionStorage.getItem("customProxyBaseUrl")||"");(0,r.useEffect)(()=>{let e=setTimeout(()=>{es(X)},300);return()=>clearTimeout(e)},[X]),(0,r.useEffect)(()=>()=>{B&&URL.revokeObjectURL(B)},[B]);let et=(0,r.useMemo)(()=>"session"===F?e||"":J.trim(),[F,e,J]),er=(0,r.useMemo)(()=>a.length>0&&a.every(e=>!e.isLoading&&e.messages.some(e=>"assistant"===e.role)),[a]);(0,r.useEffect)(()=>{let e=!0;return(async()=>{if(!et)return A([]);T(!0);try{let s=await (0,y.Q)(et);if(!e)return;let a=Array.from(new Set(s.map(e=>e.model_group)));A(a)}catch(s){console.error("CompareUI: failed to fetch models",s),e&&A([])}finally{e&&T(!1)}})(),()=>{e=!1}},[et]),(0,r.useEffect)(()=>{let e=!0;return(async()=>{if(!et||!R)return k([]);L(!0);try{let s=await (0,j.C)(et,ea||void 0);if(!e)return;k(s)}catch(s){console.error("CompareUI: failed to fetch agents",s),e&&k([])}finally{e&&L(!1)}})(),()=>{e=!1}},[et,R]),(0,r.useEffect)(()=>{0!==N.length&&l(e=>e.map((e,s)=>({...e,temperature:e.temperature??1,maxTokens:e.maxTokens??2048,applyAcrossModels:e.applyAcrossModels??!1,useAdvancedParams:e.useAdvancedParams??!1,...e.model?{}:{model:N[s%N.length]??""}})))},[N]);let el=()=>{B&&URL.revokeObjectURL(B),$(null),D(null)},en=(e,s)=>{l(a=>a.map(a=>{if(a.id!==e)return a;let t=[...a.messages],r=t[t.length-1];return r&&"assistant"===r.role?t[t.length-1]={...r,timeToFirstToken:s}:r&&"user"===r.role&&t.push({role:"assistant",content:"",timeToFirstToken:s}),{...a,messages:t}}))},ei=(e,s)=>{l(a=>a.map(a=>{if(a.id!==e)return a;let t=[...a.messages],r=t[t.length-1];return r&&"assistant"===r.role?t[t.length-1]={...r,totalLatency:s}:r&&"user"===r.role&&t.push({role:"assistant",content:"",totalLatency:s}),{...a,messages:t}}))},eo=!!e,ed=async e=>{let s=e.trim(),t=!!O;if(!s&&!t)return;if(!et)return void n.Ay.fromBackend("请提供虚拟密钥，或选择“当前 UI 会话”");if(0===a.length)return;if(a.some(e=>{let s;return!((s=Q(e,P))&&s.trim())}))return void n.Ay.fromBackend(U.validationMessage);let r=t?await (0,v.Uv)(s,O):{role:"user",content:s},i=(0,v.CR)(s,t,B||void 0,O?.name),o=new Map;a.forEach(e=>{let a=e.traceId??(0,h.A)(),t=[...e.messages.map(({role:e,content:s})=>({role:e,content:Array.isArray(s)||"string"==typeof s?s:""})),r];o.set(e.id,{id:e.id,model:e.model,agent:e.agent,inputMessage:s,traceId:a,tags:e.tags,vectorStores:e.vectorStores,guardrails:e.guardrails,temperature:e.temperature,maxTokens:e.maxTokens,displayMessages:[...e.messages,i],apiChatHistory:t})}),0!==o.size&&(l(e=>e.map(e=>{let s=o.get(e.id);return s?{...e,traceId:s.traceId,messages:s.displayMessages,isLoading:!0}:e})),z(""),el(),o.forEach(e=>{let s=e.tags.length>0?e.tags:void 0,t=e.vectorStores.length>0?e.vectorStores:void 0,r=e.guardrails.length>0?e.guardrails:void 0,i=a.find(s=>s.id===e.id),o=i?.useAdvancedParams??!1;(R?(0,b.B)(e.agent,e.inputMessage,(s,a)=>{l(t=>t.map(t=>{if(t.id!==e.id)return t;let r=[...t.messages],l=r[r.length-1];return l&&"assistant"===l.role?r[r.length-1]={...l,content:s,model:l.model??a}:r.push({role:"assistant",content:s,model:a}),{...t,messages:r}}))},et,void 0,s=>en(e.id,s),s=>ei(e.id,s),void 0,ea||void 0):(0,f.u)(e.apiChatHistory,(s,a)=>{var t;return t=e.id,void(s&&l(e=>e.map(e=>{if(e.id!==t)return e;let r=[...e.messages],l=r[r.length-1];if(l&&"assistant"===l.role){let e="string"==typeof l.content?l.content:"";r[r.length-1]={...l,content:e+s,model:l.model??a}}else r.push({role:"assistant",content:s,model:a});return{...e,messages:r}})))},e.model,et,s,void 0,s=>{var a;return a=e.id,void(s&&l(e=>e.map(e=>{if(e.id!==a)return e;let t=[...e.messages],r=t[t.length-1];return r&&"assistant"===r.role?t[t.length-1]={...r,reasoningContent:(r.reasoningContent||"")+s}:r&&"user"===r.role&&t.push({role:"assistant",content:"",reasoningContent:s}),{...e,messages:t}})))},s=>en(e.id,s),s=>{var a;return a=e.id,void l(e=>e.map(e=>{if(e.id!==a)return e;let t=[...e.messages],r=t[t.length-1];return r&&"assistant"===r.role&&(t[t.length-1]={...r,usage:s,toolName:void 0}),{...e,messages:t}}))},e.traceId,t,r,void 0,void 0,void 0,s=>{var a;return a=e.id,void(s&&l(e=>e.map(e=>{if(e.id!==a)return e;let t=[...e.messages],r=t[t.length-1];return r&&"assistant"===r.role&&(t[t.length-1]={...r,searchResults:s}),{...e,messages:t}})))},o?e.temperature:void 0,o?e.maxTokens:void 0,s=>ei(e.id,s),ea||void 0)).catch(s=>{let a=s instanceof Error?s.message:String(s);console.error("CompareUI: failed to fetch response",s),n.Ay.fromBackend(a),l(s=>s.map(s=>{if(s.id!==e.id)return s;let t=[...s.messages],r=t[t.length-1],l=r&&"assistant"===r.role&&"string"==typeof r.content?r.content:"";return r&&"assistant"===r.role?t[t.length-1]={...r,content:l?`${l}
获取响应失败：${a}`:`获取响应失败：${a}`}:t.push({role:"assistant",content:`获取响应失败：${a}`}),{...s,messages:t}}))}).finally(()=>{l(s=>s.map(s=>s.id===e.id?{...s,isLoading:!1}:s))})}))},ec=e=>{z(e)},em=a.some(e=>e.messages.length>0),ex=a.some(e=>e.isLoading),eg=!!O,eu=!!O?.name.toLowerCase().endsWith(".pdf"),eh=!em&&!ex&&!eg;return(0,t.jsx)("div",{className:"w-full h-full p-4 bg-white",children:(0,t.jsxs)("div",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm min-h-[calc(100vh-160px)] flex flex-col",children:[(0,t.jsx)("div",{className:"border-b px-4 py-2",children:(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"虚拟密钥来源"}),(0,t.jsxs)(m.A,{value:F,onChange:e=>K(e),disabled:s,className:"w-48",children:[(0,t.jsx)(m.A.Option,{value:"session",disabled:!eo,children:"当前 UI 会话"}),(0,t.jsx)(m.A.Option,{value:"custom",children:"虚拟密钥"})]}),"custom"===F&&(0,t.jsx)(x.A.Password,{value:X,onChange:e=>G(e.target.value),placeholder:"输入虚拟密钥",className:"w-56"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"端点"}),(0,t.jsx)(m.A,{value:P,onChange:e=>M(e),className:"w-56",children:Object.values(H).map(e=>({value:e.id,label:e.label})).map(e=>(0,t.jsx)(m.A.Option,{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(g.Ay,{onClick:()=>{l(e=>e.map(e=>({...e,messages:[],traceId:void 0,isLoading:!1}))),z(""),el()},disabled:!em,icon:(0,t.jsx)(i.A,{}),children:"清空全部对话"}),(0,t.jsx)(u.A,{title:a.length>=3?"最多可同时对比 3 个模型":"添加一个对比栏",children:(0,t.jsx)(g.Ay,{onClick:()=>{if(a.length>=3)return;let e=N[a.length%(N.length||1)]??"",s=w[a.length%(w.length||1)]?.agent_name??"",t={id:Date.now().toString(),model:e,agent:s,messages:[],isLoading:!1,tags:[],mcpTools:[],vectorStores:[],guardrails:[],temperature:1,maxTokens:2048,applyAcrossModels:!1,useAdvancedParams:!1};l(e=>[...e,t])},disabled:a.length>=3,icon:(0,t.jsx)(o.A,{}),children:"添加对比"})})]})]})}),(0,t.jsx)("div",{className:"grid flex-1 min-h-0 auto-rows-[minmax(0,1fr)]",style:{gridTemplateColumns:`repeat(${a.length}, minmax(0, 1fr))`},children:a.map(e=>(0,t.jsx)(q,{comparison:e,onUpdate:(s,a)=>{var t;return t=e.id,void l(e=>{if(a?.applyToAll&&a.keysToApply?.length){let r={};a.keysToApply.forEach(e=>{let a=s[e];void 0!==a&&(r[e]=Array.isArray(a)?[...a]:a)});let l=Object.keys(r).length>0;return e.map(e=>e.id===t?{...e,...s}:l?{...e,...r}:e)}return e.map(e=>e.id===t?{...e,...s}:e)})},onRemove:()=>{var s;return s=e.id,void(a.length>1&&l(e=>e.filter(e=>e.id!==s)))},canRemove:a.length>1,selectorOptions:_,isLoadingOptions:I,endpointConfig:U,apiKey:et},e.id))}),(0,t.jsx)("div",{className:"flex justify-center pb-4",children:(0,t.jsx)("div",{className:"w-full max-w-3xl px-4",children:(0,t.jsxs)("div",{className:"border border-gray-200 shadow-lg rounded-xl bg-white p-4",children:[(0,t.jsx)("div",{className:"flex items-center justify-between gap-4 mb-3 min-h-8",children:eg?(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"附件已就绪，可发送"}):eh?(0,t.jsx)("div",{className:"flex items-center gap-2 overflow-x-auto",children:ee.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>ec(e),className:"shrink-0 rounded-full border border-gray-200 px-3 py-1 text-xs font-medium text-gray-600 transition-colors hover:bg-gray-100 cursor-pointer",children:e},e))}):er&&!eg?(0,t.jsx)("div",{className:"flex items-center gap-2 overflow-x-auto",children:Z.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>ec(e),className:"shrink-0 rounded-full border border-gray-200 px-3 py-1 text-xs font-medium text-gray-600 transition-colors hover:bg-gray-100 cursor-pointer",children:e},e))}):ex?(0,t.jsxs)("span",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,t.jsx)("span",{className:"h-2 w-2 rounded-full bg-blue-500 animate-pulse","aria-hidden":!0}),U.loadingMessage]}):(0,t.jsx)("span",{className:"text-sm text-gray-500",children:U.inputPlaceholder})}),O&&(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,t.jsx)("div",{className:"relative inline-block",children:eu?(0,t.jsx)("div",{className:"w-10 h-10 rounded-md bg-red-500 flex items-center justify-center",children:(0,t.jsx)(d.A,{style:{fontSize:"16px",color:"white"}})}):(0,t.jsx)("img",{src:B||"",alt:"Upload preview",className:"w-10 h-10 rounded-md border border-gray-200 object-cover"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:O.name}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:eu?"PDF":"图片"})]}),(0,t.jsx)("button",{className:"flex items-center justify-center w-6 h-6 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded-full transition-colors",onClick:el,children:(0,t.jsx)(c.A,{style:{fontSize:"12px"}})})]})}),(0,t.jsx)(V,{value:E,onChange:e=>{z(e)},onSend:()=>{ed(E)},disabled:0===a.length||a.every(e=>e.isLoading),hasAttachment:eg,uploadComponent:(0,t.jsx)(p.A,{chatUploadedImage:O,chatImagePreviewUrl:B,onImageUpload:e=>(B&&URL.revokeObjectURL(B),$(e),D(URL.createObjectURL(e)),!1),onRemoveImage:el})})]})})})]})})}var ea=a(96130),et=a(42696),er=a(27428),el=a(63847);function en(){let{accessToken:e,userRole:s,userId:a,disabledPersonalKeyCreation:n,token:i}=(0,et.A)(),o=(0,el.W)("zh-CN"),d=(0,el.W)("en-US"),c=(e,s)=>{let a=s.split("."),t=e;for(let e of a)if(!t||"object"!=typeof t||!(e in t))return null;else t=t[e];return"string"==typeof t?t:null},m=(e,s)=>c(o,e)||c(d,e)||s,[x,g]=(0,r.useState)(void 0);return(0,r.useEffect)(()=>{(async()=>{if(e){let s=await (0,er.g)(e);s&&g({PROXY_BASE_URL:s.PROXY_BASE_URL,LITELLM_UI_API_DOC_BASE_URL:s.LITELLM_UI_API_DOC_BASE_URL})}})()},[e]),(0,t.jsxs)(ea.fu,{className:"h-full w-full",children:[(0,t.jsxs)(ea.wb,{className:"mb-0",children:[(0,t.jsx)(ea.oz,{children:m("playground.tabs.chat","Chat")}),(0,t.jsx)(ea.oz,{children:m("playground.tabs.compare","Compare")})]}),(0,t.jsxs)(ea.T2,{className:"h-full",children:[(0,t.jsx)(ea.Kp,{className:"h-full",children:(0,t.jsx)(l.A,{accessToken:e,token:i,userRole:s,userID:a,disabledPersonalKeyCreation:n,proxySettings:x})}),(0,t.jsx)(ea.Kp,{className:"h-full",children:(0,t.jsx)(es,{accessToken:e,disabledPersonalKeyCreation:n})})]})]})}}}]);