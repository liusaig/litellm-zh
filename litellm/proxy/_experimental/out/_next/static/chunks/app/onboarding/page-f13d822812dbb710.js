(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9566],{6376:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>M});var i=s(95155),r=s(12115),n=s(73321),a=s(26430),o=s(35625),u=s(19253),l=s(28436),c=s(26708),d=s(48934),h=s(64394);let m=(0,s(90078).D)("onboarding");var p=s(95049),x=s(34568);function y(){return(0,i.jsx)("div",{className:"mx-auto w-full max-w-md mt-10 flex justify-center",children:(0,i.jsx)(p.A,{indicator:(0,i.jsx)(x.A,{spin:!0}),size:"large"})})}var f=s(99876),j=s(87278);function b(){return(0,i.jsxs)("div",{className:"mx-auto w-full max-w-md mt-10",children:[(0,i.jsx)(f.A,{type:"error",message:"Failed to load invitation",description:"The invitation link may be invalid or expired.",showIcon:!0}),(0,i.jsx)("div",{className:"mt-4",children:(0,i.jsx)(j.Ay,{href:"/ui/login",children:"Back to Login"})})]})}var w=s(25387),g=s(69779),v=s(41326),O=s(91808);function A({variant:t,userEmail:e,isPending:s,claimError:n,onSubmit:a}){let[o]=w.A.useForm();return r.useEffect(()=>{e&&o.setFieldValue("user_email",e)},[e,o]),(0,i.jsx)("div",{className:"mx-auto w-full max-w-md mt-10",children:(0,i.jsxs)(g.A,{children:[(0,i.jsx)(v.A.Title,{level:5,className:"text-center mb-5",children:"\uD83D\uDE85 Silinex"}),(0,i.jsx)(v.A.Title,{level:3,children:"reset_password"===t?"Reset Password":"Sign Up"}),(0,i.jsx)(v.A.Text,{children:"reset_password"===t?"Reset your password to access Admin UI.":"Claim your user account to login to Admin UI."}),"signup"===t&&(0,i.jsx)(f.A,{className:"mt-4",type:"info",message:"SSO",description:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("span",{children:"SSO is under the Enterprise Tier."}),(0,i.jsx)(j.Ay,{type:"primary",size:"small",href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"Get Free Trial"})]}),showIcon:!0}),(0,i.jsxs)(w.A,{className:"mt-10 mb-5",layout:"vertical",form:o,onFinish:t=>a({password:t.password}),children:[(0,i.jsx)(w.A.Item,{label:"Email Address",name:"user_email",children:(0,i.jsx)(O.A,{type:"email",disabled:!0})}),(0,i.jsx)(w.A.Item,{label:"Password",name:"password",rules:[{required:!0,message:"password required to sign up"}],help:"reset_password"===t?"Enter your new password":"Create a password for your account",children:(0,i.jsx)(O.A.Password,{})}),n&&(0,i.jsx)(f.A,{type:"error",message:n,showIcon:!0,className:"mb-4"}),(0,i.jsx)("div",{className:"mt-10",children:(0,i.jsx)(j.Ay,{htmlType:"submit",loading:s,children:"reset_password"===t?"Reset Password":"Sign Up"})})]})]})})}function E({variant:t}){let e=(0,n.useSearchParams)().get("invitation_id"),[s,a]=r.useState(null),{data:o,isLoading:p,isError:x}=(t=>{let{isLoading:e}=(0,h._)();return(0,c.I)({queryKey:m.detail(t??""),queryFn:async()=>{if(!t)throw Error("inviteId is required");return(0,l.getOnboardingCredentials)(t)},enabled:!!t&&!e})})(e),{mutate:f,isPending:j}=(0,d.n)({mutationFn:async({accessToken:t,inviteId:e,userId:s,password:i})=>await (0,l.claimOnboardingToken)(t,e,s,i)}),w=o?.token?(0,u.s)(o.token):null,g=w?.user_email??"",v=w?.user_id??null,O=w?.key??null,E=o?.token??null;return p?(0,i.jsx)(y,{}):x?(0,i.jsx)(b,{}):(0,i.jsx)(A,{variant:t,userEmail:g,isPending:j,claimError:s,onSubmit:t=>{O&&E&&v&&e&&(a(null),f({accessToken:O,inviteId:e,userId:v,password:t.password},{onSuccess:()=>{document.cookie=`token=${E}; path=/; SameSite=Lax`;let t=(0,l.getProxyBaseUrl)();window.location.href=t?`${t}/ui/?login=success`:"/ui/?login=success"},onError:t=>{a(t.message||"Failed to submit. Please try again.")}}))}})}let S=new a.E;function _(){let t=(0,n.useSearchParams)().get("action");return(0,i.jsx)(E,{variant:"reset_password"===t?"reset_password":"signup"})}function M(){return(0,i.jsx)(o.Ht,{client:S,children:(0,i.jsx)(r.Suspense,{fallback:(0,i.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."}),children:(0,i.jsx)(_,{})})})}},15231:(t,e,s)=>{Promise.resolve().then(s.bind(s,6376))},48934:(t,e,s)=>{"use strict";s.d(e,{n:()=>c});var i=s(12115),r=s(53390),n=s(31967),a=s(98216),o=s(5858),u=class extends a.Q{#t;#e=void 0;#s;#i;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#t.defaultMutationOptions(t),(0,o.f8)(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,o.EN)(e.mutationKey)!==(0,o.EN)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(t){this.#r(),this.#n(t)}getCurrentResult(){return this.#e}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#r(),this.#n()}mutate(t,e){return this.#i=e,this.#s?.removeObserver(this),this.#s=this.#t.getMutationCache().build(this.#t,this.options),this.#s.addObserver(this),this.#s.execute(t)}#r(){let t=this.#s?.state??(0,r.$)();this.#e={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#n(t){n.jG.batch(()=>{if(this.#i&&this.hasListeners()){let e=this.#e.variables,s=this.#e.context,i={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if(t?.type==="success"){try{this.#i.onSuccess?.(t.data,e,s,i)}catch(t){Promise.reject(t)}try{this.#i.onSettled?.(t.data,null,e,s,i)}catch(t){Promise.reject(t)}}else if(t?.type==="error"){try{this.#i.onError?.(t.error,e,s,i)}catch(t){Promise.reject(t)}try{this.#i.onSettled?.(void 0,t.error,e,s,i)}catch(t){Promise.reject(t)}}}this.listeners.forEach(t=>{t(this.#e)})})}},l=s(35625);function c(t,e){let s=(0,l.jE)(e),[r]=i.useState(()=>new u(s,t));i.useEffect(()=>{r.setOptions(t)},[r,t]);let a=i.useSyncExternalStore(i.useCallback(t=>r.subscribe(n.jG.batchCalls(t)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),c=i.useCallback((t,e)=>{r.mutate(t,e).catch(o.lQ)},[r]);if(a.error&&(0,o.GU)(r.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:c,mutateAsync:a.mutate}}}},t=>{t.O(0,[3725,5884,1145,1326,8536,3146,9904,5049,2360,6430,4394,8441,3794,7358],()=>t(t.s=15231)),_N_E=t.O()}]);