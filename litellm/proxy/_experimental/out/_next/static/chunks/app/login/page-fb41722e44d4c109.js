(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4520],{12608:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>N});var t=r(95155),n=r(48934),i=r(28436),a=r(64394),l=r(96637),c=r(12352),d=r(97035),o=r(26430),u=r(35625),m=r(41326),x=r(69779),h=r(54481),f=r(99876),g=r(25387),j=r(91808),p=r(87278),y=r(23022),A=r(73321),v=r(12115);function b(){let[e,s]=(0,v.useState)(""),[r,o]=(0,v.useState)(""),[u,b]=(0,v.useState)(!0),{data:N,isLoading:S}=(0,a._)(),_=(0,n.n)({mutationFn:async({username:e,password:s})=>await (0,i.loginCall)(e,s)}),w=(0,A.useRouter)();(0,v.useEffect)(()=>{if(S)return;if(N&&N.admin_ui_disabled)return void b(!1);let e=(0,c.R)("token");e&&!(0,d.xP)(e)?w.replace(`${(0,i.getProxyBaseUrl)()}/ui`):N&&N.auto_redirect_to_sso?w.push(`${(0,i.getProxyBaseUrl)()}/sso/key/generate`):b(!1)},[S,w,N]);let k=_.error instanceof Error?_.error.message:null,C=_.isPending,{Title:I,Text:O,Paragraph:z}=m.A;return S||u?(0,t.jsx)(l.A,{}):N&&N.admin_ui_disabled?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)(x.A,{className:"w-full max-w-lg shadow-md",children:(0,t.jsx)(h.A,{direction:"vertical",size:"middle",className:"w-full",children:(0,t.jsx)(f.A,{message:"管理后台已禁用",description:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(z,{className:"text-sm",children:"管理员已禁用管理后台。若需重新启用，请更新以下环境变量："}),(0,t.jsx)(z,{className:"text-sm",children:(0,t.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded text-xs",children:"DISABLE_ADMIN_UI=False"})})]}),type:"warning",showIcon:!0})})})}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsxs)(x.A,{className:"w-full max-w-lg shadow-md",children:[(0,t.jsxs)(h.A,{direction:"vertical",size:"middle",className:"w-full",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(I,{level:3,children:"登录"}),(0,t.jsx)(O,{type:"secondary",children:"访问网关管理后台。"})]}),k&&(0,t.jsx)(f.A,{message:k,type:"error",showIcon:!0}),(0,t.jsxs)(g.A,{onFinish:()=>{_.mutate({username:e,password:r},{onSuccess:e=>{w.push(e.redirect_url)}})},layout:"vertical",requiredMark:!0,children:[(0,t.jsx)(g.A.Item,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名"}],children:(0,t.jsx)(j.A,{placeholder:"请输入用户名",autoComplete:"username",value:e,onChange:e=>s(e.target.value),disabled:C,size:"large",className:"rounded-md border-gray-300"})}),(0,t.jsx)(g.A.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码"}],children:(0,t.jsx)(j.A.Password,{placeholder:"请输入密码",autoComplete:"current-password",value:r,onChange:e=>o(e.target.value),disabled:C,size:"large"})}),(0,t.jsx)(g.A.Item,{children:(0,t.jsx)(p.Ay,{type:"primary",htmlType:"submit",loading:C,disabled:C,block:!0,size:"large",children:C?"登录中...":"登录"})}),(0,t.jsx)(g.A.Item,{children:N?.sso_configured?(0,t.jsx)(p.Ay,{disabled:C,onClick:()=>w.push(`${(0,i.getProxyBaseUrl)()}/sso/key/generate`),block:!0,size:"large",children:"使用 SSO 登录"}):(0,t.jsx)(y.A,{content:"请先配置 SSO 后再使用 SSO 登录。",trigger:"hover",children:(0,t.jsx)(p.Ay,{disabled:!0,block:!0,size:"large",children:"使用 SSO 登录"})})})]})]}),N?.sso_configured&&(0,t.jsx)(f.A,{type:"info",showIcon:!0,closable:!0,message:(0,t.jsxs)(O,{children:["已启用单点登录（SSO）。Silinex 现在在加载此页面时不再自动跳转到 SSO 登录流程。若要恢复自动跳转，请在环境配置中设置",(0,t.jsx)(O,{code:!0,children:"AUTO_REDIRECT_UI_LOGIN_TO_SSO=true"}),"。"]})})]})})}let N=function(){let e=new o.E;return(0,t.jsx)(u.Ht,{client:e,children:(0,t.jsx)(b,{})})}},87287:(e,s,r)=>{"use strict";r.d(s,{cx:()=>a});var t=r(57838),n=r(622);let{cva:i,cx:a,compose:l}=(0,t.C8)({hooks:{onComplete:e=>(0,n.QP)(e)}})},95480:(e,s,r)=>{"use strict";r.d(s,{S:()=>a});var t=r(95155),n=r(12115),i=r(87287);function a({className:e="",...s}){var r,a;let l=(0,n.useId)();return r=()=>{let e=document.getAnimations().filter(e=>e instanceof CSSAnimation&&"spin"===e.animationName),s=e.find(e=>e.effect.target?.getAttribute("data-spinner-id")===l),r=e.find(e=>e.effect instanceof KeyframeEffect&&e.effect.target?.getAttribute("data-spinner-id")!==l);s&&r&&(s.currentTime=r.currentTime)},a=[l],(0,n.useLayoutEffect)(r,a),(0,t.jsxs)("svg",{"data-spinner-id":l,className:(0,i.cx)("pointer-events-none size-12 animate-spin text-current",e),fill:"none",viewBox:"0 0 24 24",...s,children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},96637:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});var t=r(95155),n=r(87287),i=r(95480);function a(){return(0,t.jsxs)("div",{className:(0,n.cx)("h-screen","flex items-center justify-center gap-4"),children:[(0,t.jsxs)("div",{className:"text-lg font-medium py-2 pr-4 border-r border-r-gray-200 flex items-center gap-2",children:[(0,t.jsx)("img",{src:"https://cloud.siliconflow.cn/favicon.ico",alt:"Silinex Favicon",className:"w-5 h-5"}),(0,t.jsx)("span",{children:"Silinex"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,t.jsx)(i.S,{className:"size-4"}),(0,t.jsx)("span",{className:"text-gray-600 text-sm",children:"Loading..."})]})]})}},97035:(e,s,r)=>{"use strict";r.d(s,{eP:()=>a,oL:()=>i,xP:()=>n});var t=r(19253);function n(e){try{let s=(0,t.s)(e);if(s&&"number"==typeof s.exp)return 1e3*s.exp<=Date.now();return!1}catch{return!0}}function i(e){if(!e)return null;try{return(0,t.s)(e)}catch{return null}}function a(e){return!!e&&null!==i(e)&&!n(e)}},98683:(e,s,r)=>{Promise.resolve().then(r.bind(r,12608))}},e=>{e.O(0,[3725,5884,1145,1326,8536,3146,9904,2360,4725,6430,4281,4394,8441,3794,7358],()=>e(e.s=98683)),_N_E=e.O()}]);