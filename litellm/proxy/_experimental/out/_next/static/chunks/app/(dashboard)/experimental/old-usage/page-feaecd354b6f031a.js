(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3173],{6018:(e,t,a)=>{Promise.resolve().then(a.bind(a,59949))},19910:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var l=a(65672),s=a(12115);let r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"robot",theme:"outlined"};var n=a(40049);let i=s.forwardRef(function(e,t){return s.createElement(n.A,(0,l.A)({},e,{ref:t,icon:r}))})},20393:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var l=a(49303),s=a(12115),r=a(97413),n=a(30458),i=a(39237);let o=(0,i.St)("BarList");function c(e,t){let{data:a=[],color:c,valueFormatter:d=i.d5,showAnimation:m=!1,onValueChange:u,sortOrder:x="descending",className:h}=e,g=(0,l.Tt)(e,["data","color","valueFormatter","showAnimation","onValueChange","sortOrder","className"]),p=u?"button":"div",b=s.useMemo(()=>"none"===x?a:[...a].sort((e,t)=>"ascending"===x?e.value-t.value:t.value-e.value),[a,x]),f=s.useMemo(()=>{let e=Math.max(...b.map(e=>e.value),0);return b.map(t=>0===t.value?0:Math.max(t.value/e*100,2))},[b]);return s.createElement("div",Object.assign({ref:t,className:(0,n.b)(o("root"),"flex justify-between space-x-6",h),"aria-sort":x},g),s.createElement("div",{className:(0,n.b)(o("bars"),"relative w-full space-y-1.5")},b.map((e,t)=>{var a,l,d;let x=e.icon;return s.createElement(p,{key:null!=(a=e.key)?a:t,onClick:()=>{null==u||u(e)},className:(0,n.b)(o("bar"),"group w-full flex items-center rounded-tremor-small",u?["cursor-pointer","hover:bg-tremor-background-muted dark:hover:bg-dark-tremor-background-subtle/40"]:"")},s.createElement("div",{className:(0,n.b)("flex items-center rounded transition-all bg-opacity-40","h-8",e.color||c?[(0,i.iv)(null!=(l=e.color)?l:c,r.J.background).bgColor,u?"group-hover:bg-opacity-30":""]:"bg-tremor-brand-subtle dark:bg-dark-tremor-brand-subtle/60",!u||e.color||c?"":"group-hover:bg-tremor-brand-subtle/30 group-hover:dark:bg-dark-tremor-brand-subtle/70",t===b.length-1?"mb-0":"",m?"duration-500":""),style:{width:`${f[t]}%`,transition:m?"all 1s":""}},s.createElement("div",{className:(0,n.b)("absolute left-2 pr-4 flex max-w-full")},x?s.createElement(x,{className:(0,n.b)(o("barIcon"),"flex-none h-5 w-5 mr-2","text-tremor-content","dark:text-dark-tremor-content")}):null,e.href?s.createElement("a",{href:e.href,target:null!=(d=e.target)?d:"_blank",rel:"noreferrer",className:(0,n.b)(o("barLink"),"whitespace-nowrap hover:underline truncate text-tremor-default",u?"cursor-pointer":"","text-tremor-content-emphasis","dark:text-dark-tremor-content-emphasis"),onClick:e=>e.stopPropagation()},e.name):s.createElement("p",{className:(0,n.b)(o("barText"),"whitespace-nowrap truncate text-tremor-default","text-tremor-content-emphasis","dark:text-dark-tremor-content-emphasis")},e.name))))})),s.createElement("div",{className:o("labels")},b.map((e,t)=>{var a;return s.createElement("div",{key:null!=(a=e.key)?a:t,className:(0,n.b)(o("labelWrapper"),"flex justify-end items-center","h-8",t===b.length-1?"mb-0":"mb-1.5")},s.createElement("p",{className:(0,n.b)(o("labelText"),"whitespace-nowrap leading-none truncate text-tremor-default","text-tremor-content-emphasis","dark:text-dark-tremor-content-emphasis")},d(e.value)))})))}c.displayName="BarList";let d=s.forwardRef(c)},29722:(e,t,a)=>{"use strict";function l(){for(var e,t,a=0,l="",s=arguments.length;a<s;a++)(e=arguments[a])&&(t=function e(t){var a,l,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t)if(Array.isArray(t)){var r=t.length;for(a=0;a<r;a++)t[a]&&(l=e(t[a]))&&(s&&(s+=" "),s+=l)}else for(l in t)t[l]&&(s&&(s+=" "),s+=l);return s}(e))&&(l&&(l+=" "),l+=t);return l}a.d(t,{$:()=>l,A:()=>s});let s=l},34844:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var l=a(95155),s=a(12115),r=a(28436),n=a(88534),i=a(42696);let o=({userSpend:e,userMaxBudget:t,selectedTeam:a})=>{let{accessToken:o,userRole:c,userId:d}=(0,i.A)(),[m,u]=(0,s.useState)(null!==e?e:0),[x,h]=(0,s.useState)(a?Number((0,n.HY)(a.max_budget,4)):null);(0,s.useEffect)(()=>{if(a)if("Default Team"===a.team_alias)h(t);else{let e=!1;if(a.team_memberships)for(let t of a.team_memberships)t.user_id===d&&"max_budget"in t.litellm_budget_table&&null!==t.litellm_budget_table.max_budget&&(h(t.litellm_budget_table.max_budget),e=!0);e||h(a.max_budget)}else h(t)},[a,t]);let[g,p]=(0,s.useState)([]);(0,s.useEffect)(()=>{let e=async()=>{if(!o||!d||!c)return};(async()=>{try{if(null===d||null===c)return;if(null!==o){let e=(await (0,r.modelAvailableCall)(o,d,c)).data.map(e=>e.id);console.log("available_model_names:",e),p(e)}}catch(e){console.error("Error fetching user models:",e)}})(),e()},[c,o,d]),(0,s.useEffect)(()=>{null!==e&&u(e)},[e]);let b=[];a&&a.models&&(b=a.models),b&&b.includes("all-proxy-models")?(console.log("user models:",g),b=g):b&&b.includes("all-team-models")?b=a.models:b&&0===b.length&&(b=g);let f=null!==x?`\xa5${(0,n.HY)(Number(x),4)}`:"不限制",v=void 0!==m?(0,n.HY)(m,4):null,y=null===x?"无限":`\xa5${(0,n.HY)(Number(x)-Number(m||0),4)}`;return console.log(`spend in view user spend: ${m}`),(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsxs)("div",{className:"flex justify-between gap-x-10",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs text-slate-500 font-medium tracking-wide",children:"总花费"}),(0,l.jsxs)("p",{className:"text-[26px] md:text-[30px] text-slate-900 font-semibold leading-tight mt-1.5",children:["\xa5",v]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs text-slate-500 font-medium tracking-wide",children:"最大预算"}),(0,l.jsx)("p",{className:"text-[26px] md:text-[30px] text-slate-900 font-semibold leading-tight mt-1.5",children:f})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs text-slate-500 font-medium tracking-wide",children:"余额"}),(0,l.jsx)("p",{className:"text-[26px] md:text-[30px] text-slate-900 font-semibold leading-tight mt-1.5",children:y})]})]})})}},48658:(e,t,a)=>{"use strict";a.d(t,{BF:()=>s.A,Hj:()=>o.A,M_:()=>i.A,XI:()=>l.A,nA:()=>r.A,nd:()=>n.A});var l=a(30489),s=a(96961),r=a(95517),n=a(8179),i=a(31556),o=a(95171)},53672:(e,t,a)=>{"use strict";a.d(t,{b:()=>o});var l=a(95155),s=a(12115),r=a(37621),n=a(3134),i=a(48658);function o({data:e=[],columns:t,onRowClick:a,renderSubComponent:o,renderChildRows:c,getRowCanExpand:d,isLoading:m=!1,loadingMessage:u="\uD83D\uDE85 Loading logs...",noDataMessage:x="No logs found"}){let h=!!(o||c)&&!!d,g=(0,r.N4)({data:e,columns:t,...h&&{getRowCanExpand:d},getRowId:(e,t)=>e?.request_id??String(t),getCoreRowModel:(0,n.HT)(),...h&&{getExpandedRowModel:(0,n.D0)()}});return(0,l.jsx)("div",{className:"rounded-lg custom-border overflow-x-auto w-full max-w-full box-border",children:(0,l.jsxs)(i.XI,{className:"[&_td]:py-0.5 [&_th]:py-1 table-fixed w-full box-border",style:{minWidth:"400px"},children:[(0,l.jsx)(i.nd,{children:g.getHeaderGroups().map(e=>(0,l.jsx)(i.Hj,{children:e.headers.map(e=>(0,l.jsx)(i.M_,{className:"py-1 h-8",children:e.isPlaceholder?null:(0,r.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,l.jsx)(i.BF,{children:m?(0,l.jsx)(i.Hj,{children:(0,l.jsx)(i.nA,{colSpan:t.length,className:"h-8 text-center",children:(0,l.jsx)("div",{className:"text-center text-gray-500",children:(0,l.jsx)("p",{children:u})})})}):g.getRowModel().rows.length>0?g.getRowModel().rows.map(e=>(0,l.jsxs)(s.Fragment,{children:[(0,l.jsx)(i.Hj,{className:`h-8 ${a?"cursor-pointer hover:bg-gray-50":""}`,onClick:()=>a?.(e.original),children:e.getVisibleCells().map(e=>(0,l.jsx)(i.nA,{className:"py-0.5 max-h-8 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,r.Kv)(e.column.columnDef.cell,e.getContext())},e.id))}),h&&e.getIsExpanded()&&c&&c({row:e}),h&&e.getIsExpanded()&&o&&!c&&(0,l.jsx)(i.Hj,{children:(0,l.jsx)(i.nA,{colSpan:e.getVisibleCells().length,className:"p-0",children:(0,l.jsx)("div",{className:"w-full max-w-full overflow-hidden box-border",children:o({row:e})})})})]},e.id)):(0,l.jsx)(i.Hj,{children:(0,l.jsx)(i.nA,{colSpan:t.length,className:"h-8 text-center",children:(0,l.jsx)("div",{className:"text-center text-gray-500",children:(0,l.jsx)("p",{children:x})})})})})]})})}},55445:(e,t,a)=>{"use strict";a.d(t,{A:()=>b});var l=a(95155),s=a(42696),r=a(14992),n=a(17293),i=a(85263),o=a(38983),c=a(22277),d=a(3840),m=a(12115),u=a(14290),x=a(88534),h=a(28436),g=a(98086),p=a(53672);let b=({topKeys:e,teams:t,showTags:a=!1,topKeysLimit:b,setTopKeysLimit:f})=>{let{accessToken:v,userRole:y,userId:j,premiumUser:w}=(0,s.A)(),{t:N}=(0,u.o)(),[k,_]=(0,m.useState)(!1),[A,S]=(0,m.useState)(null),[C,E]=(0,m.useState)(void 0),[V,H]=(0,m.useState)("table"),[$,M]=(0,m.useState)(new Set),I=async e=>{if(v)try{let t=await (0,h.keyInfoV1Call)(v,e.api_key),a=(e=>{let{key:t,info:a}=e;return{token:t,...a}})(t);E(a),S(e.api_key),_(!0)}catch(e){console.error("Error fetching key info:",e)}},K=()=>{_(!1),S(null),E(void 0)};m.useEffect(()=>{let e=e=>{"Escape"===e.key&&k&&K()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[k]);let T=[{header:N("usagePage.topKeyView.keyId"),accessorKey:"api_key",cell:e=>(0,l.jsx)("div",{className:"overflow-hidden",children:(0,l.jsx)(c.A,{title:e.getValue(),children:(0,l.jsx)(o.A,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>I(e.row.original),children:e.getValue()?`${e.getValue().slice(0,7)}...`:"-"})})})},{header:N("usagePage.topKeyView.keyAlias"),accessorKey:"key_alias",cell:e=>e.getValue()||"-"}],L={header:N("usagePage.topKeyView.tags"),accessorKey:"tags",cell:e=>{let t=e.getValue(),a=e.row.original.api_key,s=$.has(a);if(!t||0===t.length)return"-";let i=t.sort((e,t)=>t.usage-e.usage),o=s?i:i.slice(0,2),d=t.length>2;return(0,l.jsx)("div",{className:"overflow-hidden",children:(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-1",children:[o.map((e,t)=>(0,l.jsx)(c.A,{title:(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-gray-300",children:"Tag Name:"})," ",e.tag]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-gray-300",children:"Spend:"})," ",e.usage>0&&e.usage<.01?"<\xa50.01":`\xa5${(0,x.HY)(e.usage,2)}`]})]}),children:(0,l.jsxs)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:[e.tag.slice(0,7),"..."]})},t)),d&&(0,l.jsx)("button",{onClick:()=>{M(e=>{let t=new Set(e);return t.has(a)?t.delete(a):t.add(a),t})},className:"ml-1 p-1 hover:bg-gray-200 rounded-full transition-colors",title:s?N("usagePage.topKeyView.showFewerTags"):N("usagePage.topKeyView.showAllTags"),children:s?(0,l.jsx)(r.A,{className:"h-3 w-3 text-gray-500"}):(0,l.jsx)(n.A,{className:"h-3 w-3 text-gray-500"})})]})})}},D={header:N("usagePage.topKeyView.spend"),accessorKey:"spend",cell:e=>{let t=e.getValue();return t>0&&t<.01?"<\xa50.01":`\xa5${(0,x.HY)(t,2)}`}},R=a?[...T,L,D]:[...T,D],z=e.map(e=>({...e,display_key_alias:e.key_alias&&e.key_alias.length>10?`${e.key_alias.slice(0,10)}...`:e.key_alias||"-"}));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,l.jsx)(d.A,{options:[{label:"5",value:5},{label:"10",value:10},{label:"25",value:25},{label:"50",value:50}],value:b,onChange:e=>f(e)}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("button",{onClick:()=>H("table"),className:`px-3 py-1 text-sm rounded-md ${"table"===V?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:N("usagePage.topKeyView.tableView")}),(0,l.jsx)("button",{onClick:()=>H("chart"),className:`px-3 py-1 text-sm rounded-md ${"chart"===V?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:N("图表视图")})]})]}),"chart"===V?(0,l.jsx)("div",{className:"relative max-h-[600px] overflow-y-auto",children:(0,l.jsx)(i.A,{className:"mt-4 cursor-pointer hover:opacity-90",style:{height:52*Math.min(z.length,b)},data:z,index:"display_key_alias",categories:["spend"],colors:["cyan"],yAxisWidth:120,tickGap:5,layout:"vertical",showLegend:!1,valueFormatter:e=>`\xa5${(0,x.HY)(e)}`,onValueChange:e=>I(e),showTooltip:!0,customTooltip:e=>{let t=e.payload?.[0]?.payload;return(0,l.jsx)("div",{className:"relative z-50 p-3 bg-black/90 shadow-lg rounded-lg text-white max-w-xs",children:(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("span",{className:"text-gray-300",children:"Key Alias: "}),(0,l.jsx)("span",{className:"font-mono text-gray-100 break-all",children:t?.key_alias})]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("span",{className:"text-gray-300",children:"Key ID: "}),(0,l.jsx)("span",{className:"font-mono text-gray-100 break-all",children:t?.api_key})]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("span",{className:"text-gray-300",children:"Spend: "}),(0,l.jsxs)("span",{className:"text-white font-medium",children:["$",(0,x.HY)(t?.spend,2)]})]})]})})}})}):(0,l.jsx)("div",{className:"border rounded-lg overflow-hidden max-h-[600px] overflow-y-auto",children:(0,l.jsx)(p.b,{columns:R,data:e,renderSubComponent:()=>(0,l.jsx)(l.Fragment,{}),getRowCanExpand:()=>!1,isLoading:!1})}),k&&A&&C&&(console.log("Rendering modal with:",{isModalOpen:k,selectedKey:A,keyData:C}),(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&K()},children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-xl relative w-11/12 max-w-6xl max-h-[90vh] overflow-y-auto min-h-[750px]",children:[(0,l.jsx)("button",{onClick:K,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 focus:outline-none","aria-label":"Close",children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,l.jsx)("div",{className:"p-6 h-full",children:(0,l.jsx)(g.A,{keyId:A,onClose:K,keyData:C,teams:t})})]})}))]})}},59949:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var l=a(95155),s=a(72552),r=a(42696),n=a(12115);let i=()=>{let{accessToken:e,token:t,userRole:a,userId:i,premiumUser:o}=(0,r.A)(),[c,d]=(0,n.useState)([]);return(0,l.jsx)(s.A,{accessToken:e,token:t,userRole:a,userID:i,keys:c,premiumUser:o})}},76867:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var l=a(95155),s=a(12115),r=a(16264),n=a(75892);let i=({value:e,onValueChange:t,label:a="Select Time Range",className:i="",showTimeRange:o=!0})=>{let[c,d]=(0,s.useState)(!1),m=(0,s.useRef)(null),u=(0,s.useCallback)(e=>{d(!0),setTimeout(()=>d(!1),1500),t(e),requestIdleCallback(()=>{if(e.from){let a,l={...e},s=new Date(e.from);a=new Date(e.to?e.to:e.from),s.toDateString(),a.toDateString(),s.setHours(0,0,0,0),a.setHours(23,59,59,999),l.from=s,l.to=a,t(l)}},{timeout:100})},[t]),x=(0,s.useCallback)((e,t)=>{if(!e||!t)return"";let a=e=>e.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0,timeZoneName:"short"});if(e.toDateString()!==t.toDateString())return`${a(e)} - ${a(t)}`;{let a=e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),l=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),s=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZoneName:"short"});return`${a}: ${l} - ${s}`}},[]);return(0,l.jsxs)("div",{className:i,children:[a&&(0,l.jsx)(n.A,{className:"mb-2",children:a}),(0,l.jsxs)("div",{className:"relative w-fit",children:[(0,l.jsx)("div",{ref:m,children:(0,l.jsx)(r.A,{enableSelect:!0,value:e,onValueChange:u,placeholder:"Select date range",enableClear:!1,style:{zIndex:100}})}),c&&(0,l.jsx)("div",{className:"absolute top-1/2 animate-pulse",style:{left:"calc(100% + 8px)",transform:"translateY(-50%)",zIndex:110},children:(0,l.jsxs)("div",{className:"flex items-center gap-1 text-green-600 text-sm font-medium bg-white px-2 py-1 rounded-full border border-green-200 shadow-sm whitespace-nowrap",children:[(0,l.jsx)("div",{className:"w-3 h-3 bg-green-500 text-white rounded-full flex items-center justify-center text-xs",children:"✓"}),(0,l.jsx)("span",{className:"text-xs",children:"Selected"})]})})]}),o&&e.from&&e.to&&(0,l.jsx)(n.A,{className:"mt-2 text-xs text-gray-500",children:x(e.from,e.to)})]})}}},e=>{e.O(0,[1772,3725,5884,1145,1909,1326,8536,8267,3146,9904,1291,5049,9791,2360,1242,941,54,3138,6769,5895,139,2823,4245,6200,8347,4557,4132,4474,3416,4394,3847,4320,3303,8931,8086,2552,8441,3794,7358],()=>e(e.s=6018)),_N_E=e.O()}]);