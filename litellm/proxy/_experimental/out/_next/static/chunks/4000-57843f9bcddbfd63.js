"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4e3],{4e3:(e,t,s)=>{s.d(t,{A:()=>Z});var a=s(95155),r=s(85263),l=s(42837),n=s(27309),i=s(13121),c=s(19602),o=s(62591),d=s(7188),m=s(39210),h=s(2212),x=s(87927),u=s(56680),p=s(73806),f=s(79363),g=s(75892),_=s(12115),y=s(12120),j=s(76867),N=s(73317),v=s(28436),b=s(38983),S=s(57425),A=s(92982),w=s(91314);let k=({responseTimeMs:e})=>null==e?null:(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-gray-500 font-mono",children:[(0,a.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M12 6V12L16 14M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,a.jsxs)("span",{children:[e.toFixed(0),"ms"]})]}),C=e=>{let t=e;if("string"==typeof t)try{t=JSON.parse(t)}catch{}return t},T=({label:e,value:t})=>{let[s,r]=_.useState(!1),[l,n]=_.useState(!1),i=t?.toString()||"N/A",c=i.length>50?i.substring(0,50)+"...":i;return(0,a.jsx)("tr",{className:"hover:bg-gray-50",children:(0,a.jsx)("td",{className:"px-4 py-2 align-top",colSpan:2,children:(0,a.jsxs)("div",{className:"flex items-center justify-between group",children:[(0,a.jsxs)("div",{className:"flex items-center flex-1",children:[(0,a.jsx)("button",{onClick:()=>r(!s),className:"text-gray-400 hover:text-gray-600 mr-2",children:s?"▼":"▶"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:e}),(0,a.jsx)("pre",{className:"mt-1 text-sm font-mono text-gray-800 whitespace-pre-wrap",children:s?i:c})]})]}),(0,a.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(i),n(!0),setTimeout(()=>n(!1),2e3)},className:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(S.A,{className:"h-4 w-4"})})]})})})},D=({response:e})=>{let t=null,s={},r={};try{if(e?.error)try{let a="string"==typeof e.error.message?JSON.parse(e.error.message):e.error.message;t={message:a?.message||"Unknown error",traceback:a?.traceback||"No traceback available",litellm_params:a?.litellm_cache_params||{},health_check_cache_params:a?.health_check_cache_params||{}},s=C(t.litellm_params)||{},r=C(t.health_check_cache_params)||{}}catch(s){console.warn("Error parsing error details:",s),t={message:String(e.error.message||"Unknown error"),traceback:"Error parsing details",litellm_params:{},health_check_cache_params:{}}}else s=C(e?.litellm_cache_params)||{},r=C(e?.health_check_cache_params)||{}}catch(e){console.warn("Error in response parsing:",e),s={},r={}}let l={redis_host:r?.redis_client?.connection_pool?.connection_kwargs?.host||r?.redis_async_client?.connection_pool?.connection_kwargs?.host||r?.connection_kwargs?.host||r?.host||"N/A",redis_port:r?.redis_client?.connection_pool?.connection_kwargs?.port||r?.redis_async_client?.connection_pool?.connection_kwargs?.port||r?.connection_kwargs?.port||r?.port||"N/A",redis_version:r?.redis_version||"N/A",startup_nodes:(()=>{try{if(r?.redis_kwargs?.startup_nodes)return JSON.stringify(r.redis_kwargs.startup_nodes);let e=r?.redis_client?.connection_pool?.connection_kwargs?.host||r?.redis_async_client?.connection_pool?.connection_kwargs?.host,t=r?.redis_client?.connection_pool?.connection_kwargs?.port||r?.redis_async_client?.connection_pool?.connection_kwargs?.port;return e&&t?JSON.stringify([{host:e,port:t}]):"N/A"}catch(e){return"N/A"}})(),namespace:r?.namespace||"N/A"};return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,a.jsxs)(x.A,{children:[(0,a.jsxs)(u.A,{className:"border-b border-gray-200 px-4",children:[(0,a.jsx)(h.A,{className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800",children:"Summary"}),(0,a.jsx)(h.A,{className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800",children:"Raw Response"})]}),(0,a.jsxs)(f.A,{children:[(0,a.jsx)(p.A,{className:"p-4",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[e?.status==="healthy"?(0,a.jsx)(A.A,{className:"h-5 w-5 text-green-500 mr-2"}):(0,a.jsx)(w.A,{className:"h-5 w-5 text-red-500 mr-2"}),(0,a.jsxs)(g.A,{className:`text-sm font-medium ${e?.status==="healthy"?"text-green-500":"text-red-500"}`,children:["Cache Status: ",e?.status||"unhealthy"]})]}),(0,a.jsx)("table",{className:"w-full border-collapse",children:(0,a.jsxs)("tbody",{children:[t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:2,className:"pt-4 pb-2 font-semibold text-red-600",children:"Error Details"})}),(0,a.jsx)(T,{label:"Error Message",value:t.message}),(0,a.jsx)(T,{label:"Traceback",value:t.traceback})]}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:2,className:"pt-4 pb-2 font-semibold",children:"Cache Details"})}),(0,a.jsx)(T,{label:"Cache Configuration",value:String(s?.type)}),(0,a.jsx)(T,{label:"Ping Response",value:String(e.ping_response)}),(0,a.jsx)(T,{label:"Set Cache Response",value:e.set_cache_response||"N/A"}),(0,a.jsx)(T,{label:"litellm_settings.cache_params",value:JSON.stringify(s,null,2)}),s?.type==="redis"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:2,className:"pt-4 pb-2 font-semibold",children:"Redis Details"})}),(0,a.jsx)(T,{label:"Redis Host",value:l.redis_host||"N/A"}),(0,a.jsx)(T,{label:"Redis Port",value:l.redis_port||"N/A"}),(0,a.jsx)(T,{label:"Redis Version",value:l.redis_version||"N/A"}),(0,a.jsx)(T,{label:"Startup Nodes",value:l.startup_nodes||"N/A"}),(0,a.jsx)(T,{label:"Namespace",value:l.namespace||"N/A"})]})]})})]})}),(0,a.jsx)(p.A,{className:"p-4",children:(0,a.jsx)("div",{className:"bg-gray-50 rounded-md p-4 font-mono text-sm",children:(0,a.jsx)("pre",{className:"whitespace-pre-wrap break-words overflow-auto max-h-[500px]",children:(()=>{try{let t={...e,litellm_cache_params:s,health_check_cache_params:r},a=JSON.parse(JSON.stringify(t,(e,t)=>{if("string"==typeof t)try{return JSON.parse(t)}catch{}return t}));return JSON.stringify(a,null,2)}catch(e){return"Error formatting JSON: "+e.message}})()})})})]})]})})},R=({accessToken:e,healthCheckResponse:t,runCachingHealthCheck:s,responseTimeMs:r})=>{let[l,n]=_.useState(null),[i,c]=_.useState(!1),o=async()=>{c(!0);let e=performance.now();await s(),n(performance.now()-e),c(!1)};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(b.A,{onClick:o,disabled:i,className:"bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white text-sm px-4 py-2 rounded-md",children:i?"Running Health Check...":"Run Health Check"}),(0,a.jsx)(k,{responseTimeMs:l})]}),t&&(0,a.jsx)(D,{response:t})]})};var E=s(95875),I=s(56691),L=s(20645),H=s(73626);let O=({redisType:e,redisTypeDescriptions:t,onTypeChange:s})=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Redis Type"}),(0,a.jsxs)(H.l,{value:e,onValueChange:s,children:[(0,a.jsx)(H.e,{value:"node",children:"Node (Single Instance)"}),(0,a.jsx)(H.e,{value:"cluster",children:"Cluster"}),(0,a.jsx)(H.e,{value:"sentinel",children:"Sentinel"}),(0,a.jsx)(H.e,{value:"semantic",children:"Semantic"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:t[e]||"Select the type of Redis deployment you're using"})]});var F=s(42696),V=s(60124),J=s(34487),B=s(23060),P=s(22603),$=s(66904);let q=({field:e,currentValue:t})=>{let[s,r]=(0,_.useState)([]),[l,n]=(0,_.useState)(t||""),{accessToken:i}=(0,F.A)();if((0,_.useEffect)(()=>{i&&(async()=>{try{let e=await (0,P.Q)(i);console.log("Fetched models for selector:",e),e.length>0&&r(e)}catch(e){console.error("Error fetching model info:",e)}})()},[i]),"Boolean"===e.field_type)return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:e.ui_field_name}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",name:e.field_name,defaultChecked:!0===t||"true"===t,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:e.field_description})]})]});if("Integer"===e.field_type||"Float"===e.field_type)return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:e.ui_field_name}),(0,a.jsx)($.A,{name:e.field_name,type:"number",defaultValue:t,placeholder:e.field_description}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.field_description})]});if("List"===e.field_type)return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:e.ui_field_name}),(0,a.jsx)("textarea",{name:e.field_name,defaultValue:"object"==typeof t?JSON.stringify(t,null,2):t,placeholder:e.field_description,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",rows:4}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.field_description})]});if("Models_Select"===e.field_type){let t=s.filter(e=>"embedding"===e.mode).map(e=>({value:e.model_group,label:e.model_group}));return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:e.ui_field_name}),(0,a.jsx)(B.A,{value:l,onChange:n,showSearch:!0,placeholder:"Search and select a model...",options:t,style:{width:"100%"},className:"rounded-md",filterOption:(e,t)=>(t?.label??"").toLowerCase().includes(e.toLowerCase())}),(0,a.jsx)("input",{type:"hidden",name:e.field_name,value:l}),e.field_description&&(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.field_description})]})}if("Integer"===e.field_type||"Float"===e.field_type)return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:e.ui_field_name}),(0,a.jsx)(V.A,{name:e.field_name,defaultValue:t,placeholder:e.field_description,step:"Float"===e.field_type?.01:1}),e.field_description&&(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.field_description})]});let c="password"===e.field_name||e.field_name.includes("password")?"password":"text";return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:e.ui_field_name}),(0,a.jsx)(J.A,{name:e.field_name,type:c,defaultValue:t,placeholder:e.field_description}),e.field_description&&(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.field_description})]})},M=(e,t)=>e.find(e=>e.field_name===t),U=(e,t)=>{let s={type:"redis"};return e.forEach(e=>{if("redis_type"===e.field_name||null!==e.redis_type&&void 0!==e.redis_type&&e.redis_type!==t)return;let a=e.field_name,r=null;if("Boolean"===e.field_type){let e=document.querySelector(`input[name="${a}"]`);e?.checked!==void 0&&(r=e.checked)}else if("List"===e.field_type){let e=document.querySelector(`textarea[name="${a}"]`);if(e?.value)try{r=JSON.parse(e.value)}catch(e){console.error(`Invalid JSON for ${a}:`,e)}}else{let t=document.querySelector(`input[name="${a}"]`);if(t?.value){let s=t.value.trim();if(""!==s)if("Integer"===e.field_type){let e=Number(s);isNaN(e)||(r=e)}else if("Float"===e.field_type){let e=Number(s);isNaN(e)||(r=e)}else r=s}}null!=r&&(s[a]=r)}),s},G=({accessToken:e,userRole:t,userID:s})=>{let r,l,n,i,c,[o,d]=(0,_.useState)({}),[m,h]=(0,_.useState)([]),[x,u]=(0,_.useState)({}),[p,f]=(0,_.useState)("node"),[g,j]=(0,_.useState)(!1),[N,S]=(0,_.useState)(!1),A=(0,_.useCallback)(async()=>{try{let t=await (0,v.getCacheSettingsCall)(e);console.log("cache settings from API",t),t.fields&&h(t.fields),t.current_values&&(d(t.current_values),t.current_values.redis_type&&f(t.current_values.redis_type)),t.redis_type_descriptions&&u(t.redis_type_descriptions)}catch(e){console.error("Failed to load cache settings:",e),y.Ay.fromBackend("Failed to load cache settings")}},[e]);(0,_.useEffect)(()=>{e&&A()},[e,A]);let w=async()=>{if(e){j(!0);try{let t=U(m,p),s=await (0,v.testCacheConnectionCall)(e,t);"success"===s.status?y.Ay.success("Cache connection test successful!"):y.Ay.fromBackend(`Connection test failed: ${s.message||s.error}`)}catch(e){console.error("Test connection error:",e),y.Ay.fromBackend(`Connection test failed: ${e.message||"Unknown error"}`)}finally{j(!1)}}},k=async()=>{if(e){S(!0);try{let t=U(m,p);"semantic"===p&&(t.type="redis-semantic"),await (0,v.updateCacheSettingsCall)(e,t),y.Ay.success("Cache settings updated successfully"),await A()}catch(e){console.error("Failed to save cache settings:",e),y.Ay.fromBackend("Failed to update cache settings")}finally{S(!1)}}};if(!e)return null;let{basicFields:C,sslFields:T,cacheManagementFields:D,gcpFields:R,clusterFields:H,sentinelFields:F,semanticFields:V}=(r=["host","port","password","username"].map(e=>M(m,e)).filter(Boolean),l=["ssl","ssl_cert_reqs","ssl_check_hostname"].map(e=>M(m,e)).filter(Boolean),n=["namespace","ttl","max_connections"].map(e=>M(m,e)).filter(Boolean),i=["gcp_service_account","gcp_ssl_ca_certs"].map(e=>M(m,e)).filter(Boolean),c=m.filter(e=>"cluster"===e.redis_type),{basicFields:r,sslFields:l,cacheManagementFields:n,gcpFields:i,clusterFields:c,sentinelFields:m.filter(e=>"sentinel"===e.redis_type),semanticFields:m.filter(e=>"semantic"===e.redis_type)});return(0,a.jsxs)("div",{className:"w-full space-y-8 py-2",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"max-w-3xl",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Cache Settings"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Configure Redis cache for Silinex"})]}),(0,a.jsx)(O,{redisType:p,redisTypeDescriptions:x,onTypeChange:f}),(0,a.jsxs)("div",{className:"space-y-6 pt-4 border-t border-gray-200",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"Connection Settings"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:C.map(e=>{if(!e)return null;let t=o[e.field_name]??e.field_default??"";return(0,a.jsx)(q,{field:e,currentValue:t},e.field_name)})})]}),"cluster"===p&&H.length>0&&(0,a.jsxs)("div",{className:"space-y-6 pt-4 border-t border-gray-200",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"Cluster Configuration"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6",children:H.map(e=>{let t=o[e.field_name]??e.field_default??"";return(0,a.jsx)(q,{field:e,currentValue:t},e.field_name)})})]}),"sentinel"===p&&F.length>0&&(0,a.jsxs)("div",{className:"space-y-6 pt-4 border-t border-gray-200",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"Sentinel Configuration"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:F.map(e=>{let t=o[e.field_name]??e.field_default??"";return(0,a.jsx)(q,{field:e,currentValue:t},e.field_name)})})]}),"semantic"===p&&V.length>0&&(0,a.jsxs)("div",{className:"space-y-6 pt-4 border-t border-gray-200",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"Semantic Configuration"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:V.map(e=>{let t=o[e.field_name]??e.field_default??"";return(0,a.jsx)(q,{field:e,currentValue:t},e.field_name)})})]}),(0,a.jsxs)(E.h,{className:"mt-4",children:[(0,a.jsx)(L.A,{children:(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Advanced Settings"})}),(0,a.jsx)(I.A,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[T.length>0&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-gray-700",children:"SSL Settings"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:T.map(e=>{if(!e)return null;let t=o[e.field_name]??e.field_default??"";return(0,a.jsx)(q,{field:e,currentValue:t},e.field_name)})})]}),D.length>0&&(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-gray-700",children:"Cache Management"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:D.map(e=>{if(!e)return null;let t=o[e.field_name]??e.field_default??"";return(0,a.jsx)(q,{field:e,currentValue:t},e.field_name)})})]}),R.length>0&&(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-gray-700",children:"GCP Authentication"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:R.map(e=>{if(!e)return null;let t=o[e.field_name]??e.field_default??"";return(0,a.jsx)(q,{field:e,currentValue:t},e.field_name)})})]})]})})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-6 flex justify-end gap-3",children:[(0,a.jsx)(b.A,{variant:"secondary",size:"sm",onClick:w,disabled:g,className:"text-sm",children:g?"Testing...":"Test Connection"}),(0,a.jsx)(b.A,{size:"sm",onClick:k,disabled:N,className:"text-sm font-medium",children:N?"Saving...":"Save Changes"})]})]})},z=e=>{if(e)return e.toISOString().split("T")[0]};function W(e){return new Intl.NumberFormat("en-US",{maximumFractionDigits:0,notation:"compact",compactDisplay:"short"}).format(e)}let Z=({accessToken:e,token:t,userRole:s,userID:b,premiumUser:S})=>{let[A,w]=(0,_.useState)([]),[k,C]=(0,_.useState)([]),[T,D]=(0,_.useState)([]),[E,I]=(0,_.useState)([]),[L,H]=(0,_.useState)("0"),[O,F]=(0,_.useState)("0"),[V,J]=(0,_.useState)("0"),[B,P]=(0,_.useState)({from:new Date(Date.now()-6048e5),to:new Date}),[$,q]=(0,_.useState)(""),[M,U]=(0,_.useState)("");(0,_.useEffect)(()=>{e&&B&&((async()=>{I(await (0,v.adminGlobalCacheActivity)(e,z(B.from),z(B.to)))})(),q(new Date().toLocaleString()))},[e]);let Z=Array.from(new Set(E.map(e=>e?.api_key??""))),K=Array.from(new Set(E.map(e=>e?.model??"")));Array.from(new Set(E.map(e=>e?.call_type??"")));let Q=async(t,s)=>{t&&s&&e&&I(await (0,v.adminGlobalCacheActivity)(e,z(t),z(s)))};(0,_.useEffect)(()=>{console.log("DATA IN CACHE DASHBOARD",E);let e=E;k.length>0&&(e=e.filter(e=>k.includes(e.api_key))),T.length>0&&(e=e.filter(e=>T.includes(e.model))),console.log("before processed data in cache dashboard",e);let t=0,s=0,a=0,r=e.reduce((e,r)=>{console.log("Processing item:",r),r.call_type||(console.log("Item has no call_type:",r),r.call_type="Unknown"),t+=(r.total_rows||0)-(r.cache_hit_true_rows||0),s+=r.cache_hit_true_rows||0,a+=r.cached_completion_tokens||0;let l=e.find(e=>e.name===r.call_type);return l?(l["LLM API requests"]+=(r.total_rows||0)-(r.cache_hit_true_rows||0),l["Cache hit"]+=r.cache_hit_true_rows||0,l["Cached Completion Tokens"]+=r.cached_completion_tokens||0,l["Generated Completion Tokens"]+=r.generated_completion_tokens||0):e.push({name:r.call_type,"LLM API requests":(r.total_rows||0)-(r.cache_hit_true_rows||0),"Cache hit":r.cache_hit_true_rows||0,"Cached Completion Tokens":r.cached_completion_tokens||0,"Generated Completion Tokens":r.generated_completion_tokens||0}),e},[]);H(W(s)),F(W(a));let l=s+t;l>0?J((s/l*100).toFixed(2)):J("0"),w(r),console.log("PROCESSED DATA IN CACHE DASHBOARD",r)},[k,T,B,E]);let Y=async()=>{try{y.Ay.info("Running cache health check..."),U("");let t=await (0,v.cachingHealthCheckCall)(null!==e?e:"");console.log("CACHING HEALTH CHECK RESPONSE",t),U(t)}catch(t){let e;if(console.error("Error running health check:",t),t&&t.message)try{let s=JSON.parse(t.message);s.error&&(s=s.error),e=s}catch(s){e={message:t.message}}else e={message:"Unknown error occurred"};U({error:e})}};return(0,a.jsxs)(x.A,{className:"gap-2 p-8 h-full w-full mt-2 mb-8",children:[(0,a.jsxs)(u.A,{className:"flex justify-between mt-2 w-full items-center",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(h.A,{children:"Cache Analytics"}),(0,a.jsx)(h.A,{children:"Cache Health"}),(0,a.jsx)(h.A,{children:"Cache Settings"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[$&&(0,a.jsxs)(g.A,{children:["Last Refreshed: ",$]}),(0,a.jsx)(c.A,{icon:N.A,variant:"shadow",size:"xs",className:"self-center",onClick:()=>{q(new Date().toLocaleString())}})]})]}),(0,a.jsxs)(f.A,{children:[(0,a.jsx)(p.A,{children:(0,a.jsxs)(l.A,{children:[(0,a.jsxs)(i.A,{numItems:3,className:"gap-4 mt-4",children:[(0,a.jsx)(n.A,{children:(0,a.jsx)(o.A,{placeholder:"Select Virtual Keys",value:k,onValueChange:C,children:Z.map(e=>(0,a.jsx)(d.A,{value:e,children:e},e))})}),(0,a.jsx)(n.A,{children:(0,a.jsx)(o.A,{placeholder:"Select Models",value:T,onValueChange:D,children:K.map(e=>(0,a.jsx)(d.A,{value:e,children:e},e))})}),(0,a.jsx)(n.A,{children:(0,a.jsx)(j.A,{value:B,onValueChange:e=>{P(e),Q(e.from,e.to)}})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 mt-4",children:[(0,a.jsxs)(l.A,{children:[(0,a.jsx)("p",{className:"text-tremor-default font-medium text-tremor-content dark:text-dark-tremor-content",children:"Cache Hit Ratio"}),(0,a.jsx)("div",{className:"mt-2 flex items-baseline space-x-2.5",children:(0,a.jsxs)("p",{className:"text-tremor-metric font-semibold text-tremor-content-strong dark:text-dark-tremor-content-strong",children:[V,"%"]})})]}),(0,a.jsxs)(l.A,{children:[(0,a.jsx)("p",{className:"text-tremor-default font-medium text-tremor-content dark:text-dark-tremor-content",children:"Cache Hits"}),(0,a.jsx)("div",{className:"mt-2 flex items-baseline space-x-2.5",children:(0,a.jsx)("p",{className:"text-tremor-metric font-semibold text-tremor-content-strong dark:text-dark-tremor-content-strong",children:L})})]}),(0,a.jsxs)(l.A,{children:[(0,a.jsx)("p",{className:"text-tremor-default font-medium text-tremor-content dark:text-dark-tremor-content",children:"Cached Tokens"}),(0,a.jsx)("div",{className:"mt-2 flex items-baseline space-x-2.5",children:(0,a.jsx)("p",{className:"text-tremor-metric font-semibold text-tremor-content-strong dark:text-dark-tremor-content-strong",children:O})})]})]}),(0,a.jsx)(m.A,{className:"mt-4",children:"Cache Hits vs API Requests"}),(0,a.jsx)(r.A,{title:"Cache Hits vs API Requests",data:A,stack:!0,index:"name",valueFormatter:W,categories:["LLM API requests","Cache hit"],colors:["sky","teal"],yAxisWidth:48}),(0,a.jsx)(m.A,{className:"mt-4",children:"Cached Completion Tokens vs Generated Completion Tokens"}),(0,a.jsx)(r.A,{className:"mt-6",data:A,stack:!0,index:"name",valueFormatter:W,categories:["Generated Completion Tokens","Cached Completion Tokens"],colors:["sky","teal"],yAxisWidth:48})]})}),(0,a.jsx)(p.A,{children:(0,a.jsx)(R,{accessToken:e,healthCheckResponse:M,runCachingHealthCheck:Y})}),(0,a.jsx)(p.A,{children:(0,a.jsx)(G,{accessToken:e,userRole:s,userID:b})})]})]})}},76867:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(95155),r=s(12115),l=s(16264),n=s(75892);let i=({value:e,onValueChange:t,label:s="Select Time Range",className:i="",showTimeRange:c=!0})=>{let[o,d]=(0,r.useState)(!1),m=(0,r.useRef)(null),h=(0,r.useCallback)(e=>{d(!0),setTimeout(()=>d(!1),1500),t(e),requestIdleCallback(()=>{if(e.from){let s,a={...e},r=new Date(e.from);s=new Date(e.to?e.to:e.from),r.toDateString(),s.toDateString(),r.setHours(0,0,0,0),s.setHours(23,59,59,999),a.from=r,a.to=s,t(a)}},{timeout:100})},[t]),x=(0,r.useCallback)((e,t)=>{if(!e||!t)return"";let s=e=>e.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0,timeZoneName:"short"});if(e.toDateString()!==t.toDateString())return`${s(e)} - ${s(t)}`;{let s=e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),a=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),r=t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZoneName:"short"});return`${s}: ${a} - ${r}`}},[]);return(0,a.jsxs)("div",{className:i,children:[s&&(0,a.jsx)(n.A,{className:"mb-2",children:s}),(0,a.jsxs)("div",{className:"relative w-fit",children:[(0,a.jsx)("div",{ref:m,children:(0,a.jsx)(l.A,{enableSelect:!0,value:e,onValueChange:h,placeholder:"Select date range",enableClear:!1,style:{zIndex:100}})}),o&&(0,a.jsx)("div",{className:"absolute top-1/2 animate-pulse",style:{left:"calc(100% + 8px)",transform:"translateY(-50%)",zIndex:110},children:(0,a.jsxs)("div",{className:"flex items-center gap-1 text-green-600 text-sm font-medium bg-white px-2 py-1 rounded-full border border-green-200 shadow-sm whitespace-nowrap",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 text-white rounded-full flex items-center justify-center text-xs",children:"✓"}),(0,a.jsx)("span",{className:"text-xs",children:"Selected"})]})})]}),c&&e.from&&e.to&&(0,a.jsx)(n.A,{className:"mt-2 text-xs text-gray-500",children:x(e.from,e.to)})]})}}}]);