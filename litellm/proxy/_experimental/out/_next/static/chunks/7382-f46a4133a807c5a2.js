"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7382],{67382:(e,s,i)=>{i.d(s,{A:()=>eK});var l=i(95155),r=i(42696),t=i(38983),n=i(11568),a=i(42837),o=i(30489),c=i(96961),d=i(95517),u=i(8179),m=i(31556),_=i(95171),g=i(41326),p=i(25387),h=i(99876),x=i(3373),y=i(91808),j=i(87278),f=i(99904),A=i(12115),v=i(58737),S=i(12120),b=i(28436),I=i(54747),C=i(13121),w=i(75892),k=i(34487),N=i(64628),E=i(99312),O=i(10756),T=i(34537),P=i(63003),U=i(81283),R=i(24610),M=i(34425);let F=({accessToken:e,userID:s,proxySettings:i})=>{let[r]=p.A.useForm(),[o,c]=(0,A.useState)(!1),[d,u]=(0,A.useState)(null),[m,_]=(0,A.useState)("<your_proxy_base_url>");(0,A.useEffect)(()=>{let e="<your_proxy_base_url>";_(e=i&&i.PROXY_BASE_URL&&void 0!==i.PROXY_BASE_URL?i.PROXY_BASE_URL:window.location.origin)},[i]);let g=`${m}/scim/v2`,h=async i=>{if(!e||!s)return void S.Ay.fromBackend("You need to be logged in to create a SCIM token");try{c(!0);let l={key_alias:i.key_alias||"SCIM Access Token",team_id:null,models:[],allowed_routes:["/scim/*"]},r=await (0,b.keyCreateCall)(e,s,l);u(r),S.Ay.success("SCIM token created successfully")}catch(e){console.error("Error creating SCIM token:",e),S.Ay.fromBackend("Failed to create SCIM token: "+(0,M.x)(e))}finally{c(!1)}};return(0,l.jsx)(C.A,{numItems:1,children:(0,l.jsxs)(a.A,{children:[(0,l.jsx)("div",{className:"flex items-center mb-4",children:(0,l.jsx)(N.A,{children:"SCIM Configuration"})}),(0,l.jsx)(w.A,{className:"text-gray-600",children:"System for Cross-domain Identity Management (SCIM) allows you to automatically provision and manage users and groups in Silinex."}),(0,l.jsx)(I.A,{}),(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-700 mr-2",children:"1"}),(0,l.jsxs)(N.A,{className:"text-lg flex items-center",children:[(0,l.jsx)(O.A,{className:"h-5 w-5 mr-2"}),"SCIM Tenant URL"]})]}),(0,l.jsx)(w.A,{className:"text-gray-600 mb-3",children:"Use this URL in your identity provider SCIM integration settings."}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(k.A,{value:g,disabled:!0,className:"flex-grow"}),(0,l.jsx)(E.CopyToClipboard,{text:g,onCopy:()=>S.Ay.success("URL copied to clipboard"),children:(0,l.jsxs)(t.A,{variant:"primary",className:"ml-2 flex items-center",children:[(0,l.jsx)(T.A,{className:"h-4 w-4 mr-1"}),"Copy"]})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-700 mr-2",children:"2"}),(0,l.jsxs)(N.A,{className:"text-lg flex items-center",children:[(0,l.jsx)(P.A,{className:"h-5 w-5 mr-2"}),"Authentication Token"]})]}),(0,l.jsx)(n.A,{title:"Using SCIM",color:"blue",className:"mb-4",children:"You need a SCIM token to authenticate with the SCIM API. Create one below and use it in your SCIM provider configuration."}),d?(0,l.jsxs)(a.A,{className:"border border-yellow-300 bg-yellow-50",children:[(0,l.jsxs)("div",{className:"flex items-center mb-2 text-yellow-800",children:[(0,l.jsx)(U.A,{className:"h-5 w-5 mr-2"}),(0,l.jsx)(N.A,{className:"text-lg text-yellow-800",children:"Your SCIM Token"})]}),(0,l.jsx)(w.A,{className:"text-yellow-800 mb-4 font-medium",children:"Make sure to copy this token now. You will not be able to see it again."}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(k.A,{value:d.key,className:"flex-grow mr-2 bg-white",type:"password",disabled:!0}),(0,l.jsx)(E.CopyToClipboard,{text:d.key,onCopy:()=>S.Ay.success("Token copied to clipboard"),children:(0,l.jsxs)(t.A,{variant:"primary",className:"flex items-center",children:[(0,l.jsx)(T.A,{className:"h-4 w-4 mr-1"}),"Copy"]})})]}),(0,l.jsxs)(t.A,{className:"mt-4 flex items-center",variant:"secondary",onClick:()=>u(null),children:[(0,l.jsx)(R.A,{className:"h-4 w-4 mr-1"}),"Create Another Token"]})]}):(0,l.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,l.jsxs)(p.A,{form:r,onFinish:h,layout:"vertical",children:[(0,l.jsx)(p.A.Item,{name:"key_alias",label:"Token Name",rules:[{required:!0,message:"Please enter a name for your token"}],children:(0,l.jsx)(k.A,{placeholder:"SCIM Access Token"})}),(0,l.jsx)(p.A.Item,{children:(0,l.jsxs)(t.A,{variant:"primary",type:"submit",loading:o,className:"flex items-center",children:[(0,l.jsx)(P.A,{className:"h-4 w-4 mr-1"}),"Create SCIM Token"]})})]})})]})]})]})})};var z=i(26708),L=i(90078);let D=(0,L.D)("sso"),G=()=>{let{accessToken:e,userId:s,userRole:i}=(0,r.A)();return(0,z.I)({queryKey:D.detail("settings"),queryFn:async()=>await (0,b.getSSOSettings)(e),enabled:!!(e&&s&&i)})};var B=i(48849),V=i(30648),q=i(54481),W=i(69779),Y=i(439),$=i(89823),J=i(68459);let H={google:"https://artificialanalysis.ai/img/logos/google_small.svg",microsoft:"https://upload.wikimedia.org/wikipedia/commons/a/a8/Microsoft_Azure_Logo.svg",okta:"https://www.okta.com/sites/default/files/Okta_Logo_BrightBlue_Medium.png",generic:""},K={google:"Google SSO",microsoft:"Microsoft SSO",okta:"Okta / Auth0 SSO",generic:"Generic SSO"},X={internal_user_viewer:"Internal Viewer",internal_user:"Internal User",proxy_admin_viewer:"Proxy Admin Viewer",proxy_admin:"Proxy Admin"};var Z=i(73648),Q=i(23060),ee=i(61484);let es={google:{envVarMap:{google_client_id:"GOOGLE_CLIENT_ID",google_client_secret:"GOOGLE_CLIENT_SECRET"},fields:[{label:"Google Client ID",name:"google_client_id"},{label:"Google Client Secret",name:"google_client_secret"}]},microsoft:{envVarMap:{microsoft_client_id:"MICROSOFT_CLIENT_ID",microsoft_client_secret:"MICROSOFT_CLIENT_SECRET",microsoft_tenant:"MICROSOFT_TENANT"},fields:[{label:"Microsoft Client ID",name:"microsoft_client_id"},{label:"Microsoft Client Secret",name:"microsoft_client_secret"},{label:"Microsoft Tenant",name:"microsoft_tenant"}]},okta:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"Generic Client ID",name:"generic_client_id"},{label:"Generic Client Secret",name:"generic_client_secret"},{label:"Authorization Endpoint",name:"generic_authorization_endpoint",placeholder:"https://your-domain/authorize"},{label:"Token Endpoint",name:"generic_token_endpoint",placeholder:"https://your-domain/token"},{label:"Userinfo Endpoint",name:"generic_userinfo_endpoint",placeholder:"https://your-domain/userinfo"}]},generic:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"Generic Client ID",name:"generic_client_id"},{label:"Generic Client Secret",name:"generic_client_secret"},{label:"Authorization Endpoint",name:"generic_authorization_endpoint"},{label:"Token Endpoint",name:"generic_token_endpoint"},{label:"Userinfo Endpoint",name:"generic_userinfo_endpoint"}]}},ei=({form:e,onFormSubmit:s})=>(0,l.jsx)("div",{children:(0,l.jsxs)(p.A,{form:e,onFinish:s,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,l.jsx)(p.A.Item,{label:"SSO Provider",name:"sso_provider",rules:[{required:!0,message:"Please select an SSO provider"}],children:(0,l.jsx)(Q.A,{children:Object.entries(H).map(([e,s])=>(0,l.jsx)(Q.A.Option,{value:e,children:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 0"},children:[s&&(0,l.jsx)("img",{src:s,alt:e,style:{height:24,width:24,marginRight:12,objectFit:"contain"}}),(0,l.jsx)("span",{children:K[e]||e.charAt(0).toUpperCase()+e.slice(1)+" SSO"})]})},e))})}),(0,l.jsx)(p.A.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.sso_provider!==s.sso_provider,children:({getFieldValue:e})=>{let s,i=e("sso_provider");return i&&(s=es[i])?s.fields.map(e=>(0,l.jsx)(p.A.Item,{label:e.label,name:e.name,rules:[{required:!0,message:`Please enter the ${e.label.toLowerCase()}`}],children:e.name.includes("client")?(0,l.jsx)(y.A.Password,{}):(0,l.jsx)(Z.k,{placeholder:e.placeholder})},e.name)):null}}),(0,l.jsx)(p.A.Item,{label:"Proxy Admin Email",name:"user_email",rules:[{required:!0,message:"Please enter the email of the proxy admin"}],children:(0,l.jsx)(Z.k,{})}),(0,l.jsx)(p.A.Item,{label:"Proxy Base URL",name:"proxy_base_url",normalize:e=>e?.trim(),rules:[{required:!0,message:"Please enter the proxy base url"},{pattern:/^https?:\/\/.+/,message:"URL must start with http:// or https://"},{validator:(e,s)=>s&&/^https?:\/\/.+/.test(s)&&s.endsWith("/")?Promise.reject("URL must not end with a trailing slash"):Promise.resolve()}],children:(0,l.jsx)(Z.k,{placeholder:"https://example.com"})}),(0,l.jsx)(p.A.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.sso_provider!==s.sso_provider,children:({getFieldValue:e})=>{let s=e("sso_provider");return"okta"===s||"generic"===s?(0,l.jsx)(p.A.Item,{label:"Use Role Mappings",name:"use_role_mappings",valuePropName:"checked",children:(0,l.jsx)(ee.A,{})}):null}}),(0,l.jsx)(p.A.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.use_role_mappings!==s.use_role_mappings||e.sso_provider!==s.sso_provider,children:({getFieldValue:e})=>{let s=e("use_role_mappings"),i=e("sso_provider");return s&&("okta"===i||"generic"===i)?(0,l.jsx)(p.A.Item,{label:"Group Claim",name:"group_claim",rules:[{required:!0,message:"Please enter the group claim"}],children:(0,l.jsx)(Z.k,{})}):null}}),(0,l.jsx)(p.A.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.use_role_mappings!==s.use_role_mappings||e.sso_provider!==s.sso_provider,children:({getFieldValue:e})=>{let s=e("use_role_mappings"),i=e("sso_provider");return s&&("okta"===i||"generic"===i)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.A.Item,{label:"Default Role",name:"default_role",initialValue:"Internal User",children:(0,l.jsxs)(Q.A,{children:[(0,l.jsx)(Q.A.Option,{value:"internal_user_viewer",children:"Internal Viewer"}),(0,l.jsx)(Q.A.Option,{value:"internal_user",children:"Internal User"}),(0,l.jsx)(Q.A.Option,{value:"proxy_admin_viewer",children:"Admin Viewer"}),(0,l.jsx)(Q.A.Option,{value:"proxy_admin",children:"Proxy Admin"})]})}),(0,l.jsx)(p.A.Item,{label:"Proxy Admin Teams",name:"proxy_admin_teams",children:(0,l.jsx)(Z.k,{})}),(0,l.jsx)(p.A.Item,{label:"Admin Viewer Teams",name:"admin_viewer_teams",children:(0,l.jsx)(Z.k,{})}),(0,l.jsx)(p.A.Item,{label:"Internal User Teams",name:"internal_user_teams",children:(0,l.jsx)(Z.k,{})}),(0,l.jsx)(p.A.Item,{label:"Internal Viewer Teams",name:"internal_viewer_teams",children:(0,l.jsx)(Z.k,{})})]}):null}}),(0,l.jsx)(p.A.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.sso_provider!==s.sso_provider,children:({getFieldValue:e})=>{let s=e("sso_provider");return"okta"===s||"generic"===s?(0,l.jsx)(p.A.Item,{label:"Use Team Mappings",name:"use_team_mappings",valuePropName:"checked",children:(0,l.jsx)(ee.A,{})}):null}}),(0,l.jsx)(p.A.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.use_team_mappings!==s.use_team_mappings||e.sso_provider!==s.sso_provider,children:({getFieldValue:e})=>{let s=e("use_team_mappings"),i=e("sso_provider");return s&&("okta"===i||"generic"===i)?(0,l.jsx)(p.A.Item,{label:"Team IDs JWT Field",name:"team_ids_jwt_field",rules:[{required:!0,message:"Please enter the team IDs JWT field"}],children:(0,l.jsx)(Z.k,{})}):null}})]})});var el=i(48934);let er=()=>{let{accessToken:e}=(0,r.A)();return(0,el.n)({mutationFn:async s=>{if(!e)throw Error("Access token is required");return await (0,b.updateSSOSettings)(e,s)}})},et=e=>{let{proxy_admin_teams:s,admin_viewer_teams:i,internal_user_teams:l,internal_viewer_teams:r,default_role:t,group_claim:n,use_role_mappings:a,use_team_mappings:o,team_ids_jwt_field:c,...d}=e,u={...d},m=d.sso_provider;if(a&&("okta"===m||"generic"===m)){let e=e=>e&&""!==e.trim()?e.split(",").map(e=>e.trim()).filter(e=>e.length>0):[];u.role_mappings={provider:"generic",group_claim:n,default_role:({internal_user_viewer:"internal_user_viewer",internal_user:"internal_user",proxy_admin_viewer:"proxy_admin_viewer",proxy_admin:"proxy_admin"})[t]||"internal_user",roles:{proxy_admin:e(s),proxy_admin_viewer:e(i),internal_user:e(l),internal_user_viewer:e(r)}}}return o&&("okta"===m||"generic"===m)&&(u.team_mappings={team_ids_jwt_field:c}),u},en=e=>e.google_client_id?"google":e.microsoft_client_id?"microsoft":e.generic_client_id?e.generic_authorization_endpoint?.includes("okta")||e.generic_authorization_endpoint?.includes("auth0")?"okta":"generic":null,ea=({isVisible:e,onCancel:s,onSuccess:i})=>{let[r]=p.A.useForm(),{mutateAsync:t,isPending:n}=er(),a=async e=>{let s=et(e);await t(s,{onSuccess:()=>{S.Ay.success("SSO settings added successfully"),i()},onError:e=>{S.Ay.fromBackend("Failed to save SSO settings: "+(0,M.x)(e))}})},o=()=>{r.resetFields(),s()};return(0,l.jsx)(x.A,{title:"Add SSO",open:e,width:800,footer:(0,l.jsxs)(q.A,{children:[(0,l.jsx)(j.Ay,{onClick:o,disabled:n,children:"Cancel"}),(0,l.jsx)(j.Ay,{loading:n,onClick:()=>r.submit(),children:n?"Adding...":"Add SSO"})]}),onCancel:o,children:(0,l.jsx)(ei,{form:r,onFormSubmit:a})})};var eo=i(66793);let ec=({isVisible:e,onCancel:s,onSuccess:i})=>{let{data:r}=G(),{mutateAsync:t,isPending:n}=er(),a=async()=>{await t({google_client_id:null,google_client_secret:null,microsoft_client_id:null,microsoft_client_secret:null,microsoft_tenant:null,generic_client_id:null,generic_client_secret:null,generic_authorization_endpoint:null,generic_token_endpoint:null,generic_userinfo_endpoint:null,proxy_base_url:null,user_email:null,sso_provider:null,role_mappings:null,team_mappings:null},{onSuccess:()=>{S.Ay.success("SSO settings cleared successfully"),s(),i()},onError:e=>{S.Ay.fromBackend("Failed to clear SSO settings: "+(0,M.x)(e))}})};return(0,l.jsx)(eo.A,{isOpen:e,title:"Confirm Clear SSO Settings",alertMessage:"This action cannot be undone.",message:"Are you sure you want to clear all SSO settings? Users will no longer be able to login using SSO after this change.",resourceInformationTitle:"SSO Settings",resourceInformation:[{label:"Provider",value:r?.values&&en(r?.values)||"Generic"}],onCancel:s,onOk:a,confirmLoading:n})},ed=({isVisible:e,onCancel:s,onSuccess:i})=>{let[r]=p.A.useForm(),t=G(),{mutateAsync:n,isPending:a}=er();(0,A.useEffect)(()=>{if(e&&t.data&&t.data.values){let e=t.data;console.log("Raw SSO data received:",e),console.log("SSO values:",e.values),console.log("user_email from API:",e.values.user_email);let s=null;e.values.google_client_id?s="google":e.values.microsoft_client_id?s="microsoft":e.values.generic_client_id&&(s=e.values.generic_authorization_endpoint?.includes("okta")||e.values.generic_authorization_endpoint?.includes("auth0")?"okta":"generic");let i={};if(e.values.role_mappings){let s=e.values.role_mappings,l=e=>e&&0!==e.length?e.join(", "):"";i={use_role_mappings:!0,group_claim:s.group_claim,default_role:s.default_role||"internal_user",proxy_admin_teams:l(s.roles?.proxy_admin),admin_viewer_teams:l(s.roles?.proxy_admin_viewer),internal_user_teams:l(s.roles?.internal_user),internal_viewer_teams:l(s.roles?.internal_user_viewer)}}let l={};e.values.team_mappings&&(l={use_team_mappings:!0,team_ids_jwt_field:e.values.team_mappings.team_ids_jwt_field});let n={sso_provider:s,...e.values,...i,...l};console.log("Setting form values:",n),r.resetFields(),setTimeout(()=>{r.setFieldsValue(n),console.log("Form values set, current form values:",r.getFieldsValue())},100)}},[e,t.data,r]);let o=async e=>{try{let s=et(e);await n(s,{onSuccess:()=>{S.Ay.success("SSO settings updated successfully"),i()},onError:e=>{S.Ay.fromBackend("Failed to save SSO settings: "+(0,M.x)(e))}})}catch(e){S.Ay.fromBackend("Failed to process SSO settings: "+(0,M.x)(e))}},c=()=>{r.resetFields(),s()};return(0,l.jsx)(x.A,{title:"Edit SSO Settings",open:e,width:800,footer:(0,l.jsxs)(q.A,{children:[(0,l.jsx)(j.Ay,{onClick:c,disabled:a,children:"Cancel"}),(0,l.jsx)(j.Ay,{loading:a,onClick:()=>r.submit(),children:a?"Saving...":"Save"})]}),onCancel:c,children:(0,l.jsx)(ei,{form:r,onFormSubmit:o})})};var eu=i(7915),em=i(15411);function e_({defaultHidden:e=!0,value:s}){let[i,r]=(0,A.useState)(e);return(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"font-mono text-gray-600 flex-1",children:s?i?"•".repeat(s.length):s:(0,l.jsx)("span",{className:"text-gray-400 italic",children:"Not configured"})}),s&&(0,l.jsx)(j.Ay,{type:"text",size:"small",icon:i?(0,l.jsx)(eu.A,{className:"w-4 h-4"}):(0,l.jsx)(em.A,{className:"w-4 h-4"}),onClick:()=>r(!i),className:"text-gray-400 hover:text-gray-600"})]})}var eg=i(7339),ep=i(50139),eh=i(7810);let{Title:ex,Text:ey}=g.A;function ej({roleMappings:e}){if(!e)return null;let s=[{title:"Role",dataIndex:"role",key:"role",render:e=>(0,l.jsx)(ey,{strong:!0,children:X[e]})},{title:"Mapped Groups",dataIndex:"groups",key:"groups",render:e=>(0,l.jsx)(l.Fragment,{children:e.length>0?e.map((e,s)=>(0,l.jsx)(B.A,{color:"blue",children:e},s)):(0,l.jsx)(ey,{className:"text-gray-400 italic",children:"No groups mapped"})})}];return(0,l.jsxs)(W.A,{children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(eh.A,{className:"w-6 h-6 text-gray-400 mb-2"}),(0,l.jsx)(ex,{level:3,children:"Role Mappings"})]}),(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(ex,{level:5,children:"Group Claim"}),(0,l.jsx)("div",{children:(0,l.jsx)(ey,{code:!0,children:e.group_claim})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(ex,{level:5,children:"Default Role"}),(0,l.jsx)("div",{children:(0,l.jsx)(ey,{strong:!0,children:X[e.default_role]})})]})]}),(0,l.jsx)(eg.A,{}),(0,l.jsx)(ep.A,{columns:s,dataSource:Object.entries(e.roles).map(([e,s])=>({role:e,groups:s})),pagination:!1,bordered:!0,size:"small",className:"w-full"})]})]})}var ef=i(25339);let{Title:eA,Paragraph:ev}=g.A;function eS({onAdd:e}){return(0,l.jsx)("div",{className:"bg-white p-12 rounded-lg border border-dashed border-gray-300 text-center w-full",children:(0,l.jsx)(ef.A,{image:ef.A.PRESENTED_IMAGE_SIMPLE,description:(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(eA,{level:4,children:"No SSO Configuration Found"}),(0,l.jsx)(ev,{type:"secondary",className:"max-w-md mx-auto",children:"Configure Single Sign-On (SSO) to enable seamless authentication for your team members using your identity provider."})]}),children:(0,l.jsx)(j.Ay,{type:"primary",size:"large",onClick:e,className:"flex items-center gap-2 mx-auto mt-4",children:"Configure SSO"})})})}var eb=i(8536);let{Title:eI,Text:eC}=g.A;function ew(){return(0,l.jsx)(W.A,{children:(0,l.jsxs)(q.A,{direction:"vertical",size:"large",className:"w-full",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(Y.A,{className:"w-6 h-6 text-gray-400"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(eI,{level:3,children:"SSO Configuration"}),(0,l.jsx)(eC,{type:"secondary",children:"Manage Single Sign-On authentication settings"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(eb.A.Button,{active:!0,size:"default",style:{width:170,height:32}}),(0,l.jsx)(eb.A.Button,{active:!0,size:"default",style:{width:190,height:32}})]})]}),(0,l.jsxs)(V.A,{bordered:!0,...{column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1}},children:[(0,l.jsx)(V.A.Item,{label:(0,l.jsx)(eb.A.Node,{active:!0,style:{width:80,height:16}}),children:(0,l.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:(0,l.jsx)(eb.A.Node,{active:!0,style:{width:100,height:16}})})}),(0,l.jsx)(V.A.Item,{label:(0,l.jsx)(eb.A.Node,{active:!0,style:{width:80,height:16}}),children:(0,l.jsx)(eb.A.Node,{active:!0,style:{width:200,height:16}})}),(0,l.jsx)(V.A.Item,{label:(0,l.jsx)(eb.A.Node,{active:!0,style:{width:80,height:16}}),children:(0,l.jsx)(eb.A.Node,{active:!0,style:{width:250,height:16}})}),(0,l.jsx)(V.A.Item,{label:(0,l.jsx)(eb.A.Node,{active:!0,style:{width:80,height:16}}),children:(0,l.jsx)(eb.A.Node,{active:!0,style:{width:180,height:16}})}),(0,l.jsx)(V.A.Item,{label:(0,l.jsx)(eb.A.Node,{active:!0,style:{width:80,height:16}}),children:(0,l.jsx)(eb.A.Node,{active:!0,style:{width:220,height:16}})})]})]})})}let{Title:ek,Text:eN}=g.A;function eE(){let{data:e,refetch:s,isLoading:i}=G(),[r,t]=(0,A.useState)(!1),[n,a]=(0,A.useState)(!1),[o,c]=(0,A.useState)(!1),d=!!e?.values.google_client_id||!!e?.values.microsoft_client_id||!!e?.values.generic_client_id,u=e?.values?en(e.values):null,m=!!e?.values.role_mappings,_=!!e?.values.team_mappings,g=e=>(0,l.jsx)(eN,{className:"font-mono text-gray-600 text-sm",copyable:!!e,children:e||"-"}),p=e=>e||(0,l.jsx)("span",{className:"text-gray-400 italic",children:"Not configured"}),h=e=>e.team_mappings?.team_ids_jwt_field?(0,l.jsx)(B.A,{children:e.team_mappings.team_ids_jwt_field}):(0,l.jsx)("span",{className:"text-gray-400 italic",children:"Not configured"}),x={column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1}},y={google:{providerText:K.google,fields:[{label:"Client ID",render:e=>(0,l.jsx)(e_,{value:e.google_client_id})},{label:"Client Secret",render:e=>(0,l.jsx)(e_,{value:e.google_client_secret})},{label:"Proxy Base URL",render:e=>p(e.proxy_base_url)}]},microsoft:{providerText:K.microsoft,fields:[{label:"Client ID",render:e=>(0,l.jsx)(e_,{value:e.microsoft_client_id})},{label:"Client Secret",render:e=>(0,l.jsx)(e_,{value:e.microsoft_client_secret})},{label:"Tenant",render:e=>p(e.microsoft_tenant)},{label:"Proxy Base URL",render:e=>p(e.proxy_base_url)}]},okta:{providerText:K.okta,fields:[{label:"Client ID",render:e=>(0,l.jsx)(e_,{value:e.generic_client_id})},{label:"Client Secret",render:e=>(0,l.jsx)(e_,{value:e.generic_client_secret})},{label:"Authorization Endpoint",render:e=>g(e.generic_authorization_endpoint)},{label:"Token Endpoint",render:e=>g(e.generic_token_endpoint)},{label:"User Info Endpoint",render:e=>g(e.generic_userinfo_endpoint)},{label:"Proxy Base URL",render:e=>p(e.proxy_base_url)},_?{label:"Team IDs JWT Field",render:e=>h(e)}:null]},generic:{providerText:K.generic,fields:[{label:"Client ID",render:e=>(0,l.jsx)(e_,{value:e.generic_client_id})},{label:"Client Secret",render:e=>(0,l.jsx)(e_,{value:e.generic_client_secret})},{label:"Authorization Endpoint",render:e=>g(e.generic_authorization_endpoint)},{label:"Token Endpoint",render:e=>g(e.generic_token_endpoint)},{label:"User Info Endpoint",render:e=>g(e.generic_userinfo_endpoint)},{label:"Proxy Base URL",render:e=>p(e.proxy_base_url)},_?{label:"Team IDs JWT Field",render:e=>h(e)}:null]}};return(0,l.jsxs)(l.Fragment,{children:[i?(0,l.jsx)(ew,{}):(0,l.jsxs)(q.A,{direction:"vertical",size:"large",className:"w-full",children:[(0,l.jsx)(W.A,{children:(0,l.jsxs)(q.A,{direction:"vertical",size:"large",className:"w-full",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(Y.A,{className:"w-6 h-6 text-gray-400"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(ek,{level:3,children:"SSO Configuration"}),(0,l.jsx)(eN,{type:"secondary",children:"Manage Single Sign-On authentication settings"})]})]}),(0,l.jsx)("div",{className:"flex items-center gap-3",children:d&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.Ay,{icon:(0,l.jsx)($.A,{className:"w-4 h-4"}),onClick:()=>c(!0),children:"Edit SSO Settings"}),(0,l.jsx)(j.Ay,{danger:!0,icon:(0,l.jsx)(J.A,{className:"w-4 h-4"}),onClick:()=>t(!0),children:"Delete SSO Settings"})]})})]}),d?(()=>{if(!e?.values||!u)return null;let{values:s}=e,i=y[u];return i?(0,l.jsxs)(V.A,{bordered:!0,...x,children:[(0,l.jsx)(V.A.Item,{label:"Provider",children:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[H[u]&&(0,l.jsx)("img",{src:H[u],alt:u,style:{height:24,width:24,objectFit:"contain"}}),(0,l.jsx)("span",{children:i.providerText})]})}),i.fields.map((e,i)=>e&&(0,l.jsx)(V.A.Item,{label:e.label,children:e.render(s)},i))]}):null})():(0,l.jsx)(eS,{onAdd:()=>a(!0)})]})}),m&&(0,l.jsx)(ej,{roleMappings:e?.values.role_mappings})]}),(0,l.jsx)(ec,{isVisible:r,onCancel:()=>t(!1),onSuccess:()=>s()}),(0,l.jsx)(ea,{isVisible:n,onCancel:()=>a(!1),onSuccess:()=>{a(!1),s()}}),(0,l.jsx)(ed,{isVisible:o,onCancel:()=>c(!1),onSuccess:()=>{c(!1),s()}})]})}var eO=i(71050),eT=i(35625);let eP=(0,L.D)("uiSettings");var eU=i(28700);let eR={"api-keys":"Manage virtual keys for API access and authentication","llm-playground":"Interactive playground for testing LLM requests",models:"Configure and manage LLM models and endpoints",agents:"Create and manage AI agents","mcp-servers":"Configure Model Context Protocol servers",guardrails:"Set up content moderation and safety guardrails",policies:"Define access control and usage policies","search-tools":"Configure RAG search and retrieval tools","vector-stores":"Manage vector databases for embeddings",new_usage:"View usage analytics and metrics",logs:"Access request and response logs","guardrails-monitor":"Monitor guardrail performance and view logs",users:"Manage internal user accounts and permissions",teams:"Create and manage teams for access control",organizations:"Manage organizations and their members","access-groups":"Manage access groups for role-based permissions",budgets:"Set and monitor spending budgets",api_ref:"Browse API documentation and endpoints","model-hub-table":"Explore available AI models and providers","learning-resources":"Access tutorials and documentation",caching:"Configure response caching settings","transform-request":"Set up request transformation rules","cost-tracking":"Track and analyze API costs","ui-theme":"Customize dashboard appearance","tag-management":"Organize resources with tags",prompts:"Manage and version prompt templates","claude-code-plugins":"Configure Claude Code plugins",usage:"View legacy usage dashboard","router-settings":"Configure routing and load balancing settings","logging-and-alerts":"Set up logging and alert configurations","admin-panel":"Access admin panel and settings"};var eM=i(90550);let eF=e=>!e||0===e.length||e.some(e=>eM.UX.includes(e));var ez=i(10639);function eL({enabledPagesInternalUsers:e,enabledPagesPropertyDescription:s,isUpdating:i,onUpdate:r}){let t=null!=e,n=(0,A.useMemo)(()=>{let e;return e=[],eU.O.forEach(s=>{s.items.forEach(i=>{if(i.page&&"tools"!==i.page&&"experimental"!==i.page&&"settings"!==i.page&&eF(i.roles)){let l="string"==typeof i.label?i.label:i.key;e.push({page:i.page,label:l,group:s.groupLabel,description:eR[i.page]||"No description available"})}if(i.children){let l="string"==typeof i.label?i.label:i.key;i.children.forEach(i=>{if(eF(i.roles)){let r="string"==typeof i.label?i.label:i.key;e.push({page:i.page,label:r,group:`${s.groupLabel} > ${l}`,description:eR[i.page]||"No description available"})}})}})}),e},[]),a=(0,A.useMemo)(()=>{let e={};return n.forEach(s=>{e[s.group]||(e[s.group]=[]),e[s.group].push(s)}),e},[n]),[o,c]=(0,A.useState)(e||[]);return(0,A.useMemo)(()=>{e?c(e):c([])},[e]),(0,l.jsxs)(q.A,{direction:"vertical",size:"middle",style:{width:"100%"},children:[(0,l.jsxs)(q.A,{direction:"vertical",size:4,children:[(0,l.jsxs)(q.A,{align:"center",children:[(0,l.jsx)(g.A.Text,{strong:!0,children:"Internal User Page Visibility"}),!t&&(0,l.jsx)(B.A,{color:"default",style:{marginLeft:"8px"},children:"Not set (all pages visible)"}),t&&(0,l.jsxs)(B.A,{color:"blue",style:{marginLeft:"8px"},children:[o.length," page",1!==o.length?"s":""," selected"]})]}),s&&(0,l.jsx)(g.A.Text,{type:"secondary",children:s}),(0,l.jsx)(g.A.Text,{type:"secondary",style:{fontSize:"12px",fontStyle:"italic"},children:"By default, all pages are visible to internal users. Select specific pages to restrict visibility."}),(0,l.jsx)(g.A.Text,{type:"secondary",style:{fontSize:"12px",color:"#8b5cf6"},children:"Note: Only pages accessible to internal user roles are shown here. Admin-only pages are excluded as they cannot be made visible to internal users regardless of this setting."})]}),(0,l.jsx)(ez.A,{items:[{key:"page-visibility",label:"Configure Page Visibility",children:(0,l.jsxs)(q.A,{direction:"vertical",size:"middle",style:{width:"100%"},children:[(0,l.jsx)(ee.A.Group,{value:o,onChange:c,style:{width:"100%"},children:(0,l.jsx)(q.A,{direction:"vertical",size:"middle",style:{width:"100%"},children:Object.entries(a).map(([e,s])=>(0,l.jsxs)("div",{children:[(0,l.jsx)(g.A.Text,{strong:!0,style:{fontSize:"11px",color:"#6b7280",letterSpacing:"0.05em",display:"block",marginBottom:"8px"},children:e}),(0,l.jsx)(q.A,{direction:"vertical",size:"small",style:{marginLeft:"16px",width:"100%"},children:s.map(e=>(0,l.jsx)("div",{style:{marginBottom:"4px"},children:(0,l.jsx)(ee.A,{value:e.page,children:(0,l.jsxs)(q.A,{direction:"vertical",size:0,children:[(0,l.jsx)(g.A.Text,{children:e.label}),(0,l.jsx)(g.A.Text,{type:"secondary",style:{fontSize:"12px"},children:e.description})]})})},e.page))})]},e))})}),(0,l.jsxs)(q.A,{children:[(0,l.jsx)(j.Ay,{type:"primary",onClick:()=>{r({enabled_ui_pages_internal_users:o.length>0?o:null})},loading:i,disabled:i,children:"Save Page Visibility Settings"}),t&&(0,l.jsx)(j.Ay,{onClick:()=>{c([]),r({enabled_ui_pages_internal_users:null})},loading:i,disabled:i,children:"Reset to Default (All Pages)"})]})]})}]})]})}var eD=i(16989);function eG(){let e,{accessToken:s}=(0,r.A)(),{data:i,isLoading:t,isError:n,error:a}=(0,eO.f)(),{mutate:o,isPending:c,error:d}=(e=(0,eT.jE)(),(0,el.n)({mutationFn:async e=>{if(!s)throw Error("Access token is required");return(0,b.updateUiSettings)(s,e)},onSuccess:()=>{e.invalidateQueries({queryKey:eP.all})}})),u=i?.field_schema,m=u?.properties?.disable_model_add_for_internal_users,_=u?.properties?.disable_team_admin_delete_team_user,p=u?.properties?.require_auth_for_public_ai_hub,x=u?.properties?.forward_client_headers_to_llm_api,y=u?.properties?.enabled_ui_pages_internal_users,j=i?.values??{},f=!!j.disable_model_add_for_internal_users,A=!!j.disable_team_admin_delete_team_user;return(0,l.jsx)(W.A,{title:"UI Settings",children:t?(0,l.jsx)(eb.A,{active:!0}):n?(0,l.jsx)(h.A,{type:"error",message:"Could not load UI settings",description:a instanceof Error?a.message:void 0}):(0,l.jsxs)(q.A,{direction:"vertical",size:"large",style:{width:"100%"},children:[u?.description&&(0,l.jsx)(g.A.Paragraph,{style:{marginBottom:0},children:u.description}),d&&(0,l.jsx)(h.A,{type:"error",message:"Could not update UI settings",description:d instanceof Error?d.message:void 0}),(0,l.jsxs)(q.A,{align:"start",size:"middle",children:[(0,l.jsx)(eD.A,{checked:f,disabled:c,loading:c,onChange:e=>{o({disable_model_add_for_internal_users:e},{onSuccess:()=>{S.Ay.success("UI settings updated successfully")},onError:e=>{S.Ay.fromBackend(e)}})},"aria-label":m?.description??"Disable model add for internal users"}),(0,l.jsxs)(q.A,{direction:"vertical",size:4,children:[(0,l.jsx)(g.A.Text,{strong:!0,children:"Disable model add for internal users"}),m?.description&&(0,l.jsx)(g.A.Text,{type:"secondary",children:m.description})]})]}),(0,l.jsxs)(q.A,{align:"start",size:"middle",children:[(0,l.jsx)(eD.A,{checked:A,disabled:c,loading:c,onChange:e=>{o({disable_team_admin_delete_team_user:e},{onSuccess:()=>{S.Ay.success("UI settings updated successfully")},onError:e=>{S.Ay.fromBackend(e)}})},"aria-label":_?.description??"Disable team admin delete team user"}),(0,l.jsxs)(q.A,{direction:"vertical",size:4,children:[(0,l.jsx)(g.A.Text,{strong:!0,children:"Disable team admin delete team user"}),_?.description&&(0,l.jsx)(g.A.Text,{type:"secondary",children:_.description})]})]}),(0,l.jsxs)(q.A,{align:"start",size:"middle",children:[(0,l.jsx)(eD.A,{checked:j.require_auth_for_public_ai_hub,disabled:c,loading:c,onChange:e=>{o({require_auth_for_public_ai_hub:e},{onSuccess:()=>{S.Ay.success("UI settings updated successfully")},onError:e=>{S.Ay.fromBackend(e)}})},"aria-label":p?.description??"Require authentication for public AI Hub"}),(0,l.jsxs)(q.A,{direction:"vertical",size:4,children:[(0,l.jsx)(g.A.Text,{strong:!0,children:"Require authentication for public AI Hub"}),p?.description&&(0,l.jsx)(g.A.Text,{type:"secondary",children:p.description})]})]}),(0,l.jsxs)(q.A,{align:"start",size:"middle",children:[(0,l.jsx)(eD.A,{checked:!!j.forward_client_headers_to_llm_api,disabled:c,loading:c,onChange:e=>{o({forward_client_headers_to_llm_api:e},{onSuccess:()=>{S.Ay.success("UI settings updated successfully")},onError:e=>{S.Ay.fromBackend(e)}})},"aria-label":x?.description??"Forward client headers to LLM API"}),(0,l.jsxs)(q.A,{direction:"vertical",size:4,children:[(0,l.jsx)(g.A.Text,{strong:!0,children:"Forward client headers to LLM API"}),(0,l.jsx)(g.A.Text,{type:"secondary",children:x?.description??"If enabled, forwards client headers (e.g. Authorization) to the LLM API. Required for Claude Code with Max subscription."})]})]}),(0,l.jsx)(eg.A,{}),(0,l.jsx)(eL,{enabledPagesInternalUsers:j.enabled_ui_pages_internal_users,enabledPagesPropertyDescription:y?.description,isUpdating:c,onUpdate:e=>{o(e,{onSuccess:()=>{S.Ay.success("Page visibility settings updated successfully")},onError:e=>{S.Ay.fromBackend(e)}})}})]})})}var eB=i(58337);let eV={google:"https://artificialanalysis.ai/img/logos/google_small.svg",microsoft:"https://upload.wikimedia.org/wikipedia/commons/a/a8/Microsoft_Azure_Logo.svg",okta:"https://www.okta.com/sites/default/files/Okta_Logo_BrightBlue_Medium.png",generic:""},eq={google:{envVarMap:{google_client_id:"GOOGLE_CLIENT_ID",google_client_secret:"GOOGLE_CLIENT_SECRET"},fields:[{label:"Google Client ID",name:"google_client_id"},{label:"Google Client Secret",name:"google_client_secret"}]},microsoft:{envVarMap:{microsoft_client_id:"MICROSOFT_CLIENT_ID",microsoft_client_secret:"MICROSOFT_CLIENT_SECRET",microsoft_tenant:"MICROSOFT_TENANT"},fields:[{label:"Microsoft Client ID",name:"microsoft_client_id"},{label:"Microsoft Client Secret",name:"microsoft_client_secret"},{label:"Microsoft Tenant",name:"microsoft_tenant"}]},okta:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"Generic Client ID",name:"generic_client_id"},{label:"Generic Client Secret",name:"generic_client_secret"},{label:"Authorization Endpoint",name:"generic_authorization_endpoint",placeholder:"https://your-domain/authorize"},{label:"Token Endpoint",name:"generic_token_endpoint",placeholder:"https://your-domain/token"},{label:"Userinfo Endpoint",name:"generic_userinfo_endpoint",placeholder:"https://your-domain/userinfo"}]},generic:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"Generic Client ID",name:"generic_client_id"},{label:"Generic Client Secret",name:"generic_client_secret"},{label:"Authorization Endpoint",name:"generic_authorization_endpoint"},{label:"Token Endpoint",name:"generic_token_endpoint"},{label:"Userinfo Endpoint",name:"generic_userinfo_endpoint"}]}},eW=({isAddSSOModalVisible:e,isInstructionsModalVisible:s,handleAddSSOOk:i,handleAddSSOCancel:r,handleShowInstructions:t,handleInstructionsOk:n,handleInstructionsCancel:a,form:o,accessToken:c,ssoConfigured:d=!1})=>{let[u,m]=(0,A.useState)(!1);(0,A.useEffect)(()=>{(async()=>{if(e&&c)try{let e=await (0,b.getSSOSettings)(c);if(console.log("Raw SSO data received:",e),e&&e.values){console.log("SSO values:",e.values),console.log("user_email from API:",e.values.user_email);let s=null;e.values.google_client_id?s="google":e.values.microsoft_client_id?s="microsoft":e.values.generic_client_id&&(s=e.values.generic_authorization_endpoint?.includes("okta")||e.values.generic_authorization_endpoint?.includes("auth0")?"okta":"generic");let i={};if(e.values.role_mappings){let s=e.values.role_mappings,l=e=>e&&0!==e.length?e.join(", "):"";i={use_role_mappings:!0,group_claim:s.group_claim,default_role:s.default_role||"internal_user",proxy_admin_teams:l(s.roles?.proxy_admin),admin_viewer_teams:l(s.roles?.proxy_admin_viewer),internal_user_teams:l(s.roles?.internal_user),internal_viewer_teams:l(s.roles?.internal_user_viewer)}}let l={sso_provider:s,proxy_base_url:e.values.proxy_base_url,user_email:e.values.user_email,...e.values,...i};console.log("Setting form values:",l),o.resetFields(),setTimeout(()=>{o.setFieldsValue(l),console.log("Form values set, current form values:",o.getFieldsValue())},100)}}catch(e){console.error("Failed to load SSO settings:",e)}})()},[e,c,o]);let _=async e=>{if(!c)return void S.Ay.fromBackend("No access token available");try{let{proxy_admin_teams:s,admin_viewer_teams:i,internal_user_teams:l,internal_viewer_teams:r,default_role:n,group_claim:a,use_role_mappings:o,...d}=e,u={...d};if(o){let e=e=>e&&""!==e.trim()?e.split(",").map(e=>e.trim()).filter(e=>e.length>0):[];u.role_mappings={provider:"generic",group_claim:a,default_role:({internal_user_viewer:"internal_user_viewer",internal_user:"internal_user",proxy_admin_viewer:"proxy_admin_viewer",proxy_admin:"proxy_admin"})[n]||"internal_user",roles:{proxy_admin:e(s),proxy_admin_viewer:e(i),internal_user:e(l),internal_user_viewer:e(r)}}}await (0,b.updateSSOSettings)(c,u),t(e)}catch(e){S.Ay.fromBackend("Failed to save SSO settings: "+(0,M.x)(e))}},g=async()=>{if(!c)return void S.Ay.fromBackend("No access token available");try{await (0,b.updateSSOSettings)(c,{google_client_id:null,google_client_secret:null,microsoft_client_id:null,microsoft_client_secret:null,microsoft_tenant:null,generic_client_id:null,generic_client_secret:null,generic_authorization_endpoint:null,generic_token_endpoint:null,generic_userinfo_endpoint:null,proxy_base_url:null,user_email:null,sso_provider:null,role_mappings:null}),o.resetFields(),m(!1),i(),S.Ay.success("SSO settings cleared successfully")}catch(e){console.error("Failed to clear SSO settings:",e),S.Ay.fromBackend("Failed to clear SSO settings")}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x.A,{title:d?"Edit SSO Settings":"Add SSO",open:e,width:800,footer:null,onOk:i,onCancel:r,children:(0,l.jsxs)(p.A,{form:o,onFinish:_,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.A.Item,{label:"SSO Provider",name:"sso_provider",rules:[{required:!0,message:"Please select an SSO provider"}],children:(0,l.jsx)(Q.A,{children:Object.entries(eV).map(([e,s])=>(0,l.jsx)(Q.A.Option,{value:e,children:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 0"},children:[s&&(0,l.jsx)("img",{src:s,alt:e,style:{height:24,width:24,marginRight:12,objectFit:"contain"}}),(0,l.jsxs)("span",{children:["okta"===e.toLowerCase()?"Okta / Auth0":e.charAt(0).toUpperCase()+e.slice(1)," ","SSO"]})]})},e))})}),(0,l.jsx)(p.A.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.sso_provider!==s.sso_provider,children:({getFieldValue:e})=>{let s,i=e("sso_provider");return i&&(s=eq[i])?s.fields.map(e=>(0,l.jsx)(p.A.Item,{label:e.label,name:e.name,rules:[{required:!0,message:`Please enter the ${e.label.toLowerCase()}`}],children:e.name.includes("client")?(0,l.jsx)(y.A.Password,{}):(0,l.jsx)(eB.k,{placeholder:e.placeholder})},e.name)):null}}),(0,l.jsx)(p.A.Item,{label:"Proxy Admin Email",name:"user_email",rules:[{required:!0,message:"Please enter the email of the proxy admin"}],children:(0,l.jsx)(eB.k,{})}),(0,l.jsx)(p.A.Item,{label:"Proxy Base URL",name:"proxy_base_url",normalize:e=>e?.trim(),rules:[{required:!0,message:"Please enter the proxy base url"},{pattern:/^https?:\/\/.+/,message:"URL must start with http:// or https://"},{validator:(e,s)=>s&&/^https?:\/\/.+/.test(s)&&s.endsWith("/")?Promise.reject("URL must not end with a trailing slash"):Promise.resolve()}],children:(0,l.jsx)(eB.k,{placeholder:"https://example.com"})}),(0,l.jsx)(p.A.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.sso_provider!==s.sso_provider,children:({getFieldValue:e})=>{let s=e("sso_provider");return"okta"===s||"generic"===s?(0,l.jsx)(p.A.Item,{label:"Use Role Mappings",name:"use_role_mappings",valuePropName:"checked",children:(0,l.jsx)(ee.A,{})}):null}}),(0,l.jsx)(p.A.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.use_role_mappings!==s.use_role_mappings,children:({getFieldValue:e})=>e("use_role_mappings")?(0,l.jsx)(p.A.Item,{label:"Group Claim",name:"group_claim",rules:[{required:!0,message:"Please enter the group claim"}],children:(0,l.jsx)(eB.k,{})}):null}),(0,l.jsx)(p.A.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.use_role_mappings!==s.use_role_mappings,children:({getFieldValue:e})=>e("use_role_mappings")?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.A.Item,{label:"Default Role",name:"default_role",initialValue:"Internal User",children:(0,l.jsxs)(Q.A,{children:[(0,l.jsx)(Q.A.Option,{value:"internal_user_viewer",children:"Internal Viewer"}),(0,l.jsx)(Q.A.Option,{value:"internal_user",children:"Internal User"}),(0,l.jsx)(Q.A.Option,{value:"proxy_admin_viewer",children:"Admin Viewer"}),(0,l.jsx)(Q.A.Option,{value:"proxy_admin",children:"Proxy Admin"})]})}),(0,l.jsx)(p.A.Item,{label:"Proxy Admin Teams",name:"proxy_admin_teams",children:(0,l.jsx)(eB.k,{})}),(0,l.jsx)(p.A.Item,{label:"Admin Viewer Teams",name:"admin_viewer_teams",children:(0,l.jsx)(eB.k,{})}),(0,l.jsx)(p.A.Item,{label:"Internal User Teams",name:"internal_user_teams",children:(0,l.jsx)(eB.k,{})}),(0,l.jsx)(p.A.Item,{label:"Internal Viewer Teams",name:"internal_viewer_teams",children:(0,l.jsx)(eB.k,{})})]}):null})]}),(0,l.jsxs)("div",{style:{textAlign:"right",marginTop:"10px",display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"8px"},children:[d&&(0,l.jsx)(j.Ay,{onClick:()=>m(!0),style:{backgroundColor:"#6366f1",borderColor:"#6366f1",color:"white"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#5558eb",e.currentTarget.style.borderColor="#5558eb"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#6366f1",e.currentTarget.style.borderColor="#6366f1"},children:"Clear"}),(0,l.jsx)(j.Ay,{htmlType:"submit",children:"Save"})]})]})}),(0,l.jsxs)(x.A,{title:"Confirm Clear SSO Settings",open:u,onOk:g,onCancel:()=>m(!1),okText:"Yes, Clear",cancelText:"Cancel",okButtonProps:{danger:!0,style:{backgroundColor:"#dc2626",borderColor:"#dc2626"}},children:[(0,l.jsx)("p",{children:"Are you sure you want to clear all SSO settings? This action cannot be undone."}),(0,l.jsx)("p",{children:"Users will no longer be able to login using SSO after this change."})]}),(0,l.jsxs)(x.A,{title:"SSO Setup Instructions",open:s,width:800,footer:null,onOk:n,onCancel:a,children:[(0,l.jsx)("p",{children:"Follow these steps to complete the SSO setup:"}),(0,l.jsx)(eB.E,{className:"mt-2",children:"1. DO NOT Exit this TAB"}),(0,l.jsx)(eB.E,{className:"mt-2",children:"2. Open a new tab, visit your proxy base url"}),(0,l.jsx)(eB.E,{className:"mt-2",children:"3. Confirm your SSO is configured correctly and you can login on the new Tab"}),(0,l.jsx)(eB.E,{className:"mt-2",children:"4. If Step 3 is successful, you can close this tab"}),(0,l.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,l.jsx)(j.Ay,{onClick:n,children:"Done"})})]})]})},eY=({accessToken:e,onSuccess:s})=>{let[i]=p.A.useForm(),[r,t]=(0,A.useState)(!1);(0,A.useEffect)(()=>{(async()=>{if(e)try{let s=await (0,b.getSSOSettings)(e);if(s&&s.values){let e=s.values.ui_access_mode,l={};e&&"object"==typeof e?l={ui_access_mode_type:e.type,restricted_sso_group:e.restricted_sso_group,sso_group_jwt_field:e.sso_group_jwt_field}:"string"==typeof e&&(l={ui_access_mode_type:e,restricted_sso_group:s.values.restricted_sso_group,sso_group_jwt_field:s.values.team_ids_jwt_field||s.values.sso_group_jwt_field}),i.setFieldsValue(l)}}catch(e){console.error("Failed to load UI access settings:",e)}})()},[e,i]);let n=async i=>{if(!e)return void S.Ay.fromBackend("No access token available");t(!0);try{let l;l="all_authenticated_users"===i.ui_access_mode_type?{ui_access_mode:"none"}:{ui_access_mode:{type:i.ui_access_mode_type,restricted_sso_group:i.restricted_sso_group,sso_group_jwt_field:i.sso_group_jwt_field}},await (0,b.updateSSOSettings)(e,l),s()}catch(e){console.error("Failed to save UI access settings:",e),S.Ay.fromBackend("Failed to save UI access settings")}finally{t(!1)}};return(0,l.jsxs)("div",{style:{padding:"16px"},children:[(0,l.jsx)("div",{style:{marginBottom:"16px"},children:(0,l.jsx)(eB.E,{style:{fontSize:"14px",color:"#6b7280"},children:"Configure who can access the UI interface and how group information is extracted from JWT tokens."})}),(0,l.jsxs)(p.A,{form:i,onFinish:n,layout:"vertical",children:[(0,l.jsx)(p.A.Item,{label:"UI Access Mode",name:"ui_access_mode_type",tooltip:"Controls who can access the UI interface",children:(0,l.jsxs)(Q.A,{placeholder:"Select access mode",children:[(0,l.jsx)(Q.A.Option,{value:"all_authenticated_users",children:"All Authenticated Users"}),(0,l.jsx)(Q.A.Option,{value:"restricted_sso_group",children:"Restricted SSO Group"})]})}),(0,l.jsx)(p.A.Item,{noStyle:!0,shouldUpdate:(e,s)=>e.ui_access_mode_type!==s.ui_access_mode_type,children:({getFieldValue:e})=>"restricted_sso_group"===e("ui_access_mode_type")?(0,l.jsx)(p.A.Item,{label:"Restricted SSO Group",name:"restricted_sso_group",rules:[{required:!0,message:"Please enter the restricted SSO group"}],children:(0,l.jsx)(eB.k,{placeholder:"ui-access-group"})}):null}),(0,l.jsx)(p.A.Item,{label:"SSO Group JWT Field",name:"sso_group_jwt_field",tooltip:"JWT field name that contains team/group information. Use dot notation to access nested fields.",children:(0,l.jsx)(eB.k,{placeholder:"groups"})}),(0,l.jsx)("div",{style:{textAlign:"right",marginTop:"16px"},children:(0,l.jsx)(j.Ay,{type:"primary",htmlType:"submit",loading:r,style:{backgroundColor:"#6366f1",borderColor:"#6366f1"},children:"Update UI Access Control"})})]})]})},{Title:e$,Paragraph:eJ,Text:eH}=g.A,eK=({proxySettings:e})=>{let{premiumUser:s,accessToken:i,userId:g}=(0,r.A)(),[I]=p.A.useForm(),[C,w]=(0,A.useState)(!1),[k,N]=(0,A.useState)(!1),[E,O]=(0,A.useState)(!1),[T,P]=(0,A.useState)(!1),[U,R]=(0,A.useState)(!1),[M,z]=(0,A.useState)(!1),[L,D]=(0,A.useState)([]),[G,B]=(0,A.useState)(null),[V,q]=(0,A.useState)(!1),W=(0,v.N)(),Y="All IP Addresses Allowed",$=W;$+="/fallback/login";let J=async()=>{if(i)try{let e=await (0,b.getSSOSettings)(i);if(e&&e.values){let s=e.values.google_client_id&&e.values.google_client_secret,i=e.values.microsoft_client_id&&e.values.microsoft_client_secret,l=e.values.generic_client_id&&e.values.generic_client_secret;q(s||i||l)}else q(!1)}catch(e){console.error("Error checking SSO configuration:",e),q(!1)}},H=async()=>{try{if(!0!==s)return void S.Ay.fromBackend("This feature is only available for premium users. Please upgrade your account.");if(i){let e=await (0,b.getAllowedIPs)(i);D(e&&e.length>0?e:[Y])}else D([Y])}catch(e){console.error("Error fetching allowed IPs:",e),S.Ay.fromBackend(`Failed to fetch allowed IPs ${e}`),D([Y])}finally{!0===s&&O(!0)}},K=async e=>{try{if(i){await (0,b.addAllowedIP)(i,e.ip);let s=await (0,b.getAllowedIPs)(i);D(s),S.Ay.success("IP address added successfully")}}catch(e){console.error("Error adding IP:",e),S.Ay.fromBackend(`Failed to add IP address ${e}`)}finally{P(!1)}},X=async e=>{B(e),R(!0)},Z=async()=>{if(G&&i)try{await (0,b.deleteAllowedIP)(i,G);let e=await (0,b.getAllowedIPs)(i);D(e.length>0?e:[Y]),S.Ay.success("IP address deleted successfully")}catch(e){console.error("Error deleting IP:",e),S.Ay.fromBackend(`Failed to delete IP address ${e}`)}finally{R(!1),B(null)}};(0,A.useEffect)(()=>{J()},[i,s,J]);let Q=()=>{z(!1)},ee=[{key:"sso-settings",label:"SSO Settings",children:(0,l.jsx)(eE,{})},{key:"security-settings",label:"Security Settings",children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(a.A,{children:[(0,l.jsx)(e$,{level:4,children:" ✨ Security Settings"}),(0,l.jsx)(h.A,{message:"SSO Configuration Deprecated",description:"Editing SSO Settings on this page is deprecated and will be removed in a future version. Please use the SSO Settings tab for SSO configuration.",type:"warning",showIcon:!0}),(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginTop:"1rem",marginLeft:"0.5rem"},children:[(0,l.jsx)("div",{children:(0,l.jsx)(t.A,{style:{width:"150px"},onClick:()=>w(!0),children:V?"Edit SSO Settings":"Add SSO"})}),(0,l.jsx)("div",{children:(0,l.jsx)(t.A,{style:{width:"150px"},onClick:H,children:"Allowed IPs"})}),(0,l.jsx)("div",{children:(0,l.jsx)(t.A,{style:{width:"150px"},onClick:()=>!0===s?z(!0):S.Ay.fromBackend("Only premium users can configure UI access control"),children:"UI Access Control"})})]})]}),(0,l.jsxs)("div",{className:"flex justify-start mb-4",children:[(0,l.jsx)(eW,{isAddSSOModalVisible:C,isInstructionsModalVisible:k,handleAddSSOOk:()=>{w(!1),I.resetFields(),i&&s&&J()},handleAddSSOCancel:()=>{w(!1),I.resetFields()},handleShowInstructions:e=>{w(!1),N(!0)},handleInstructionsOk:()=>{N(!1),i&&s&&J()},handleInstructionsCancel:()=>{N(!1),i&&s&&J()},form:I,accessToken:i,ssoConfigured:V}),(0,l.jsx)(x.A,{title:"Manage Allowed IP Addresses",width:800,open:E,onCancel:()=>O(!1),footer:[(0,l.jsx)(t.A,{className:"mx-1",onClick:()=>P(!0),children:"Add IP Address"},"add"),(0,l.jsx)(t.A,{onClick:()=>O(!1),children:"Close"},"close")],children:(0,l.jsxs)(o.A,{children:[(0,l.jsx)(u.A,{children:(0,l.jsxs)(_.A,{children:[(0,l.jsx)(m.A,{children:"IP Address"}),(0,l.jsx)(m.A,{className:"text-right",children:"Action"})]})}),(0,l.jsx)(c.A,{children:L.map((e,s)=>(0,l.jsxs)(_.A,{children:[(0,l.jsx)(d.A,{children:e}),(0,l.jsx)(d.A,{className:"text-right",children:e!==Y&&(0,l.jsx)(t.A,{onClick:()=>X(e),color:"red",size:"xs",children:"Delete"})})]},s))})]})}),(0,l.jsx)(x.A,{title:"Add Allowed IP Address",open:T,onCancel:()=>P(!1),footer:null,children:(0,l.jsxs)(p.A,{onFinish:K,children:[(0,l.jsx)(p.A.Item,{name:"ip",rules:[{required:!0,message:"Please enter an IP address"}],children:(0,l.jsx)(y.A,{placeholder:"Enter IP address"})}),(0,l.jsx)(p.A.Item,{children:(0,l.jsx)(j.Ay,{htmlType:"submit",children:"Add IP Address"})})]})}),(0,l.jsx)(x.A,{title:"Confirm Delete",open:U,onCancel:()=>R(!1),onOk:Z,footer:[(0,l.jsx)(t.A,{className:"mx-1",onClick:()=>Z(),children:"Yes"},"delete"),(0,l.jsx)(t.A,{onClick:()=>R(!1),children:"Close"},"close")],children:(0,l.jsxs)(eH,{children:["Are you sure you want to delete the IP address: ",G,"?"]})}),(0,l.jsx)(x.A,{title:"UI Access Control Settings",open:M,width:600,footer:null,onOk:Q,onCancel:()=>{z(!1)},children:(0,l.jsx)(eY,{accessToken:i,onSuccess:()=>{Q(),S.Ay.success("UI Access Control settings updated successfully")}})})]}),(0,l.jsxs)(n.A,{title:"Login without SSO",color:"teal",children:["If you need to login without sso, you can access"," ",(0,l.jsxs)("a",{href:$,target:"_blank",rel:"noopener noreferrer",children:[(0,l.jsx)("b",{children:$})," "]})]})]})},{key:"scim",label:"SCIM",children:(0,l.jsx)(F,{accessToken:i,userID:g,proxySettings:e})},{key:"ui-settings",label:"UI Settings",children:(0,l.jsx)(eG,{})}];return(0,l.jsxs)("div",{className:"w-full m-2 mt-2 p-8",children:[(0,l.jsx)(e$,{level:4,children:"Admin Access "}),(0,l.jsx)(eJ,{children:"Go to 'Internal Users' page to add other admins."}),(0,l.jsx)(f.A,{items:ee})]})}}}]);