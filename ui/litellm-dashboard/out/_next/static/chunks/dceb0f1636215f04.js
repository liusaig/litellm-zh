(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,596115,e=>{"use strict";var l=e.i(843476),s=e.i(271645),a=e.i(764205),r=e.i(584578),t=e.i(808613),i=e.i(56567),o=e.i(468133),n=e.i(708347),d=e.i(304967),c=e.i(994388),m=e.i(309426),h=e.i(599724),x=e.i(350967),u=e.i(404206),p=e.i(747871),_=e.i(500330),g=e.i(752978),j=e.i(197647),f=e.i(653824),b=e.i(881073),v=e.i(723731),w=e.i(278587);let y=({lastRefreshed:e,onRefresh:s,userRole:a,children:r})=>(0,l.jsxs)(f.TabGroup,{className:"gap-2 h-[75vh] w-full",children:[(0,l.jsxs)(b.TabList,{className:"flex justify-between mt-2 w-full items-center",children:[(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)(j.Tab,{children:"我的分组"}),(0,l.jsx)(j.Tab,{children:"可加入分组"}),(0,n.isAdminRole)(a||"")&&(0,l.jsx)(j.Tab,{children:"默认分组设置"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[e&&(0,l.jsxs)(h.Text,{children:["最近刷新：",e]}),(0,l.jsx)(g.Icon,{icon:w.RefreshIcon,variant:"shadow",size:"xs",className:"self-center",onClick:s})]})]}),(0,l.jsx)(v.TabPanels,{children:r})]});var C=e.i(206929),T=e.i(35983);let N=({filters:e,organizations:s,showFilters:a,onToggleFilters:r,onChange:t,onReset:i})=>(0,l.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,l.jsxs)("div",{className:"relative w-64",children:[(0,l.jsx)("input",{type:"text",placeholder:"按分组名称搜索...",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:e.team_alias,onChange:e=>t("team_alias",e.target.value)}),(0,l.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,l.jsxs)("button",{className:`px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2 ${a?"bg-gray-100":""}`,onClick:()=>r(!a),children:[(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"筛选",(e.team_id||e.team_alias||e.organization_id)&&(0,l.jsx)("span",{"data-testid":"active-filter-indicator",className:"w-2 h-2 rounded-full bg-blue-500"})]}),(0,l.jsxs)("button",{className:"px-3 py-2 text-sm border rounded-md hover:bg-gray-50 flex items-center gap-2",onClick:i,children:[(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"重置筛选"]})]}),a&&(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mt-3",children:[(0,l.jsxs)("div",{className:"relative w-64",children:[(0,l.jsx)("input",{type:"text",placeholder:"输入分组 ID",className:"w-full px-3 py-2 pl-8 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:e.team_id,onChange:e=>t("team_id",e.target.value)}),(0,l.jsx)("svg",{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),(0,l.jsx)("div",{className:"w-64",children:(0,l.jsx)(C.Select,{value:e.organization_id||"",onValueChange:e=>t("organization_id",e),placeholder:"选择组织",children:s?.map(e=>(0,l.jsx)(T.SelectItem,{value:e.organization_id||"",children:e.organization_alias||e.organization_id},e.organization_id))})})]})]});var k=e.i(135214),I=e.i(269200),S=e.i(942232),F=e.i(977572),A=e.i(427612),z=e.i(64848),O=e.i(496020),M=e.i(592968),P=e.i(591935),L=e.i(68155),B=e.i(389083),D=e.i(871943),E=e.i(502547),V=e.i(355619);let R=({team:e})=>{let[a,r]=(0,s.useState)(!1);return(0,l.jsx)(F.TableCell,{style:{maxWidth:"8-x",whiteSpace:"pre-wrap",overflow:"hidden"},className:e.models.length>3?"px-0":"",children:(0,l.jsx)("div",{className:"flex flex-col",children:Array.isArray(e.models)?(0,l.jsx)("div",{className:"flex flex-col",children:0===e.models.length?(0,l.jsx)(B.Badge,{size:"xs",className:"mb-1",color:"red",children:(0,l.jsx)(h.Text,{children:"All Proxy Models"})}):(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex items-start",children:[e.models.length>3&&(0,l.jsx)("div",{children:(0,l.jsx)(g.Icon,{icon:a?D.ChevronDownIcon:E.ChevronRightIcon,className:"cursor-pointer",size:"xs",onClick:()=>{r(e=>!e)}})}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.models.slice(0,3).map((e,s)=>"all-proxy-models"===e?(0,l.jsx)(B.Badge,{size:"xs",color:"red",children:(0,l.jsx)(h.Text,{children:"All Proxy Models"})},s):(0,l.jsx)(B.Badge,{size:"xs",color:"blue",children:(0,l.jsx)(h.Text,{children:e.length>30?`${(0,V.getModelDisplayName)(e).slice(0,30)}...`:(0,V.getModelDisplayName)(e)})},s)),e.models.length>3&&!a&&(0,l.jsx)(B.Badge,{size:"xs",color:"gray",className:"cursor-pointer",children:(0,l.jsxs)(h.Text,{children:["+",e.models.length-3," ",e.models.length-3==1?"more model":"more models"]})}),a&&(0,l.jsx)("div",{className:"flex flex-wrap gap-1",children:e.models.slice(3).map((e,s)=>"all-proxy-models"===e?(0,l.jsx)(B.Badge,{size:"xs",color:"red",children:(0,l.jsx)(h.Text,{children:"All Proxy Models"})},s+3):(0,l.jsx)(B.Badge,{size:"xs",color:"blue",children:(0,l.jsx)(h.Text,{children:e.length>30?`${(0,V.getModelDisplayName)(e).slice(0,30)}...`:(0,V.getModelDisplayName)(e)})},s+3))})]})]})})}):null})})};var H=e.i(918549),H=H,W=e.i(846753),W=W;let $=({team:e,userId:s})=>{var a;let r,t=(a=((e,l)=>{if(!l)return null;let s=e.members_with_roles?.find(e=>e.user_id===l);return s?.role??null})(e,s),r="inline-flex items-center px-2.5 py-0.5 rounded-md text-xs font-medium border","admin"===a?(0,l.jsxs)("span",{className:r,style:{backgroundColor:"#EEF2FF",color:"#3730A3",borderColor:"#C7D2FE"},children:[(0,l.jsx)(H.default,{className:"h-3 w-3 mr-1"}),"Admin"]}):(0,l.jsxs)("span",{className:r,style:{backgroundColor:"#F3F4F6",color:"#4B5563",borderColor:"#E5E7EB"},children:[(0,l.jsx)(W.default,{className:"h-3 w-3 mr-1"}),"Member"]}));return(0,l.jsx)(F.TableCell,{children:t})},J=({teams:e,currentOrg:s,setSelectedTeamId:a,perTeamInfo:r,userRole:t,userId:i,setEditTeam:o,onDeleteTeam:n})=>(0,l.jsxs)(I.Table,{children:[(0,l.jsx)(A.TableHead,{children:(0,l.jsxs)(O.TableRow,{children:[(0,l.jsx)(z.TableHeaderCell,{children:"分组名称"}),(0,l.jsx)(z.TableHeaderCell,{children:"分组 ID"}),(0,l.jsx)(z.TableHeaderCell,{children:"创建时间"}),(0,l.jsx)(z.TableHeaderCell,{children:"花费"}),(0,l.jsx)(z.TableHeaderCell,{children:"预算"}),(0,l.jsx)(z.TableHeaderCell,{children:"模型"}),(0,l.jsx)(z.TableHeaderCell,{children:"组织"}),(0,l.jsx)(z.TableHeaderCell,{children:"你的角色"}),(0,l.jsx)(z.TableHeaderCell,{children:"信息"})]})}),(0,l.jsx)(S.TableBody,{children:e&&e.length>0?e.filter(e=>!s||e.organization_id===s.organization_id).sort((e,l)=>new Date(l.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>(0,l.jsxs)(O.TableRow,{children:[(0,l.jsx)(F.TableCell,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.team_alias}),(0,l.jsx)(F.TableCell,{children:(0,l.jsx)("div",{className:"overflow-hidden",children:(0,l.jsx)(M.Tooltip,{title:e.team_id,children:(0,l.jsxs)(c.Button,{size:"xs",variant:"light",className:"font-mono text-blue-500 bg-blue-50 hover:bg-blue-100 text-xs font-normal px-2 py-0.5 text-left overflow-hidden truncate max-w-[200px]",onClick:()=>{a(e.team_id)},children:[e.team_id.slice(0,7),"..."]})})})}),(0,l.jsx)(F.TableCell,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:e.created_at?new Date(e.created_at).toLocaleDateString():"无"}),(0,l.jsx)(F.TableCell,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:(0,_.formatNumberWithCommas)(e.spend,4)}),(0,l.jsx)(F.TableCell,{style:{maxWidth:"4px",whiteSpace:"pre-wrap",overflow:"hidden"},children:null!==e.max_budget&&void 0!==e.max_budget?e.max_budget:"不限制"}),(0,l.jsx)(R,{team:e}),(0,l.jsx)(F.TableCell,{children:e.organization_id}),(0,l.jsx)($,{team:e,userId:i}),(0,l.jsxs)(F.TableCell,{children:[(0,l.jsxs)(h.Text,{children:[r&&e.team_id&&r[e.team_id]&&r[e.team_id].keys&&r[e.team_id].keys.length," ","个密钥"]}),(0,l.jsxs)(h.Text,{children:[r&&e.team_id&&r[e.team_id]&&r[e.team_id].team_info&&r[e.team_id].team_info.members_with_roles&&r[e.team_id].team_info.members_with_roles.length," ","个成员"]})]}),(0,l.jsx)(F.TableCell,{children:"Admin"==t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(g.Icon,{icon:P.PencilAltIcon,size:"sm",onClick:()=>{a(e.team_id),o(!0)}}),(0,l.jsx)(g.Icon,{onClick:()=>n(e.team_id),icon:L.TrashIcon,size:"sm"})]}):null})]},e.team_id)):null})]});var U=e.i(582458),U=U,G=e.i(995926);let K=({teams:e,teamToDelete:a,onCancel:r,onConfirm:t})=>{let[i,o]=(0,s.useState)(""),n=e?.find(e=>e.team_id===a),d=n?.team_alias||"",c=n?.keys?.length||0,m=i===d;return(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl min-h-[380px] py-6 overflow-hidden transform transition-all flex flex-col justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"删除分组"}),(0,l.jsx)("button",{"aria-label":"关闭",onClick:()=>{r(),o("")},className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:(0,l.jsx)(G.XIcon,{size:20})})]}),(0,l.jsxs)("div",{className:"px-6 py-4",children:[c>0&&(0,l.jsxs)("div",{className:"flex items-start gap-3 p-4 bg-red-50 border border-red-100 rounded-md mb-5",children:[(0,l.jsx)("div",{className:"text-red-500 mt-0.5",children:(0,l.jsx)(U.default,{size:20})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-base font-medium text-red-600",children:["警告：该分组关联了 ",c," 个密钥。"]}),(0,l.jsx)("p",{className:"text-base text-red-600 mt-2",children:"删除分组将同时删除所有关联密钥，此操作不可恢复。"})]})]}),(0,l.jsx)("p",{className:"text-base text-gray-600 mb-5",children:"确认要强制删除该分组及其所有密钥吗？"}),(0,l.jsxs)("div",{className:"mb-5",children:[(0,l.jsxs)("label",{className:"block text-base font-medium text-gray-700 mb-2",children:[`请输入 `,(0,l.jsx)("span",{className:"underline",children:d}),` 以确认删除：`]}),(0,l.jsx)("input",{type:"text",value:i,onChange:e=>o(e.target.value),placeholder:"请准确输入分组名称",className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-base",autoFocus:!0})]})]})]}),(0,l.jsxs)("div",{className:"px-6 py-4 bg-gray-50 flex justify-end gap-4",children:[(0,l.jsx)("button",{onClick:()=>{r(),o("")},className:"px-5 py-3 bg-white border border-gray-300 rounded-md text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"取消"}),(0,l.jsx)("button",{onClick:t,disabled:!m,className:`px-5 py-3 rounded-md text-base font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 ${m?"bg-red-600 hover:bg-red-700":"bg-red-300 cursor-not-allowed"}`,children:"强制删除"})]})]})})};var q=e.i(464571),X=e.i(311451),Q=e.i(212931),Y=e.i(199133),Z=e.i(790848),ee=e.i(677667),el=e.i(130643),es=e.i(898667),ea=e.i(779241),er=e.i(827252),et=e.i(435451),ei=e.i(916940),eo=e.i(75921),en=e.i(552130),ed=e.i(651904),ec=e.i(533882),em=e.i(727749),eh=e.i(390605);let ex=({isTeamModalVisible:e,handleOk:r,handleCancel:i,currentOrg:o,organizations:n,teams:d,setTeams:c,modelAliases:m,setModelAliases:x,loggingSettings:u,setLoggingSettings:p,setIsTeamModalVisible:_})=>{let{userId:g,userRole:j,accessToken:f,premiumUser:b}=(0,k.default)(),[v]=t.Form.useForm(),[w,y]=(0,s.useState)([]),[C,T]=(0,s.useState)(null),[N,I]=(0,s.useState)([]),[S,F]=(0,s.useState)([]),[A,z]=(0,s.useState)([]),[O,P]=(0,s.useState)([]),[L,B]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{try{if(null===g||null===j||null===f)return;let e=await (0,V.fetchAvailableModelsForTeamOrKey)(g,j,f);e&&y(e)}catch(e){console.error("Error fetching user models:",e)}})()},[f,g,j,d]),(0,s.useEffect)(()=>{let e;console.log(`currentOrgForCreateTeam: ${C}`);let l=(e=[],C&&C.models.length>0?(console.log(`organization.models: ${C.models}`),e=C.models):e=w,(0,V.unfurlWildcardModelsInList)(e,w));console.log(`models: ${l}`),I(l),v.setFieldValue("models",[])},[C,w,v]);let D=async()=>{try{if(null==f)return;let e=await (0,a.fetchMCPAccessGroups)(f);P(e)}catch(e){console.error("Failed to fetch MCP access groups:",e)}};(0,s.useEffect)(()=>{D()},[f,D]),(0,s.useEffect)(()=>{let e=async()=>{try{if(null==f)return;let e=(await (0,a.getPoliciesList)(f)).policies.map(e=>e.policy_name);z(e)}catch(e){console.error("Failed to fetch policies:",e)}};(async()=>{try{if(null==f)return;let e=(await (0,a.getGuardrailsList)(f)).guardrails.map(e=>e.guardrail_name);F(e)}catch(e){console.error("Failed to fetch guardrails:",e)}})(),e()},[f]);let E=async e=>{try{if(console.log(`formValues: ${JSON.stringify(e)}`),null!=f){let l=e?.team_alias,s=d?.map(e=>e.team_alias)??[],r=e?.organization_id||o?.organization_id;if(""===r||"string"!=typeof r?e.organization_id=null:e.organization_id=r.trim(),s.includes(l))throw Error(`Team alias ${l} already exists, please pick another alias`);if(em.default.info("正在创建分组"),u.length>0){let l={};if(e.metadata)try{l=JSON.parse(e.metadata)}catch(e){console.warn("Invalid JSON in metadata field, starting with empty object")}l={...l,logging:u.filter(e=>e.callback_name)},e.metadata=JSON.stringify(l)}if(e.secret_manager_settings&&"string"==typeof e.secret_manager_settings)if(""===e.secret_manager_settings.trim())delete e.secret_manager_settings;else try{e.secret_manager_settings=JSON.parse(e.secret_manager_settings)}catch(e){throw Error("Failed to parse secret manager settings: "+e)}if(e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0||e.allowed_mcp_servers_and_groups&&(e.allowed_mcp_servers_and_groups.servers?.length>0||e.allowed_mcp_servers_and_groups.accessGroups?.length>0||e.allowed_mcp_servers_and_groups.toolPermissions)){if(e.object_permission={},e.allowed_vector_store_ids&&e.allowed_vector_store_ids.length>0&&(e.object_permission.vector_stores=e.allowed_vector_store_ids,delete e.allowed_vector_store_ids),e.allowed_mcp_servers_and_groups){let{servers:l,accessGroups:s}=e.allowed_mcp_servers_and_groups;l&&l.length>0&&(e.object_permission.mcp_servers=l),s&&s.length>0&&(e.object_permission.mcp_access_groups=s),delete e.allowed_mcp_servers_and_groups}if(e.mcp_tool_permissions&&Object.keys(e.mcp_tool_permissions).length>0&&(e.object_permission||(e.object_permission={}),e.object_permission.mcp_tool_permissions=e.mcp_tool_permissions,delete e.mcp_tool_permissions),e.allowed_agents_and_groups){let{agents:l,accessGroups:s}=e.allowed_agents_and_groups;e.object_permission||(e.object_permission={}),l&&l.length>0&&(e.object_permission.agents=l),s&&s.length>0&&(e.object_permission.agent_access_groups=s),delete e.allowed_agents_and_groups}}e.allowed_mcp_access_groups&&e.allowed_mcp_access_groups.length>0&&(e.object_permission||(e.object_permission={}),e.object_permission.mcp_access_groups=e.allowed_mcp_access_groups,delete e.allowed_mcp_access_groups),Object.keys(m).length>0&&(e.model_aliases=m);let t=await (0,a.teamCreateCall)(f,e);null!==d?c([...d,t]):c([t]),console.log(`response for team create call: ${t}`),em.default.success("分组创建成功"),v.resetFields(),p([]),x({}),_(!1)}}catch(e){console.error("Error creating the team:",e),em.default.fromBackend("创建分组失败: "+e)}};return(0,l.jsx)(Q.Modal,{title:"创建分组",open:e,width:1e3,footer:null,onOk:r,onCancel:i,children:(0,l.jsxs)(t.Form,{form:v,onFinish:E,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.Form.Item,{label:"分组名称",name:"team_alias",rules:[{required:!0,message:"请输入分组名称"}],children:(0,l.jsx)(ea.TextInput,{placeholder:"请输入名称"})}),(0,l.jsx)(t.Form.Item,{label:(0,l.jsxs)("span",{children:["组织"," ",(0,l.jsx)(M.Tooltip,{title:(0,l.jsxs)("span",{children:["一个组织可以包含多个分组。了解更多请查看"," ",(0,l.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/user_management_heirarchy",target:"_blank",rel:"noopener noreferrer",style:{color:"#1890ff",textDecoration:"underline"},onClick:e=>e.stopPropagation(),children:"用户管理层级"})]}),children:(0,l.jsx)(er.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"organization_id",initialValue:o?o.organization_id:null,className:"mt-8",children:(0,l.jsx)(Y.Select,{showSearch:!0,allowClear:!0,placeholder:"搜索或选择组织",onChange:e=>{v.setFieldValue("organization_id",e),T(n?.find(l=>l.organization_id===e)||null)},filterOption:(e,l)=>!!l&&(l.children?.toString()||"").toLowerCase().includes(e.toLowerCase()),optionFilterProp:"children",children:n?.map(e=>(0,l.jsxs)(Y.Select.Option,{value:e.organization_id,children:[(0,l.jsx)("span",{className:"font-medium",children:e.organization_alias})," ",(0,l.jsxs)("span",{className:"text-gray-500",children:["(",e.organization_id,")"]})]},e.organization_id))})}),(0,l.jsx)(t.Form.Item,{label:(0,l.jsxs)("span",{children:["模型"," ",(0,l.jsx)(M.Tooltip,{title:"这些是当前分组可访问的模型",children:(0,l.jsx)(er.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"models",children:(0,l.jsxs)(Y.Select,{mode:"multiple",placeholder:"选择模型",style:{width:"100%"},children:[(0,l.jsx)(Y.Select.Option,{value:"all-proxy-models",children:"所有代理模型"},"all-proxy-models"),N.map(e=>(0,l.jsx)(Y.Select.Option,{value:e,children:(0,V.getModelDisplayName)(e)},e))]})}),(0,l.jsx)(t.Form.Item,{label:"最大预算",name:"max_budget",children:(0,l.jsx)(et.default,{step:.01,precision:2,width:200,placeholder:"请输入数值"})}),(0,l.jsx)(t.Form.Item,{className:"mt-8",label:"预算重置周期",name:"budget_duration",children:(0,l.jsxs)(Y.Select,{defaultValue:null,placeholder:"不适用",children:[(0,l.jsx)(Y.Select.Option,{value:"24h",children:"每天"}),(0,l.jsx)(Y.Select.Option,{value:"7d",children:"每周"}),(0,l.jsx)(Y.Select.Option,{value:"30d",children:"每月"})]})}),(0,l.jsx)(t.Form.Item,{label:"每分钟 Token 限制 (TPM)",name:"tpm_limit",children:(0,l.jsx)(et.default,{step:1,width:400,placeholder:"请输入数值"})}),(0,l.jsx)(t.Form.Item,{label:"每分钟请求限制 (RPM)",name:"rpm_limit",children:(0,l.jsx)(et.default,{step:1,width:400,placeholder:"请输入数值"})}),(0,l.jsxs)(ee.Accordion,{className:"mt-20 mb-8",onClick:()=>{L||(D(),B(!0))},children:[(0,l.jsx)(es.AccordionHeader,{children:(0,l.jsx)("b",{children:"高级设置"})}),(0,l.jsxs)(el.AccordionBody,{children:[(0,l.jsxs)(ee.Accordion,{className:"mb-4",children:[(0,l.jsx)(es.AccordionHeader,{children:(0,l.jsx)("b",{children:"其他设置"})}),(0,l.jsxs)(el.AccordionBody,{children:[(0,l.jsx)(t.Form.Item,{label:"分组 ID",name:"team_id",help:"要创建的分组 ID，不填则自动生成。",children:(0,l.jsx)(ea.TextInput,{onChange:e=>{e.target.value=e.target.value.trim()}})}),(0,l.jsx)(t.Form.Item,{label:"分组成员预算",name:"team_member_budget",normalize:e=>e?Number(e):void 0,tooltip:"这是该分组内单个成员的预算上限。",children:(0,l.jsx)(et.default,{step:.01,precision:2,width:200,placeholder:"请输入数值"})}),(0,l.jsx)(t.Form.Item,{label:"分组成员密钥时长（如：1d、1mo）",name:"team_member_key_duration",tooltip:"设置分组成员密钥的有效时长。格式：30s（秒）、30m（分钟）、30h（小时）、30d（天）、1mo（月）",children:(0,l.jsx)(ea.TextInput,{placeholder:"例如：30d"})}),(0,l.jsx)(t.Form.Item,{label:"分组成员 RPM 限制",name:"team_member_rpm_limit",tooltip:"分组内单个成员的 RPM（每分钟请求数）限制",children:(0,l.jsx)(et.default,{step:1,width:400,placeholder:"请输入数值"})}),(0,l.jsx)(t.Form.Item,{label:"分组成员 TPM 限制",name:"team_member_tpm_limit",tooltip:"分组内单个成员的 TPM（每分钟 Token 数）限制",children:(0,l.jsx)(et.default,{step:1,width:400,placeholder:"请输入数值"})}),(0,l.jsx)(t.Form.Item,{label:"元数据",name:"metadata",help:"分组附加元数据，请输入 JSON 对象。",children:(0,l.jsx)(X.Input.TextArea,{rows:4})}),(0,l.jsx)(t.Form.Item,{label:"密钥管理器设置",name:"secret_manager_settings",help:b?"请输入密钥管理器配置（JSON 对象）。":"高级功能：升级后可配置密钥管理器设置。",rules:[{validator:async(e,l)=>{if(!l)return Promise.resolve();try{return JSON.parse(l),Promise.resolve()}catch(e){return Promise.reject(Error("请输入有效的 JSON"))}}}],children:(0,l.jsx)(X.Input.TextArea,{rows:4,placeholder:'{"namespace": "admin", "mount": "secret", "path_prefix": "litellm"}',disabled:!b})}),(0,l.jsx)(t.Form.Item,{label:(0,l.jsxs)("span",{children:["护栏"," ",(0,l.jsx)(M.Tooltip,{title:"配置你的第一个护栏",children:(0,l.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/quick_start",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,l.jsx)(er.InfoCircleOutlined,{style:{marginLeft:"4px"}})})})]}),name:"guardrails",className:"mt-8",help:"选择已有护栏或输入新护栏",children:(0,l.jsx)(Y.Select,{mode:"tags",style:{width:"100%"},placeholder:"选择或输入护栏",options:S.map(e=>({value:e,label:e}))})}),(0,l.jsx)(t.Form.Item,{label:(0,l.jsxs)("span",{children:["禁用全局护栏"," ",(0,l.jsx)(M.Tooltip,{title:"开启后，此分组将跳过所有“每次请求都执行”的全局护栏",children:(0,l.jsx)(er.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"disable_global_guardrails",className:"mt-4",valuePropName:"checked",help:"让该分组跳过全局护栏",children:(0,l.jsx)(Z.Switch,{checkedChildren:"是",unCheckedChildren:"否"})}),(0,l.jsx)(t.Form.Item,{label:(0,l.jsxs)("span",{children:["策略"," ",(0,l.jsx)(M.Tooltip,{title:"将策略应用到此分组以控制护栏和其他设置",children:(0,l.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/guardrails/guardrail_policies",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:(0,l.jsx)(er.InfoCircleOutlined,{style:{marginLeft:"4px"}})})})]}),name:"policies",className:"mt-8",help:"选择已有策略或输入新策略",children:(0,l.jsx)(Y.Select,{mode:"tags",style:{width:"100%"},placeholder:"选择或输入策略",options:A.map(e=>({value:e,label:e}))})}),(0,l.jsx)(t.Form.Item,{label:(0,l.jsxs)("span",{children:["可用向量库"," ",(0,l.jsx)(M.Tooltip,{title:"选择该分组默认可访问的向量库。留空表示可访问所有向量库",children:(0,l.jsx)(er.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"allowed_vector_store_ids",className:"mt-8",help:"选择该分组可访问的向量库，留空表示可访问所有向量库",children:(0,l.jsx)(ei.default,{onChange:e=>v.setFieldValue("allowed_vector_store_ids",e),value:v.getFieldValue("allowed_vector_store_ids"),accessToken:f||"",placeholder:"选择向量库（可选）"})})]})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)(ee.Accordion,{className:"mb-4",children:[(0,l.jsx)(es.AccordionHeader,{children:(0,l.jsx)("b",{children:"MCP 设置"})}),(0,l.jsxs)(el.AccordionBody,{children:[(0,l.jsx)(t.Form.Item,{label:(0,l.jsxs)("span",{children:["可用 MCP 服务"," ",(0,l.jsx)(M.Tooltip,{title:"选择该分组可访问的 MCP 服务或访问组",children:(0,l.jsx)(er.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"allowed_mcp_servers_and_groups",className:"mt-4",help:"选择该分组可访问的 MCP 服务或访问组",children:(0,l.jsx)(eo.default,{onChange:e=>v.setFieldValue("allowed_mcp_servers_and_groups",e),value:v.getFieldValue("allowed_mcp_servers_and_groups"),accessToken:f||"",placeholder:"选择 MCP 服务或访问组（可选）"})}),(0,l.jsx)(t.Form.Item,{name:"mcp_tool_permissions",initialValue:{},hidden:!0,children:(0,l.jsx)(X.Input,{type:"hidden"})}),(0,l.jsx)(t.Form.Item,{noStyle:!0,shouldUpdate:(e,l)=>e.allowed_mcp_servers_and_groups!==l.allowed_mcp_servers_and_groups||e.mcp_tool_permissions!==l.mcp_tool_permissions,children:()=>(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsx)(eh.default,{accessToken:f||"",selectedServers:v.getFieldValue("allowed_mcp_servers_and_groups")?.servers||[],toolPermissions:v.getFieldValue("mcp_tool_permissions")||{},onChange:e=>v.setFieldsValue({mcp_tool_permissions:e})})})})]})]}),(0,l.jsxs)(ee.Accordion,{className:"mb-4",children:[(0,l.jsx)(es.AccordionHeader,{children:(0,l.jsx)("b",{children:"智能体设置"})}),(0,l.jsx)(el.AccordionBody,{children:(0,l.jsx)(t.Form.Item,{label:(0,l.jsxs)("span",{children:["可用智能体"," ",(0,l.jsx)(M.Tooltip,{title:"选择该分组可访问的智能体或访问组",children:(0,l.jsx)(er.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"allowed_agents_and_groups",className:"mt-4",help:"选择该分组可访问的智能体或访问组",children:(0,l.jsx)(en.default,{onChange:e=>v.setFieldValue("allowed_agents_and_groups",e),value:v.getFieldValue("allowed_agents_and_groups"),accessToken:f||"",placeholder:"选择智能体或访问组（可选）"})})})]}),(0,l.jsxs)(ee.Accordion,{className:"mb-4",children:[(0,l.jsx)(es.AccordionHeader,{children:(0,l.jsx)("b",{children:"日志设置"})}),(0,l.jsx)(el.AccordionBody,{children:(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)(ed.default,{value:u,onChange:p,premiumUser:b})})})]}),(0,l.jsxs)(ee.Accordion,{className:"mb-0",children:[(0,l.jsx)(es.AccordionHeader,{children:(0,l.jsx)("b",{children:"模型别名"})}),(0,l.jsx)(el.AccordionBody,{children:(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)(h.Text,{className:"text-sm text-gray-600 mb-4",children:"为模型创建可在分组成员 API 调用中使用的自定义别名，从而为特定模型提供快捷调用方式。"}),(0,l.jsx)(ec.default,{accessToken:f||"",initialModelAliases:m,onAliasUpdate:x,showExampleConfig:!1})]})})]})]})]})]})]}),(0,l.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,l.jsx)(q.Button,{htmlType:"submit",children:"创建分组"})})]})})},eu=({teams:e,accessToken:g,setTeams:j,userID:f,userRole:b,organizations:v,premiumUser:w=!1})=>{let[C,T]=(0,s.useState)(null),[I,S]=(0,s.useState)(!1),[F,A]=(0,s.useState)({team_id:"",team_alias:"",organization_id:"",sort_by:"created_at",sort_order:"desc"}),[z]=t.Form.useForm(),[O]=t.Form.useForm(),[M,P]=(0,s.useState)(null),[L,B]=(0,s.useState)(!1),[D,E]=(0,s.useState)(!1),[V,R]=(0,s.useState)(!1),[H,W]=(0,s.useState)(!1),[$,U]=(0,s.useState)([]),[G,q]=(0,s.useState)(!1),[X,Q]=(0,s.useState)(null),[Y,Z]=(0,s.useState)({}),[ee,el]=(0,s.useState)([]),[es,ea]=(0,s.useState)({}),{lastRefreshed:er,onRefreshClick:et}=(({currentOrg:e,setTeams:l})=>{let[a,t]=(0,s.useState)(""),{accessToken:i,userId:o,userRole:n}=(0,k.default)(),d=(0,s.useCallback)(()=>{t(new Date().toLocaleString())},[]);return(0,s.useEffect)(()=>{i&&(0,r.fetchTeams)(i,o,n,e,l).then(),d()},[i,e,a,d,l,o,n]),{lastRefreshed:a,setLastRefreshed:t,onRefreshClick:d}})({currentOrg:C,setTeams:j});(0,s.useEffect)(()=>{e&&Z(e.reduce((e,l)=>(e[l.team_id]={keys:l.keys||[],team_info:{members_with_roles:l.members_with_roles||[]}},e),{}))},[e]);let ei=async e=>{Q(e),q(!0)},eo=async()=>{if(null!=X&&null!=e&&null!=g){try{await (0,a.teamDeleteCall)(g,X),(0,r.fetchTeams)(g,f,b,C,j)}catch(e){console.error("Error deleting the team:",e)}q(!1),Q(null)}};return(0,l.jsx)("div",{className:"w-full mx-4 h-[75vh]",children:(0,l.jsx)(x.Grid,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,l.jsxs)(m.Col,{numColSpan:1,className:"flex flex-col gap-2",children:[("Admin"==b||"Org Admin"==b)&&(0,l.jsx)(c.Button,{className:"w-fit",onClick:()=>E(!0),children:"+ 创建新分组"}),M?(0,l.jsx)(i.default,{teamId:M,onUpdate:e=>{j(l=>{if(null==l)return l;let s=l.map(l=>e.team_id===l.team_id?(0,_.updateExistingKeys)(l,e):l);return g&&(0,r.fetchTeams)(g,f,b,C,j),s})},onClose:()=>{P(null),B(!1)},accessToken:g,is_team_admin:(e=>{if(null==e||null==e.members_with_roles)return!1;for(let l=0;l<e.members_with_roles.length;l++){let s=e.members_with_roles[l];if(s.user_id==f&&"admin"==s.role)return!0}return!1})(e?.find(e=>e.team_id===M)),is_proxy_admin:"Admin"==b,userModels:$,editTeam:L,premiumUser:w}):(0,l.jsxs)(y,{lastRefreshed:er,onRefresh:et,userRole:b,children:[(0,l.jsxs)(u.TabPanel,{children:[(0,l.jsx)(h.Text,{children:"点击 “分组 ID” 可查看分组详情并管理分组成员。"}),(0,l.jsx)(x.Grid,{numItems:1,className:"gap-2 pt-2 pb-2 h-[75vh] w-full mt-2",children:(0,l.jsx)(m.Col,{numColSpan:1,children:(0,l.jsxs)(d.Card,{className:"w-full mx-auto flex-auto overflow-hidden overflow-y-auto max-h-[50vh]",children:[(0,l.jsx)("div",{className:"border-b px-6 py-4",children:(0,l.jsx)("div",{className:"flex flex-col space-y-4",children:(0,l.jsx)(N,{filters:F,organizations:v,showFilters:I,onToggleFilters:S,onChange:(e,l)=>{let s={...F,[e]:l};A(s),g&&(0,a.v2TeamListCall)(g,s.organization_id||null,null,s.team_id||null,s.team_alias||null).then(e=>{e&&e.teams&&j(e.teams)}).catch(e=>{console.error("Error fetching teams:",e)})},onReset:()=>{A({team_id:"",team_alias:"",organization_id:"",sort_by:"created_at",sort_order:"desc"}),g&&(0,a.v2TeamListCall)(g,null,f||null,null,null).then(e=>{e&&e.teams&&j(e.teams)}).catch(e=>{console.error("Error fetching teams:",e)})}})})}),(0,l.jsx)(J,{teams:e,currentOrg:C,perTeamInfo:Y,userRole:b,userId:f,setSelectedTeamId:P,setEditTeam:B,onDeleteTeam:ei}),G&&(0,l.jsx)(K,{teams:e,teamToDelete:X,onCancel:()=>{q(!1),Q(null)},onConfirm:eo})]})})})]}),(0,l.jsx)(u.TabPanel,{children:(0,l.jsx)(p.default,{accessToken:g,userID:f})}),(0,n.isAdminRole)(b||"")&&(0,l.jsx)(u.TabPanel,{children:(0,l.jsx)(o.default,{accessToken:g,userID:f||"",userRole:b||""})})]}),("Admin"==b||"Org Admin"==b)&&(0,l.jsx)(ex,{isTeamModalVisible:D,handleOk:()=>{E(!1),z.resetFields(),el([]),ea({})},handleCancel:()=>{E(!1),z.resetFields(),el([]),ea({})},currentOrg:C,organizations:v,teams:e,setTeams:j,modelAliases:es,setModelAliases:ea,loggingSettings:ee,setLoggingSettings:el,setIsTeamModalVisible:E})]})})})};var ep=e.i(214541),e_=e.i(846835);e.s(["default",0,()=>{let{accessToken:e,userId:a,userRole:r}=(0,k.default)(),{teams:t,setTeams:i}=(0,ep.default)(),[o,n]=(0,s.useState)([]);return(0,s.useEffect)(()=>{(0,e_.fetchOrganizations)(e,n).then(()=>{})},[e]),(0,l.jsx)(eu,{teams:t,accessToken:e,setTeams:i,userID:a,userRole:r,organizations:o})}],596115)}]);