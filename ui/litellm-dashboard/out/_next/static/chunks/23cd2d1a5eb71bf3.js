(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20147,581935,72713,304911,e=>{"use strict";var t=e.i(843476),a=e.i(135214),s=e.i(214541),l=e.i(111110),i=e.i(500330),r=e.i(11751),n=e.i(530212),o=e.i(389083),d=e.i(994388),c=e.i(304967),m=e.i(350967),u=e.i(197647),g=e.i(653824),p=e.i(881073),x=e.i(404206),h=e.i(723731),y=e.i(599724),_=e.i(629569),j=e.i(262218),b=e.i(464571),k=e.i(898586),v=e.i(592968),f=e.i(770914),D=e.i(312361),T=e.i(525720),w=e.i(447566),N=e.i(772345),I=e.i(955135),S=e.i(646563),F=e.i(771674),C=e.i(948401);e.i(247167);var A=e.i(931067),R=e.i(271645);let L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z"}}]},name:"calendar",theme:"outlined"};var B=e.i(9583),E=R.forwardRef(function(e,t){return R.createElement(B.default,(0,A.default)({},e,{ref:t,icon:L}))});e.s(["default",0,E],581935),e.s(["CalendarOutlined",0,E],72713);var O=e.i(637235),V=e.i(962944);let P={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M866.9 169.9L527.1 54.1C523 52.7 517.5 52 512 52s-11 .7-15.1 2.1L157.1 169.9c-8.3 2.8-15.1 12.4-15.1 21.2v482.4c0 8.8 5.7 20.4 12.6 25.9L499.3 968c3.5 2.7 8 4.1 12.6 4.1s9.2-1.4 12.6-4.1l344.7-268.6c6.9-5.4 12.6-17 12.6-25.9V191.1c.2-8.8-6.6-18.3-14.9-21.2zM810 654.3L512 886.5 214 654.3V226.7l298-101.6 298 101.6v427.6zm-405.8-201c-3-4.1-7.8-6.6-13-6.6H336c-6.5 0-10.3 7.4-6.5 12.7l126.4 174a16.1 16.1 0 0026 0l212.6-292.7c3.8-5.3 0-12.7-6.5-12.7h-55.2c-5.1 0-10 2.5-13 6.6L468.9 542.4l-64.7-89.1z"}}]},name:"safety-certificate",theme:"outlined"};var M=R.forwardRef(function(e,t){return R.createElement(B.default,(0,A.default)({},e,{ref:t,icon:P}))});let{Text:K}=k.Typography;function G({userId:e}){let{t:a}=(0,l.useLanguage)();return"default_user_id"===e?(0,t.jsx)(j.Tag,{color:"blue",children:a("memberTable.defaultProxyAdmin")}):(0,t.jsx)(K,{children:e})}e.s(["default",()=>G],304911);let{Text:z}=k.Typography;function U({label:e,value:a,icon:s,truncate:l=!1,copyable:i=!1,defaultUserIdCheck:r=!1}){let n=!a,o=r&&"default_user_id"===a,d=o?(0,t.jsx)(G,{userId:a}):(0,t.jsx)(z,{strong:!0,copyable:!!(i&&!n&&!o)&&{tooltips:[`Copy ${e}`,"Copied!"]},ellipsis:l,style:l?{maxWidth:160,display:"block"}:void 0,children:n?"-":a});return(0,t.jsxs)("div",{children:[(0,t.jsxs)(f.Space,{size:4,children:[(0,t.jsx)(z,{type:"secondary",children:s}),(0,t.jsx)(z,{type:"secondary",style:{fontSize:12,textTransform:"uppercase",letterSpacing:"0.05em"},children:e})]}),(0,t.jsx)("div",{children:d})]})}let{Title:$,Text:W}=k.Typography;function q({data:e,onBack:a,onCreateNew:s,onRegenerate:i,onDelete:r,canModifyKey:n=!0,backButtonText:o="Back to Keys",showRegenerateButton:d=!0,regenerateDisabled:c=!1,regenerateTooltip:m}){let{t:u}=(0,l.useLanguage)();return(0,t.jsxs)("div",{children:[s&&(0,t.jsx)("div",{style:{marginBottom:16},children:(0,t.jsx)(b.Button,{type:"primary",icon:(0,t.jsx)(S.PlusOutlined,{}),onClick:s,children:u("keyDetail.header.createNewKey")})}),(0,t.jsx)("div",{style:{marginBottom:16},children:(0,t.jsx)(b.Button,{type:"text",icon:(0,t.jsx)(w.ArrowLeftOutlined,{}),onClick:a,children:u("keyDetail.header.backToKeys")})}),(0,t.jsxs)(T.Flex,{justify:"space-between",align:"start",style:{marginBottom:20},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)($,{level:3,copyable:{tooltips:[u("keyDetail.header.copyKeyAlias"),u("keyDetail.header.copied")]},style:{margin:0},children:e.keyName}),(0,t.jsxs)(W,{type:"secondary",copyable:{text:e.keyId,tooltips:[u("keyDetail.header.copyKeyId"),u("keyDetail.header.copied")]},children:[u("keyDetail.header.keyIdLabel")," ",e.keyId]})]}),n&&(0,t.jsxs)(f.Space,{children:[d&&(0,t.jsx)(v.Tooltip,{title:m||"",children:(0,t.jsx)("span",{children:(0,t.jsx)(b.Button,{icon:(0,t.jsx)(N.SyncOutlined,{}),onClick:i,disabled:c,children:u("keyDetail.header.regenerateKey")})})}),(0,t.jsx)(b.Button,{danger:!0,icon:(0,t.jsx)(I.DeleteOutlined,{}),onClick:r,children:u("keyDetail.header.deleteKey")})]})]}),(0,t.jsxs)(T.Flex,{align:"stretch",gap:40,style:{marginBottom:40},children:[(0,t.jsxs)(f.Space,{direction:"vertical",size:16,children:[(0,t.jsx)(U,{label:u("keyDetail.header.userEmail"),value:e.userEmail,icon:(0,t.jsx)(C.MailOutlined,{})}),(0,t.jsx)(U,{label:u("keyDetail.header.userId"),value:e.userId,icon:(0,t.jsx)(F.UserOutlined,{}),truncate:!0,copyable:!0,defaultUserIdCheck:!0})]}),(0,t.jsx)(D.Divider,{type:"vertical",style:{height:"auto"}}),(0,t.jsxs)(f.Space,{direction:"vertical",size:16,children:[(0,t.jsx)(U,{label:u("keyDetail.header.createdAt"),value:e.createdAt,icon:(0,t.jsx)(E,{})}),(0,t.jsx)(U,{label:u("keyDetail.header.createdBy"),value:e.createdBy,icon:(0,t.jsx)(M,{}),truncate:!0,copyable:!0,defaultUserIdCheck:!0})]}),(0,t.jsx)(D.Divider,{type:"vertical",style:{height:"auto"}}),(0,t.jsxs)(f.Space,{direction:"vertical",size:16,children:[(0,t.jsx)(U,{label:u("keyDetail.header.lastUpdated"),value:e.lastUpdated,icon:(0,t.jsx)(O.ClockCircleOutlined,{})}),(0,t.jsx)(U,{label:u("keyDetail.header.lastActive"),value:e.lastActive,icon:(0,t.jsx)(V.ThunderboltOutlined,{})})]})]})]})}var H=e.i(708347),J=e.i(557662),Y=e.i(278587);let Q=R.forwardRef(function(e,t){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"}))}),X=({autoRotate:e=!1,rotationInterval:a,lastRotationAt:s,keyRotationAt:i,nextRotationAt:r,variant:n="card",className:d=""})=>{let{t:c}=(0,l.useLanguage)(),m=e=>{let t=new Date(e),a=t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),s=t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return`${a} at ${s}`},u=(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"space-y-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(Y.RefreshIcon,{className:"h-4 w-4 text-blue-600"}),(0,t.jsx)(y.Text,{className:"font-semibold text-gray-900",children:c("keyDetail.autoRotation.title")}),(0,t.jsx)(o.Badge,{color:e?"green":"gray",size:"xs",children:c(e?"keyDetail.autoRotation.enabled":"keyDetail.autoRotation.disabled")}),e&&a&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.Text,{className:"text-gray-400",children:"•"}),(0,t.jsx)(y.Text,{className:"text-sm text-gray-600",children:c("keyDetail.autoRotation.every").replace("{interval}",a)})]})]})}),(e||s||i||r)&&(0,t.jsxs)("div",{className:"space-y-3",children:[s&&(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 border border-gray-200 rounded-md",children:[(0,t.jsx)(Q,{className:"w-4 h-4 text-gray-500"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(y.Text,{className:"font-medium text-gray-700",children:c("keyDetail.autoRotation.lastRotation")}),(0,t.jsx)(y.Text,{className:"text-sm text-gray-600",children:m(s)})]})]}),(i||r)&&(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 border border-gray-200 rounded-md",children:[(0,t.jsx)(Q,{className:"w-4 h-4 text-gray-500"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(y.Text,{className:"font-medium text-gray-700",children:c("keyDetail.autoRotation.nextScheduledRotation")}),(0,t.jsx)(y.Text,{className:"text-sm text-gray-600",children:m(r||i||"")})]})]}),e&&!s&&!i&&!r&&(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 border border-gray-100 rounded-md",children:[(0,t.jsx)(Q,{className:"w-4 h-4 text-gray-500"}),(0,t.jsx)(y.Text,{className:"text-gray-600",children:c("keyDetail.autoRotation.noHistory")})]})]}),!e&&!s&&!i&&!r&&(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 border border-gray-100 rounded-md",children:[(0,t.jsx)(Y.RefreshIcon,{className:"w-4 h-4 text-gray-400"}),(0,t.jsx)(y.Text,{className:"text-gray-600",children:c("keyDetail.autoRotation.notEnabled")})]})]});return"card"===n?(0,t.jsxs)("div",{className:`bg-white border border-gray-200 rounded-lg p-6 ${d}`,children:[(0,t.jsx)("div",{className:"flex items-center gap-2 mb-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-semibold text-gray-900",children:c("keyDetail.autoRotation.title")}),(0,t.jsx)(y.Text,{className:"text-xs text-gray-500",children:c("keyDetail.autoRotation.description")})]})}),u]}):(0,t.jsxs)("div",{className:`${d}`,children:[(0,t.jsx)(y.Text,{className:"font-medium text-gray-900 mb-3",children:c("keyDetail.autoRotation.title")}),u]})};var Z=e.i(127952);let ee=["logging"],et=e=>e&&"object"==typeof e&&Array.isArray(e.logging)?e.logging:[],ea=(e,t=2)=>JSON.stringify(e&&"object"==typeof e?Object.fromEntries(Object.entries(e).filter(([e])=>!ee.includes(e))):{},null,t),es=e=>{if(!e||"object"!=typeof e)return e;let{tags:t,...a}=e;return a};var el=e.i(643449),ei=e.i(727749),er=e.i(764205),en=e.i(384767),eo=e.i(309426),ed=e.i(779241),ec=e.i(808613),em=e.i(28651),eu=e.i(212931),eg=e.i(439189),ep=e.i(497245),ex=e.i(96226),eh=e.i(435684);function ey(e,t){let{years:a=0,months:s=0,weeks:l=0,days:i=0,hours:r=0,minutes:n=0,seconds:o=0}=t,d=(0,eh.toDate)(e),c=s||a?(0,ep.addMonths)(d,s+12*a):d,m=i||l?(0,eg.addDays)(c,i+7*l):c;return(0,ex.constructFrom)(e,m.getTime()+1e3*(o+60*(n+60*r)))}var e_=e.i(237016);function ej({selectedToken:e,visible:s,onClose:l,onKeyUpdate:i}){let{accessToken:r}=(0,a.default)(),[n]=ec.Form.useForm(),[o,c]=(0,R.useState)(null),[u,g]=(0,R.useState)(null),[p,x]=(0,R.useState)(null),[h,j]=(0,R.useState)(!1),[b,k]=(0,R.useState)(!1),[v,f]=(0,R.useState)(null);(0,R.useEffect)(()=>{s&&e&&r&&(n.setFieldsValue({key_alias:e.key_alias,max_budget:e.max_budget,tpm_limit:e.tpm_limit,rpm_limit:e.rpm_limit,duration:e.duration||"",grace_period:""}),f(r),k(e.key_name===r))},[s,e,n,r]),(0,R.useEffect)(()=>{s||(c(null),j(!1),k(!1),f(null),n.resetFields())},[s,n]);let D=e=>{if(!e)return null;try{let t,a=new Date;if(e.endsWith("s"))t=ey(a,{seconds:parseInt(e)});else if(e.endsWith("h"))t=ey(a,{hours:parseInt(e)});else if(e.endsWith("d"))t=ey(a,{days:parseInt(e)});else throw Error("Invalid duration format");return t.toLocaleString()}catch(e){return null}};(0,R.useEffect)(()=>{u?.duration?x(D(u.duration)):x(null)},[u?.duration]);let T=async()=>{if(e&&v){j(!0);try{let t=await n.validateFields(),a=await (0,er.regenerateKeyCall)(v,e.token||e.token_id,t);c(a.key),ei.default.success("Virtual Key regenerated successfully"),console.log("Full regenerate response:",a);let s={token:a.token||a.key_id||e.token,key_name:a.key,max_budget:t.max_budget,tpm_limit:t.tpm_limit,rpm_limit:t.rpm_limit,expires:t.duration?D(t.duration):e.expires,...a};console.log("Updated key data with new token:",s),i&&i(s),j(!1)}catch(e){console.error("Error regenerating key:",e),ei.default.fromBackend(e),j(!1)}}},w=()=>{c(null),j(!1),k(!1),f(null),n.resetFields(),l()};return(0,t.jsx)(eu.Modal,{title:"Regenerate Virtual Key",open:s,onCancel:w,footer:o?[(0,t.jsx)(d.Button,{onClick:w,children:"Close"},"close")]:[(0,t.jsx)(d.Button,{onClick:w,className:"mr-2",children:"Cancel"},"cancel"),(0,t.jsx)(d.Button,{onClick:T,disabled:h,children:h?"Regenerating...":"Regenerate"},"regenerate")],children:o?(0,t.jsxs)(m.Grid,{numItems:1,className:"gap-2 w-full",children:[(0,t.jsx)(_.Title,{children:"Regenerated Key"}),(0,t.jsx)(eo.Col,{numColSpan:1,children:(0,t.jsxs)("p",{children:["Please replace your old key with the new key generated. For security reasons,"," ",(0,t.jsx)("b",{children:"you will not be able to view it again"})," through your Silinex account. If you lose this secret key, you will need to generate a new one."]})}),(0,t.jsxs)(eo.Col,{numColSpan:1,children:[(0,t.jsx)(y.Text,{className:"mt-3",children:"Key Alias:"}),(0,t.jsx)("div",{className:"bg-gray-100 p-2 rounded mb-2",children:(0,t.jsx)("pre",{className:"break-words whitespace-normal",children:e?.key_alias||"No alias set"})}),(0,t.jsx)(y.Text,{className:"mt-3",children:"New Virtual Key:"}),(0,t.jsx)("div",{className:"bg-gray-100 p-2 rounded mb-2",children:(0,t.jsx)("pre",{className:"break-words whitespace-normal",children:o})}),(0,t.jsx)(e_.CopyToClipboard,{text:o,onCopy:()=>ei.default.success("Virtual Key copied to clipboard"),children:(0,t.jsx)(d.Button,{className:"mt-3",children:"Copy Virtual Key"})})]})]}):(0,t.jsxs)(ec.Form,{form:n,layout:"vertical",onValuesChange:e=>{"duration"in e&&g(t=>({...t,duration:e.duration}))},children:[(0,t.jsx)(ec.Form.Item,{name:"key_alias",label:"Key Alias",children:(0,t.jsx)(ed.TextInput,{disabled:!0})}),(0,t.jsx)(ec.Form.Item,{name:"max_budget",label:"最大预算",children:(0,t.jsx)(em.InputNumber,{step:.01,precision:2,style:{width:"100%"}})}),(0,t.jsx)(ec.Form.Item,{name:"tpm_limit",label:"TPM Limit",children:(0,t.jsx)(em.InputNumber,{style:{width:"100%"}})}),(0,t.jsx)(ec.Form.Item,{name:"rpm_limit",label:"RPM Limit",children:(0,t.jsx)(em.InputNumber,{style:{width:"100%"}})}),(0,t.jsx)(ec.Form.Item,{name:"duration",label:"Expire Key (eg: 30s, 30h, 30d)",className:"mt-8",children:(0,t.jsx)(ed.TextInput,{placeholder:""})}),(0,t.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Current expiry: ",e?.expires?new Date(e.expires).toLocaleString():"Never"]}),p&&(0,t.jsxs)("div",{className:"mt-2 text-sm text-green-600",children:["New expiry: ",p]}),(0,t.jsx)(ec.Form.Item,{name:"grace_period",label:"Grace Period (eg: 24h, 2d)",tooltip:"Keep the old key valid for this duration after rotation. Both keys work during this period for seamless cutover. Empty = immediate revoke.",className:"mt-8",rules:[{pattern:/^(\d+(s|m|h|d|w|mo))?$/,message:"Must be a duration like 30s, 30m, 24h, 2d, 1w, or 1mo"}],children:(0,t.jsx)(ed.TextInput,{placeholder:"e.g. 24h, 2d (empty = immediate revoke)"})}),(0,t.jsx)("div",{className:"mt-2 text-sm text-gray-500",children:"Recommended: 24h to 72h for production keys to allow seamless client migration."})]})})}var eb=e.i(190702),ek=e.i(891547),ev=e.i(921511),ef=e.i(827252),eD=e.i(311451),eT=e.i(199133),ew=e.i(790848),eN=e.i(552130),eI=e.i(9314),eS=e.i(392110),eF=e.i(844565),eC=e.i(939510),eA=e.i(75921),eR=e.i(390605),eL=e.i(702597),eB=e.i(435451),eE=e.i(183588),eO=e.i(916940);function eV({keyData:e,onCancel:a,onSubmit:s,teams:i,accessToken:r,userID:n,userRole:o,premiumUser:c=!1}){let{t:m}=(0,l.useLanguage)(),[u]=ec.Form.useForm(),[g,p]=(0,R.useState)([]),[x,h]=(0,R.useState)({}),y=i?.find(t=>t.team_id===e.team_id),[_,j]=(0,R.useState)([]),[b,k]=(0,R.useState)(Array.isArray(e.metadata?.litellm_disabled_callbacks)?(0,J.mapInternalToDisplayNames)(e.metadata.litellm_disabled_callbacks):[]),[f,D]=(0,R.useState)(e.auto_rotate||!1),[T,w]=(0,R.useState)(e.rotation_interval||""),[N,I]=(0,R.useState)(!1);(0,R.useEffect)(()=>{let t=async()=>{if(n&&o&&r)try{if(null===e.team_id){let e=(await (0,er.modelAvailableCall)(r,n,o)).data.map(e=>e.id);j(e)}else if(y?.team_id){let e=await (0,eL.fetchTeamModels)(n,o,r,y.team_id);j(Array.from(new Set([...y.models,...e])))}}catch(e){console.error("Error fetching models:",e)}};(async()=>{if(r)try{let e=await (0,er.getPromptsList)(r);p(e.prompts.map(e=>e.prompt_id))}catch(e){console.error("Failed to fetch prompts:",e)}})(),t()},[n,o,r,y,e.team_id]),(0,R.useEffect)(()=>{u.setFieldValue("disabled_callbacks",b)},[u,b]);let S=e=>e&&({"24h":"daily","7d":"weekly","30d":"monthly"})[e]||null,F={...e,token:e.token||e.token_id,budget_duration:S(e.budget_duration),metadata:ea(es(e.metadata)),guardrails:e.metadata?.guardrails,disable_global_guardrails:e.metadata?.disable_global_guardrails||!1,prompts:e.metadata?.prompts,tags:e.metadata?.tags,vector_stores:e.object_permission?.vector_stores||[],mcp_servers_and_groups:{servers:e.object_permission?.mcp_servers||[],accessGroups:e.object_permission?.mcp_access_groups||[]},mcp_tool_permissions:e.object_permission?.mcp_tool_permissions||{},agents_and_groups:{agents:e.object_permission?.agents||[],accessGroups:e.object_permission?.agent_access_groups||[]},logging_settings:et(e.metadata),disabled_callbacks:Array.isArray(e.metadata?.litellm_disabled_callbacks)?(0,J.mapInternalToDisplayNames)(e.metadata.litellm_disabled_callbacks):[],access_group_ids:e.access_group_ids||[],auto_rotate:e.auto_rotate||!1,...e.rotation_interval&&{rotation_interval:e.rotation_interval},allowed_routes:Array.isArray(e.allowed_routes)&&e.allowed_routes.length>0?e.allowed_routes.join(", "):""};(0,R.useEffect)(()=>{u.setFieldsValue({...e,token:e.token||e.token_id,budget_duration:S(e.budget_duration),metadata:ea(es(e.metadata)),guardrails:e.metadata?.guardrails,disable_global_guardrails:e.metadata?.disable_global_guardrails||!1,prompts:e.metadata?.prompts,tags:e.metadata?.tags,vector_stores:e.object_permission?.vector_stores||[],mcp_servers_and_groups:{servers:e.object_permission?.mcp_servers||[],accessGroups:e.object_permission?.mcp_access_groups||[]},mcp_tool_permissions:e.object_permission?.mcp_tool_permissions||{},logging_settings:et(e.metadata),disabled_callbacks:Array.isArray(e.metadata?.litellm_disabled_callbacks)?(0,J.mapInternalToDisplayNames)(e.metadata.litellm_disabled_callbacks):[],access_group_ids:e.access_group_ids||[],auto_rotate:e.auto_rotate||!1,...e.rotation_interval&&{rotation_interval:e.rotation_interval},allowed_routes:Array.isArray(e.allowed_routes)&&e.allowed_routes.length>0?e.allowed_routes.join(", "):""})},[e,u]),(0,R.useEffect)(()=>{u.setFieldValue("auto_rotate",f)},[f,u]),(0,R.useEffect)(()=>{T&&u.setFieldValue("rotation_interval",T)},[T,u]),(0,R.useEffect)(()=>{(async()=>{if(r)try{let e=await (0,er.tagListCall)(r);h(e)}catch(e){ei.default.fromBackend("Error fetching tags: "+e)}})()},[r]);let C=async e=>{try{if(I(!0),"string"==typeof e.allowed_routes){let t=e.allowed_routes.trim();""===t?e.allowed_routes=[]:e.allowed_routes=t.split(",").map(e=>e.trim()).filter(e=>e.length>0)}await s(e)}finally{I(!1)}};return(0,t.jsxs)(ec.Form,{form:u,onFinish:C,initialValues:F,layout:"vertical",children:[(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.keyAlias"),name:"key_alias",children:(0,t.jsx)(ed.TextInput,{})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.models"),name:"models",children:(0,t.jsx)(ec.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.allowed_routes!==t.allowed_routes||e.models!==t.models,children:({getFieldValue:e,setFieldValue:a})=>{let s=e("allowed_routes")||"",l="string"==typeof s&&""!==s.trim()?s.split(",").map(e=>e.trim()).filter(e=>e.length>0):[],i=l.includes("management_routes")||l.includes("info_routes"),r=e("models")||[];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(eT.Select,{mode:"multiple",placeholder:m("keyDetail.settings.placeholders.selectModels"),style:{width:"100%"},disabled:i,value:i?[]:r,onChange:e=>a("models",e),children:[_.length>0&&(0,t.jsx)(eT.Select.Option,{value:"all-team-models",children:m("keyDetail.settings.messages.allTeamModels")}),_.map(e=>(0,t.jsx)(eT.Select.Option,{value:e,children:e},e))]}),i&&(0,t.jsx)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:m("keyDetail.settings.messages.modelsFieldDisabled")})]})}})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.keyType"),children:(0,t.jsx)(ec.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.allowed_routes!==t.allowed_routes,children:({getFieldValue:e,setFieldValue:a})=>{var s;let l=e("allowed_routes")||"",i=(s="string"==typeof l&&""!==l.trim()?l.split(",").map(e=>e.trim()).filter(e=>e.length>0):[])&&0!==s.length?s.includes("llm_api_routes")?"llm_api":s.includes("management_routes")?"management":s.includes("info_routes")?"read_only":"default":"default";return(0,t.jsxs)(eT.Select,{placeholder:m("keyDetail.settings.placeholders.selectKeyType"),style:{width:"100%"},optionLabelProp:"label",value:i,onChange:e=>{switch(e){case"default":a("allowed_routes","");break;case"llm_api":a("allowed_routes","llm_api_routes");break;case"management":a("allowed_routes","management_routes"),a("models",[])}},children:[(0,t.jsx)(eT.Select.Option,{value:"default",label:m("keyDetail.settings.keyTypes.default.value"),children:(0,t.jsxs)("div",{style:{padding:"4px 0"},children:[(0,t.jsx)("div",{style:{fontWeight:500},children:m("keyDetail.settings.keyTypes.default.value")}),(0,t.jsx)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:m("keyDetail.settings.keyTypes.default.description")})]})}),(0,t.jsx)(eT.Select.Option,{value:"llm_api",label:m("keyDetail.settings.keyTypes.llmApi.value"),children:(0,t.jsxs)("div",{style:{padding:"4px 0"},children:[(0,t.jsx)("div",{style:{fontWeight:500},children:m("keyDetail.settings.keyTypes.llmApi.value")}),(0,t.jsx)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:m("keyDetail.settings.keyTypes.llmApi.description")})]})}),(0,t.jsx)(eT.Select.Option,{value:"management",label:m("keyDetail.settings.keyTypes.management.value"),children:(0,t.jsxs)("div",{style:{padding:"4px 0"},children:[(0,t.jsx)("div",{style:{fontWeight:500},children:m("keyDetail.settings.keyTypes.management.value")}),(0,t.jsx)("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:m("keyDetail.settings.keyTypes.management.description")})]})})]})}})}),(0,t.jsx)(ec.Form.Item,{label:(0,t.jsxs)("span",{children:[m("keyDetail.settings.allowedRoutes")," ",(0,t.jsx)(v.Tooltip,{title:m("keyDetail.settings.placeholders.allowedRoutesTooltip"),children:(0,t.jsx)(ef.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"allowed_routes",children:(0,t.jsx)(eD.Input,{placeholder:m("keyDetail.settings.placeholders.allowedRoutesPlaceholder")})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.maxBudget"),name:"max_budget",children:(0,t.jsx)(eB.default,{step:.01,style:{width:"100%"},placeholder:m("keyDetail.settings.placeholders.enterNumericalValue")})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.resetBudget"),name:"budget_duration",children:(0,t.jsxs)(eT.Select,{placeholder:m("keyDetail.settings.placeholders.na"),children:[(0,t.jsx)(eT.Select.Option,{value:"daily",children:m("keyDetail.settings.budgetDuration.daily")}),(0,t.jsx)(eT.Select.Option,{value:"weekly",children:m("keyDetail.settings.budgetDuration.weekly")}),(0,t.jsx)(eT.Select.Option,{value:"monthly",children:m("keyDetail.settings.budgetDuration.monthly")})]})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.tpmLimit"),name:"tpm_limit",children:(0,t.jsx)(eB.default,{min:0})}),(0,t.jsx)(eC.default,{type:"tpm",name:"tpm_limit_type",showDetailedDescriptions:!1}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.rpmLimit"),name:"rpm_limit",children:(0,t.jsx)(eB.default,{min:0})}),(0,t.jsx)(eC.default,{type:"rpm",name:"rpm_limit_type",showDetailedDescriptions:!1}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.maxParallelRequests"),name:"max_parallel_requests",children:(0,t.jsx)(eB.default,{min:0})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.modelTpmLimits"),name:"model_tpm_limit",children:(0,t.jsx)(eD.Input.TextArea,{rows:4,placeholder:'{"gpt-4": 100, "claude-v1": 200}'})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.modelRpmLimits"),name:"model_rpm_limit",children:(0,t.jsx)(eD.Input.TextArea,{rows:4,placeholder:'{"gpt-4": 100, "claude-v1": 200}'})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.guardrails"),name:"guardrails",children:r&&(0,t.jsx)(ek.default,{onChange:e=>{u.setFieldValue("guardrails",e)},accessToken:r,disabled:!c})}),(0,t.jsx)(ec.Form.Item,{label:(0,t.jsxs)("span",{children:[m("keyDetail.settings.disableGlobalGuardrailsLabel")," ",(0,t.jsx)(v.Tooltip,{title:m("keyDetail.settings.disableGlobalGuardrailsTooltip"),children:(0,t.jsx)(ef.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"disable_global_guardrails",valuePropName:"checked",children:(0,t.jsx)(ew.Switch,{disabled:!c,checkedChildren:"Yes",unCheckedChildren:"No"})}),(0,t.jsx)(ec.Form.Item,{label:(0,t.jsxs)("span",{children:[m("keyDetail.settings.policies")," ",(0,t.jsx)(v.Tooltip,{title:m("keyDetail.settings.policiesTooltip"),children:(0,t.jsx)(ef.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"policies",children:r&&(0,t.jsx)(ev.default,{onChange:e=>{u.setFieldValue("policies",e)},accessToken:r,disabled:!c})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.tags"),name:"tags",children:(0,t.jsx)(eT.Select,{mode:"tags",style:{width:"100%"},placeholder:m("keyDetail.settings.placeholders.selectTags"),options:Object.values(x).map(e=>({value:e.name,label:e.name,title:e.description||e.name}))})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.prompts"),name:"prompts",children:(0,t.jsx)(v.Tooltip,{title:c?"":m("keyDetail.settings.features.upgradeForPrompts"),placement:"top",children:(0,t.jsx)(eT.Select,{mode:"tags",style:{width:"100%"},disabled:!c,placeholder:c?Array.isArray(e.metadata?.prompts)&&e.metadata.prompts.length>0?`Current: ${e.metadata.prompts.join(", ")}`:m("keyDetail.settings.placeholders.selectPrompts"):m("keyDetail.settings.features.upgradeForPrompts"),options:g.map(e=>({value:e,label:e}))})})}),(0,t.jsx)(ec.Form.Item,{label:(0,t.jsxs)("span",{children:[m("keyDetail.settings.accessGroups")," ",(0,t.jsx)(v.Tooltip,{title:m("keyDetail.settings.accessGroupsTooltip"),children:(0,t.jsx)(ef.InfoCircleOutlined,{style:{marginLeft:"4px"}})})]}),name:"access_group_ids",children:(0,t.jsx)(eI.default,{placeholder:m("keyDetail.settings.placeholders.selectAccessGroups")})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.allowedPassThroughRoutesLabel"),name:"allowed_passthrough_routes",children:(0,t.jsx)(v.Tooltip,{title:c?"":m("keyDetail.settings.features.upgradeForPassThrough"),placement:"top",children:(0,t.jsx)(eF.default,{onChange:e=>u.setFieldValue("allowed_passthrough_routes",e),value:u.getFieldValue("allowed_passthrough_routes"),accessToken:r||"",placeholder:c?Array.isArray(e.metadata?.allowed_passthrough_routes)&&e.metadata.allowed_passthrough_routes.length>0?`Current: ${e.metadata.allowed_passthrough_routes.join(", ")}`:m("keyDetail.settings.placeholders.selectTags"):m("keyDetail.settings.features.upgradeForPassThrough"),disabled:!c})})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.vectorStores"),name:"vector_stores",children:(0,t.jsx)(eO.default,{onChange:e=>u.setFieldValue("vector_stores",e),value:u.getFieldValue("vector_stores"),accessToken:r||"",placeholder:m("keyDetail.settings.placeholders.selectVectorStores")})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.mcpServers"),name:"mcp_servers_and_groups",children:(0,t.jsx)(eA.default,{onChange:e=>u.setFieldValue("mcp_servers_and_groups",e),value:u.getFieldValue("mcp_servers_and_groups"),accessToken:r||"",placeholder:m("keyDetail.settings.placeholders.selectMcpServers")})}),(0,t.jsx)(ec.Form.Item,{name:"mcp_tool_permissions",initialValue:{},hidden:!0,children:(0,t.jsx)(eD.Input,{type:"hidden"})}),(0,t.jsx)(ec.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.mcp_servers_and_groups!==t.mcp_servers_and_groups||e.mcp_tool_permissions!==t.mcp_tool_permissions,children:()=>(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)(eR.default,{accessToken:r||"",selectedServers:u.getFieldValue("mcp_servers_and_groups")?.servers||[],toolPermissions:u.getFieldValue("mcp_tool_permissions")||{},onChange:e=>u.setFieldsValue({mcp_tool_permissions:e})})})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.agents"),name:"agents_and_groups",children:(0,t.jsx)(eN.default,{onChange:e=>u.setFieldValue("agents_and_groups",e),value:u.getFieldValue("agents_and_groups"),accessToken:r||"",placeholder:m("keyDetail.settings.placeholders.selectAgents")})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.teamId"),name:"team_id",children:(0,t.jsx)(eT.Select,{placeholder:m("keyDetail.settings.placeholders.selectTeam"),showSearch:!0,style:{width:"100%"},filterOption:(e,t)=>{let a=i?.find(e=>e.team_id===t?.value);return!!a&&(a.team_alias?.toLowerCase().includes(e.toLowerCase())??!1)},children:i?.map(e=>(0,t.jsx)(eT.Select.Option,{value:e.team_id,children:`${e.team_alias} (${e.team_id})`},e.team_id))})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.loggingSettings"),name:"logging_settings",children:(0,t.jsx)(eE.default,{value:u.getFieldValue("logging_settings"),onChange:e=>u.setFieldValue("logging_settings",e),disabledCallbacks:b,onDisabledCallbacksChange:e=>{k((0,J.mapInternalToDisplayNames)(e)),u.setFieldValue("disabled_callbacks",e)}})}),(0,t.jsx)(ec.Form.Item,{label:m("keyDetail.settings.metadataLabel"),name:"metadata",children:(0,t.jsx)(eD.Input.TextArea,{rows:10})}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)(eS.default,{form:u,autoRotationEnabled:f,onAutoRotationChange:D,rotationInterval:T,onRotationIntervalChange:w}),(0,t.jsx)(ec.Form.Item,{name:"duration",hidden:!0,initialValue:"",children:(0,t.jsx)(eD.Input,{})})]}),(0,t.jsx)(ec.Form.Item,{name:"token",hidden:!0,children:(0,t.jsx)(eD.Input,{})}),(0,t.jsx)(ec.Form.Item,{name:"disabled_callbacks",hidden:!0,children:(0,t.jsx)(eD.Input,{})}),(0,t.jsx)(ec.Form.Item,{name:"auto_rotate",hidden:!0,children:(0,t.jsx)(eD.Input,{})}),(0,t.jsx)(ec.Form.Item,{name:"rotation_interval",hidden:!0,children:(0,t.jsx)(eD.Input,{})}),(0,t.jsx)("div",{className:"sticky z-10 bg-white p-4 border-t border-gray-200 bottom-[-1.5rem] inset-x-[-1.5rem]",children:(0,t.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,t.jsx)(d.Button,{variant:"secondary",onClick:a,disabled:N,children:m("keyDetail.settings.button.cancel")}),(0,t.jsx)(d.Button,{type:"submit",loading:N,children:m("keyDetail.settings.button.saveChanges")})]})})]})}var eP=e.i(355619);function eM({onClose:e,keyData:b,teams:k,onKeyDataUpdate:v,onDelete:f,backButtonText:D}){let{accessToken:T,userId:w,userRole:N,premiumUser:I}=(0,a.default)(),{t:S}=(0,l.useLanguage)(),F=e=>"all-team-models"===e?S("keyDetail.settings.messages.allTeamModels").replace("团队","分组"):"all-proxy-models"===e?S("teams.allProxyModels"):(0,eP.getModelDisplayName)(e),{teams:C}=(0,s.default)(),[A,L]=(0,R.useState)(!1),[B,E]=(0,R.useState)(!1),[O,V]=(0,R.useState)(!1),[P,M]=(0,R.useState)(""),[K,G]=(0,R.useState)(!1),[z,U]=(0,R.useState)(b),[$,W]=(0,R.useState)(null),[Y,Q]=(0,R.useState)(!1),[ee,eo]=(0,R.useState)({}),[ed,ec]=(0,R.useState)(!1);if((0,R.useEffect)(()=>{b&&U(b)},[b]),(0,R.useEffect)(()=>{(async()=>{let e=z?.metadata?.policies;if(!T||!e||!Array.isArray(e)||0===e.length)return;ec(!0);let t={};try{await Promise.all(e.map(async e=>{try{let a=await (0,er.getPolicyInfoWithGuardrails)(T,e);t[e]=a.resolved_guardrails||[]}catch(a){console.error(`Failed to fetch guardrails for policy ${e}:`,a),t[e]=[]}})),eo(t)}catch(e){console.error("Failed to fetch policy guardrails:",e)}finally{ec(!1)}})()},[T,z?.metadata?.policies]),(0,R.useEffect)(()=>{if(Y){let e=setTimeout(()=>{Q(!1)},5e3);return()=>clearTimeout(e)}},[Y]),!z)return(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)(d.Button,{icon:n.ArrowLeftIcon,variant:"light",onClick:e,className:"mb-4",children:D}),(0,t.jsx)(y.Text,{children:S("keyDetail.notFound")})]});let em=((k&&k.length>0?k:C)||[]).find(e=>e?.team_id===z.team_id),eu=em?.team_alias||em?.team_name||em?.alias,eg=async e=>{try{if(!T)return;let t=e.token;if(e.key=t,I||(delete e.guardrails,delete e.prompts),e.max_budget=(0,r.mapEmptyStringToNull)(e.max_budget),void 0!==e.vector_stores&&(e.object_permission={...z.object_permission,vector_stores:e.vector_stores||[]},delete e.vector_stores),void 0!==e.mcp_servers_and_groups){let{servers:t,accessGroups:a}=e.mcp_servers_and_groups||{servers:[],accessGroups:[]};e.object_permission={...z.object_permission,mcp_servers:t||[],mcp_access_groups:a||[]},delete e.mcp_servers_and_groups}if(void 0!==e.mcp_tool_permissions){let t=e.mcp_tool_permissions||{};Object.keys(t).length>0&&(e.object_permission={...e.object_permission,mcp_tool_permissions:t}),delete e.mcp_tool_permissions}if(void 0!==e.agents_and_groups){let{agents:t,accessGroups:a}=e.agents_and_groups||{agents:[],accessGroups:[]};e.object_permission={...e.object_permission,agents:t||[],agent_access_groups:a||[]},delete e.agents_and_groups}if(e.max_budget=(0,r.mapEmptyStringToNull)(e.max_budget),e.tpm_limit=(0,r.mapEmptyStringToNull)(e.tpm_limit),e.rpm_limit=(0,r.mapEmptyStringToNull)(e.rpm_limit),e.max_parallel_requests=(0,r.mapEmptyStringToNull)(e.max_parallel_requests),e.metadata&&"string"==typeof e.metadata)try{let t=JSON.parse(e.metadata);"tags"in t&&delete t.tags,e.metadata={...t,...Array.isArray(e.tags)&&e.tags.length>0?{tags:e.tags}:{},...e.guardrails?.length>0?{guardrails:e.guardrails}:{},...Array.isArray(e.logging_settings)&&e.logging_settings.length>0?{logging:e.logging_settings}:{},...e.disabled_callbacks?.length>0?{litellm_disabled_callbacks:(0,J.mapDisplayToInternalNames)(e.disabled_callbacks)}:{}}}catch(e){console.error("Error parsing metadata JSON:",e),ei.default.error("Invalid metadata JSON");return}else{let{tags:t,...a}=e.metadata||{};e.metadata={...a,...Array.isArray(e.tags)&&e.tags.length>0?{tags:e.tags}:{},...e.guardrails?.length>0?{guardrails:e.guardrails}:{},...Array.isArray(e.logging_settings)&&e.logging_settings.length>0?{logging:e.logging_settings}:{},...e.disabled_callbacks?.length>0?{litellm_disabled_callbacks:(0,J.mapDisplayToInternalNames)(e.disabled_callbacks)}:{}}}"tags"in e&&delete e.tags,delete e.logging_settings,e.budget_duration&&(e.budget_duration=({daily:"24h",weekly:"7d",monthly:"30d"})[e.budget_duration]);let a=await (0,er.keyUpdateCall)(T,e);U(e=>e?{...e,...a}:void 0),v&&v(a),ei.default.success(S("keyDetail.notifications.updateSuccess")),L(!1)}catch(e){ei.default.fromBackend((0,eb.parseErrorMessage)(e)),console.error("Error updating key:",e)}},ep=async()=>{try{if(V(!0),!T)return;await (0,er.keyDeleteCall)(T,z.token||z.token_id),ei.default.success(S("keyDetail.notifications.deleteSuccess")),f&&f(),e()}catch(e){console.error("Error deleting the key:",e),ei.default.fromBackend(e)}finally{V(!1),E(!1),M("")}},ex=e=>{let t=new Date(e),a=t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),s=t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return`${a} at ${s}`},eh=(0,H.isProxyAdminRole)(N||"")||C&&(0,H.isUserTeamAdminForSingleTeam)(C?.filter(e=>e.team_id===z.team_id)[0]?.members_with_roles,w||"")||w===z.user_id&&"Internal Viewer"!==N;return(0,t.jsxs)("div",{className:"w-full h-screen p-4",children:[(0,t.jsx)(q,{data:{keyName:z.key_alias||S("keyDetail.header.virtualKey"),keyId:z.token_id||z.token,userId:z.user_id||"",userEmail:z.user_email||"",createdBy:z.user_email||z.user_id||"",createdAt:z.created_at?ex(z.created_at):"",lastUpdated:z.updated_at?ex(z.updated_at):"",lastActive:z.last_active?ex(z.last_active):S("keyDetail.header.never")},onBack:e,onRegenerate:()=>G(!0),onDelete:()=>E(!0),canModifyKey:eh,backButtonText:D,showRegenerateButton:!1,regenerateDisabled:!I,regenerateTooltip:I?void 0:S("keyDetail.header.regenerateTooltip")}),(0,t.jsx)(ej,{selectedToken:z,visible:K,onClose:()=>G(!1),onKeyUpdate:e=>{U(t=>{if(t)return{...t,...e,created_at:new Date().toLocaleString()}}),W(new Date),Q(!0),v&&v({...e,created_at:new Date().toLocaleString()})}}),(0,t.jsx)(Z.default,{isOpen:B,title:"Delete Key",alertMessage:S("keyDetail.deleteModal.alertMessage"),message:S("keyDetail.deleteModal.message"),resourceInformationTitle:S("keyDetail.deleteModal.resourceTitle"),resourceInformation:[{label:S("keyDetail.deleteModal.keyAlias"),value:z?.key_alias||"-"},{label:S("keyDetail.deleteModal.keyId"),value:z?.token_id||z?.token||"-",code:!0},{label:"分组 ID",value:z?.team_id||"-",code:!0},{label:"分组名称",value:eu||"-"},{label:S("keyDetail.deleteModal.spend"),value:z?.spend?`\xa5${(0,i.formatNumberWithCommas)(z.spend,4)}`:"¥0.0000"}],onCancel:()=>{E(!1),M("")},onOk:ep,confirmLoading:O,requiredConfirmation:z?.key_alias}),(0,t.jsxs)(g.TabGroup,{children:[(0,t.jsxs)(p.TabList,{className:"mb-4",children:[(0,t.jsx)(u.Tab,{children:S("keyDetail.tabs.overview")}),(0,t.jsx)(u.Tab,{children:S("keyDetail.tabs.settings")})]}),(0,t.jsxs)(h.TabPanels,{children:[(0,t.jsx)(x.TabPanel,{children:(0,t.jsxs)(m.Grid,{numItems:1,numItemsSm:2,numItemsLg:3,className:"gap-6",children:[(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(y.Text,{children:S("keyDetail.overview.spend")}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsxs)(_.Title,{children:["¥",(0,i.formatNumberWithCommas)(z.spend,4)]}),(0,t.jsxs)(y.Text,{children:[S("keyDetail.overview.of")," ",null!==z.max_budget?`\xa5${(0,i.formatNumberWithCommas)(z.max_budget)}`:S("keyDetail.overview.unlimited")]})]})]}),(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(y.Text,{children:S("keyDetail.overview.rateLimits")}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsxs)(y.Text,{children:[S("keyDetail.overview.tpm"),": ",null!==z.tpm_limit?z.tpm_limit:S("keyDetail.overview.unlimited")]}),(0,t.jsxs)(y.Text,{children:[S("keyDetail.overview.rpm"),": ",null!==z.rpm_limit?z.rpm_limit:S("keyDetail.overview.unlimited")]})]})]}),(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(y.Text,{children:S("keyDetail.overview.models")}),(0,t.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:z.models&&z.models.length>0?z.models.map((e,a)=>(0,t.jsx)(o.Badge,{color:"red",children:F(e)},a)):(0,t.jsx)(y.Text,{children:S("keyDetail.overview.noModels")})})]}),(0,t.jsx)(c.Card,{children:(0,t.jsx)(en.default,{objectPermission:z.object_permission,variant:"inline",accessToken:T})}),(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(y.Text,{className:"font-medium mb-3",children:S("keyDetail.overview.guardrails")}),Array.isArray(z.metadata?.guardrails)&&z.metadata.guardrails.length>0?(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:z.metadata.guardrails.map((e,a)=>(0,t.jsx)(o.Badge,{color:"blue",children:e},a))}):(0,t.jsx)(y.Text,{className:"text-gray-500",children:S("keyDetail.overview.noGuardrails")}),"boolean"==typeof z.metadata?.disable_global_guardrails&&!0===z.metadata.disable_global_guardrails&&(0,t.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,t.jsx)(o.Badge,{color:"yellow",children:S("keyDetail.overview.globalGuardrailsDisabled")})})]}),(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(y.Text,{className:"font-medium mb-3",children:S("keyDetail.overview.policies")}),Array.isArray(z.metadata?.policies)&&z.metadata.policies.length>0?(0,t.jsx)("div",{className:"space-y-4",children:z.metadata.policies.map((e,a)=>(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.Badge,{color:"purple",children:e}),ed&&(0,t.jsx)(y.Text,{className:"text-xs text-gray-400",children:S("keyDetail.overview.loadingGuardrails")})]}),!ed&&ee[e]&&ee[e].length>0&&(0,t.jsxs)("div",{className:"ml-4 pl-3 border-l-2 border-gray-200",children:[(0,t.jsxs)(y.Text,{className:"text-xs text-gray-500 mb-1",children:[S("keyDetail.overview.resolvedGuardrails"),":"]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:ee[e].map((e,a)=>(0,t.jsx)(o.Badge,{color:"blue",size:"xs",children:e},a))})]})]},a))}):(0,t.jsx)(y.Text,{className:"text-gray-500",children:S("keyDetail.overview.noPolicies")})]}),(0,t.jsx)(el.default,{loggingConfigs:et(z.metadata),disabledCallbacks:Array.isArray(z.metadata?.litellm_disabled_callbacks)?(0,J.mapInternalToDisplayNames)(z.metadata.litellm_disabled_callbacks):[],variant:"card"}),(0,t.jsx)(X,{autoRotate:z.auto_rotate,rotationInterval:z.rotation_interval,lastRotationAt:z.last_rotation_at,keyRotationAt:z.key_rotation_at,nextRotationAt:z.next_rotation_at,variant:"card"})]})}),(0,t.jsx)(x.TabPanel,{children:(0,t.jsxs)(c.Card,{className:"overflow-y-auto max-h-[65vh]",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)(_.Title,{children:S("keyDetail.settings.title")}),!A&&eh&&(0,t.jsx)(d.Button,{onClick:()=>L(!0),children:S("keyDetail.settings.editButton")})]}),A?(0,t.jsx)(eV,{keyData:z,onCancel:()=>L(!1),onSubmit:eg,teams:k,accessToken:T,userID:w,userRole:N,premiumUser:I}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.keyId")}),(0,t.jsx)(y.Text,{className:"font-mono",children:z.token_id||z.token})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.keyAlias")}),(0,t.jsx)(y.Text,{children:z.key_alias||S("keyDetail.settings.notSet")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.secretKey")}),(0,t.jsx)(y.Text,{className:"font-mono",children:z.key_name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.teamId").replace("团队","分组")}),(0,t.jsx)(y.Text,{children:z.team_id||S("keyDetail.settings.notSet")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:"分组名称"}),(0,t.jsx)(y.Text,{children:eu||S("keyDetail.settings.notSet")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.organization")}),(0,t.jsx)(y.Text,{children:z.organization_id||S("keyDetail.settings.notSet")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.created")}),(0,t.jsx)(y.Text,{children:ex(z.created_at)})]}),$&&(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.lastRegenerated")}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(y.Text,{children:ex($)}),(0,t.jsx)(o.Badge,{color:"green",size:"xs",children:S("keyDetail.settings.recent")})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.expires")}),(0,t.jsx)(y.Text,{children:z.expires?ex(z.expires):S("keyDetail.settings.never")})]}),(0,t.jsx)(X,{autoRotate:z.auto_rotate,rotationInterval:z.rotation_interval,lastRotationAt:z.last_rotation_at,keyRotationAt:z.key_rotation_at,nextRotationAt:z.next_rotation_at,variant:"inline",className:"pt-4 border-t border-gray-200"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.spend")}),(0,t.jsxs)(y.Text,{children:["¥",(0,i.formatNumberWithCommas)(z.spend,4)]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.budget")}),(0,t.jsx)(y.Text,{children:null!==z.max_budget?`\xa5${(0,i.formatNumberWithCommas)(z.max_budget,2)}`:S("keyDetail.settings.unlimited")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.tags")}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:Array.isArray(z.metadata?.tags)&&z.metadata.tags.length>0?z.metadata.tags.map((e,a)=>(0,t.jsx)("span",{className:"px-2 mr-2 py-1 bg-blue-100 rounded text-xs",children:e},a)):S("keyDetail.settings.noTags")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.prompts")}),(0,t.jsx)(y.Text,{children:Array.isArray(z.metadata?.prompts)&&z.metadata.prompts.length>0?z.metadata.prompts.map((e,a)=>(0,t.jsx)("span",{className:"px-2 mr-2 py-1 bg-blue-100 rounded text-xs",children:e},a)):S("keyDetail.settings.noPrompts")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.allowedRoutes")}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:Array.isArray(z.allowed_routes)&&z.allowed_routes.length>0?z.allowed_routes.map((e,a)=>(0,t.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:e},a)):(0,t.jsx)(j.Tag,{color:"green",children:S("keyDetail.settings.allRoutesAllowed")})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.allowedPassThroughRoutes")}),(0,t.jsx)(y.Text,{children:Array.isArray(z.metadata?.allowed_passthrough_routes)&&z.metadata.allowed_passthrough_routes.length>0?z.metadata.allowed_passthrough_routes.map((e,a)=>(0,t.jsx)("span",{className:"px-2 mr-2 py-1 bg-blue-100 rounded text-xs",children:e},a)):S("keyDetail.settings.noPassThroughRoutes")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.disableGlobalGuardrails")}),(0,t.jsx)(y.Text,{children:z.metadata?.disable_global_guardrails===!0?(0,t.jsx)(o.Badge,{color:"yellow",children:S("keyDetail.settings.globalGuardrailsEnabled")}):(0,t.jsx)(o.Badge,{color:"green",children:S("keyDetail.settings.globalGuardrailsDisabled")})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.models")}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:z.models&&z.models.length>0?z.models.map((e,a)=>(0,t.jsx)("span",{className:"px-2 py-1 bg-blue-100 rounded text-xs",children:F(e)},a)):(0,t.jsx)(y.Text,{children:S("keyDetail.settings.noModels")})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.rateLimits")}),(0,t.jsxs)(y.Text,{children:[S("keyDetail.settings.tpm"),": ",null!==z.tpm_limit?z.tpm_limit:S("keyDetail.settings.unlimited")]}),(0,t.jsxs)(y.Text,{children:[S("keyDetail.settings.rpm"),": ",null!==z.rpm_limit?z.rpm_limit:S("keyDetail.settings.unlimited")]}),(0,t.jsxs)(y.Text,{children:[S("keyDetail.settings.maxParallelRequests"),":"," ",null!==z.max_parallel_requests?z.max_parallel_requests:S("keyDetail.settings.unlimited")]}),(0,t.jsxs)(y.Text,{children:[S("keyDetail.settings.modelTpmLimits"),":"," ",z.metadata?.model_tpm_limit?JSON.stringify(z.metadata.model_tpm_limit):S("keyDetail.settings.unlimited")]}),(0,t.jsxs)(y.Text,{children:[S("keyDetail.settings.modelRpmLimits"),":"," ",z.metadata?.model_rpm_limit?JSON.stringify(z.metadata.model_rpm_limit):S("keyDetail.settings.unlimited")]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Text,{className:"font-medium",children:S("keyDetail.settings.metadata")}),(0,t.jsx)("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto mt-1",children:ea(es(z.metadata))})]}),(0,t.jsx)(en.default,{objectPermission:z.object_permission,variant:"inline",className:"pt-4 border-t border-gray-200",accessToken:T}),(0,t.jsx)(el.default,{loggingConfigs:et(z.metadata),disabledCallbacks:Array.isArray(z.metadata?.litellm_disabled_callbacks)?(0,J.mapInternalToDisplayNames)(z.metadata.litellm_disabled_callbacks):[],variant:"inline",className:"pt-4 border-t border-gray-200"})]})]})})]})]})]})}e.s(["default",()=>eM],20147)}]);