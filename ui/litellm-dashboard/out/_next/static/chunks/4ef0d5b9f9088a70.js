(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,735042,e=>{"use strict";e.i(247167);var a=e.i(843476),t=e.i(584935),l=e.i(290571),r=e.i(271645),s=e.i(95779),n=e.i(444755),o=e.i(673706);let i=(0,o.makeClassName)("BarList");function d(e,a){let{data:t=[],color:d,valueFormatter:c=o.defaultValueFormatter,showAnimation:m=!1,onValueChange:u,sortOrder:h="descending",className:x}=e,g=(0,l.__rest)(e,["data","color","valueFormatter","showAnimation","onValueChange","sortOrder","className"]),p=u?"button":"div",j=r.default.useMemo(()=>"none"===h?t:[...t].sort((e,a)=>"ascending"===h?e.value-a.value:a.value-e.value),[t,h]),f=r.default.useMemo(()=>{let e=Math.max(...j.map(e=>e.value),0);return j.map(a=>0===a.value?0:Math.max(a.value/e*100,2))},[j]);return r.default.createElement("div",Object.assign({ref:a,className:(0,n.tremorTwMerge)(i("root"),"flex justify-between space-x-6",x),"aria-sort":h},g),r.default.createElement("div",{className:(0,n.tremorTwMerge)(i("bars"),"relative w-full space-y-1.5")},j.map((e,a)=>{var t,l,c;let h=e.icon;return r.default.createElement(p,{key:null!=(t=e.key)?t:a,onClick:()=>{null==u||u(e)},className:(0,n.tremorTwMerge)(i("bar"),"group w-full flex items-center rounded-tremor-small",u?["cursor-pointer","hover:bg-tremor-background-muted dark:hover:bg-dark-tremor-background-subtle/40"]:"")},r.default.createElement("div",{className:(0,n.tremorTwMerge)("flex items-center rounded transition-all bg-opacity-40","h-8",e.color||d?[(0,o.getColorClassNames)(null!=(l=e.color)?l:d,s.colorPalette.background).bgColor,u?"group-hover:bg-opacity-30":""]:"bg-tremor-brand-subtle dark:bg-dark-tremor-brand-subtle/60",!u||e.color||d?"":"group-hover:bg-tremor-brand-subtle/30 group-hover:dark:bg-dark-tremor-brand-subtle/70",a===j.length-1?"mb-0":"",m?"duration-500":""),style:{width:`${f[a]}%`,transition:m?"all 1s":""}},r.default.createElement("div",{className:(0,n.tremorTwMerge)("absolute left-2 pr-4 flex max-w-full")},h?r.default.createElement(h,{className:(0,n.tremorTwMerge)(i("barIcon"),"flex-none h-5 w-5 mr-2","text-tremor-content","dark:text-dark-tremor-content")}):null,e.href?r.default.createElement("a",{href:e.href,target:null!=(c=e.target)?c:"_blank",rel:"noreferrer",className:(0,n.tremorTwMerge)(i("barLink"),"whitespace-nowrap hover:underline truncate text-tremor-default",u?"cursor-pointer":"","text-tremor-content-emphasis","dark:text-dark-tremor-content-emphasis"),onClick:e=>e.stopPropagation()},e.name):r.default.createElement("p",{className:(0,n.tremorTwMerge)(i("barText"),"whitespace-nowrap truncate text-tremor-default","text-tremor-content-emphasis","dark:text-dark-tremor-content-emphasis")},e.name))))})),r.default.createElement("div",{className:i("labels")},j.map((e,a)=>{var t;return r.default.createElement("div",{key:null!=(t=e.key)?t:a,className:(0,n.tremorTwMerge)(i("labelWrapper"),"flex justify-end items-center","h-8",a===j.length-1?"mb-0":"mb-1.5")},r.default.createElement("p",{className:(0,n.tremorTwMerge)(i("labelText"),"whitespace-nowrap leading-none truncate text-tremor-default","text-tremor-content-emphasis","dark:text-dark-tremor-content-emphasis")},c(e.value)))})))}d.displayName="BarList";let c=r.default.forwardRef(d);var m=e.i(304967),u=e.i(629569),h=e.i(269200),x=e.i(427612),g=e.i(64848),p=e.i(496020),j=e.i(977572),f=e.i(942232),b=e.i(37091),y=e.i(617802),C=e.i(144267),S=e.i(350967),T=e.i(309426),w=e.i(599724),v=e.i(404206),_=e.i(723731),k=e.i(653824),N=e.i(881073),E=e.i(197647),D=e.i(206929),M=e.i(35983),I=e.i(413990),F=e.i(476961),P=e.i(994388),A=e.i(621642),L=e.i(25080),B=e.i(764205),V=e.i(1023),G=e.i(500330);console.log("process.env.NODE_ENV","production");let U=e=>null!==e&&("Admin"===e||"Admin Viewer"===e);e.s(["default",0,({accessToken:e,token:l,userRole:s,userID:n,keys:o,premiumUser:i})=>{let d=new Date,[O,W]=(0,r.useState)([]),[R,Y]=(0,r.useState)([]),[$,K]=(0,r.useState)([]),[q,H]=(0,r.useState)([]),[z,Q]=(0,r.useState)([]),[X,J]=(0,r.useState)([]),[Z,ee]=(0,r.useState)([]),[ea,et]=(0,r.useState)([]),[el,er]=(0,r.useState)([]),[es,en]=(0,r.useState)([]),[eo,ei]=(0,r.useState)({}),[ed,ec]=(0,r.useState)([]),[em,eu]=(0,r.useState)(""),[eh,ex]=(0,r.useState)(["all-tags"]),[eg,ep]=(0,r.useState)({from:new Date(Date.now()-6048e5),to:new Date}),[ej,ef]=(0,r.useState)(null),[eb,ey]=(0,r.useState)(0),eC=new Date(d.getFullYear(),d.getMonth(),1),eS=new Date(d.getFullYear(),d.getMonth()+1,0),eT=eE(eC),ew=eE(eS);function ev(e){return new Intl.NumberFormat("en-US",{maximumFractionDigits:0,notation:"compact",compactDisplay:"short"}).format(e)}console.log("keys in usage",o),console.log("premium user in usage",i);let e_=async()=>{if(e)try{let a=await (0,B.getProxyUISettings)(e);return console.log("usage tab: proxy_settings",a),a}catch(e){console.error("Error fetching proxy settings:",e)}};(0,r.useEffect)(()=>{eN(eg.from,eg.to)},[eg,eh]);let ek=async(a,t,l)=>{if(!a||!t||!e)return;console.log("uiSelectedKey",l);let r=await (0,B.adminTopEndUsersCall)(e,l,a.toISOString(),t.toISOString());console.log("End user data updated successfully",r),H(r)},eN=async(a,t)=>{if(!a||!t||!e)return;let l=await e_();l?.DISABLE_EXPENSIVE_DB_QUERIES||(J((await (0,B.tagsSpendLogsCall)(e,a.toISOString(),t.toISOString(),0===eh.length?void 0:eh)).spend_per_tag),console.log("Tag spend data updated successfully"))};function eE(e){let a=e.getFullYear(),t=e.getMonth()+1,l=e.getDate();return`${a}-${t<10?"0"+t:t}-${l<10?"0"+l:l}`}console.log(`Start date is ${eT}`),console.log(`End date is ${ew}`);let eD=async(e,a,t)=>{try{let t=await e();a(t)}catch(e){console.error(t,e)}},eM=(e,a,t,l)=>{let r=[],s=new Date(a),n=new Map(e.map(e=>{let a=(e=>{if(e.includes("-"))return e;{let[a,t]=e.split(" ");return new Date(new Date().getFullYear(),new Date(`${a} 01 2024`).getMonth(),parseInt(t)).toISOString().split("T")[0]}})(e.date);return[a,{...e,date:a}]}));for(;s<=t;){let e=s.toISOString().split("T")[0];if(n.has(e))r.push(n.get(e));else{let a={date:e,api_requests:0,total_tokens:0};l.forEach(e=>{a[e]||(a[e]=0)}),r.push(a)}s.setDate(s.getDate()+1)}return r},eI=async()=>{if(e)try{let a=await (0,B.adminSpendLogsCall)(e),t=new Date,l=new Date(t.getFullYear(),t.getMonth(),1),r=new Date(t.getFullYear(),t.getMonth()+1,0),s=eM(a,l,r,[]),n=Number(s.reduce((e,a)=>e+(a.spend||0),0).toFixed(2));ey(n),W(s)}catch(e){console.error("Error fetching overall spend:",e)}},eF=async()=>{e&&await eD(async()=>(await (0,B.adminTopKeysCall)(e)).map(e=>({key:e.api_key.substring(0,10),api_key:e.api_key,key_alias:e.key_alias,spend:Number(e.total_spend.toFixed(2))})),Y,"Error fetching top keys")},eP=async()=>{e&&await eD(async()=>(await (0,B.adminTopModelsCall)(e)).map(e=>({key:e.model,spend:(0,G.formatNumberWithCommas)(e.total_spend,2)})),K,"Error fetching top models")},eA=async()=>{e&&await eD(async()=>{let a=await (0,B.teamSpendLogsCall)(e),t=new Date,l=new Date(t.getFullYear(),t.getMonth(),1),r=new Date(t.getFullYear(),t.getMonth()+1,0);return Q(eM(a.daily_spend,l,r,a.teams)),et(a.teams),a.total_spend_per_team.map(e=>({name:e.team_id||"",value:(0,G.formatNumberWithCommas)(e.total_spend||0,2)}))},er,"Error fetching team spend")},eL=async()=>{if(e)try{let a=await (0,B.adminGlobalActivity)(e,eT,ew),t=new Date,l=new Date(t.getFullYear(),t.getMonth(),1),r=new Date(t.getFullYear(),t.getMonth()+1,0),s=eM(a.daily_data||[],l,r,["api_requests","total_tokens"]);ei({...a,daily_data:s})}catch(e){console.error("Error fetching global activity:",e)}},eB=async()=>{if(e)try{let a=await (0,B.adminGlobalActivityPerModel)(e,eT,ew),t=new Date,l=new Date(t.getFullYear(),t.getMonth(),1),r=new Date(t.getFullYear(),t.getMonth()+1,0),s=a.map(e=>({...e,daily_data:eM(e.daily_data||[],l,r,["api_requests","total_tokens"])}));ec(s)}catch(e){console.error("Error fetching global activity per model:",e)}};return((0,r.useEffect)(()=>{(async()=>{if(e&&l&&s&&n){let a=await e_();!(a&&(ef(a),a?.DISABLE_EXPENSIVE_DB_QUERIES))&&(console.log("fetching data - valiue of proxySettings",ej),eI(),eD(()=>e&&l?(0,B.adminspendByProvider)(e,l,eT,ew):Promise.reject("No access token or token"),en,"Error fetching provider spend"),eF(),eP(),eL(),eB(),U(s)&&(eA(),e&&eD(async()=>(await (0,B.allTagNamesCall)(e)).tag_names,ee,"Error fetching tag names"),e&&eD(()=>(0,B.tagsSpendLogsCall)(e,eg.from?.toISOString(),eg.to?.toISOString(),void 0),e=>J(e.spend_per_tag),"Error fetching top tags"),e&&eD(()=>(0,B.adminTopEndUsersCall)(e,null,void 0,void 0),H,"Error fetching top end users")))}})()},[e,l,s,n,eT,ew]),ej?.DISABLE_EXPENSIVE_DB_QUERIES)?(0,a.jsx)("div",{style:{width:"100%"},className:"p-8",children:(0,a.jsxs)(m.Card,{children:[(0,a.jsx)(u.Title,{children:"Database Query Limit Reached"}),(0,a.jsxs)(w.Text,{className:"mt-4",children:["SpendLogs in DB has ",ej.NUM_SPEND_LOGS_ROWS," rows.",(0,a.jsx)("br",{}),"Please follow our guide to view usage when SpendLogs has more than 1M rows."]}),(0,a.jsx)(P.Button,{className:"mt-4",children:(0,a.jsx)("a",{href:"https://docs.litellm.ai/docs/proxy/spending_monitoring",target:"_blank",children:"View Usage Guide"})})]})}):(0,a.jsx)("div",{style:{width:"100%"},className:"p-8",children:(0,a.jsxs)(k.TabGroup,{children:[(0,a.jsxs)(N.TabList,{className:"mt-2",children:[(0,a.jsx)(E.Tab,{children:"All Up"}),U(s)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.Tab,{children:"Team Based Usage"}),(0,a.jsx)(E.Tab,{children:"Customer Usage"}),(0,a.jsx)(E.Tab,{children:"Tag Based Usage"})]}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{})})]}),(0,a.jsxs)(_.TabPanels,{children:[(0,a.jsx)(v.TabPanel,{children:(0,a.jsxs)(k.TabGroup,{children:[(0,a.jsxs)(N.TabList,{variant:"solid",className:"mt-1",children:[(0,a.jsx)(E.Tab,{children:"Cost"}),(0,a.jsx)(E.Tab,{children:"Activity"})]}),(0,a.jsxs)(_.TabPanels,{children:[(0,a.jsx)(v.TabPanel,{children:(0,a.jsxs)(S.Grid,{numItems:2,className:"gap-2 h-[100vh] w-full",children:[(0,a.jsxs)(T.Col,{numColSpan:2,children:[(0,a.jsxs)(w.Text,{className:"text-tremor-default text-tremor-content dark:text-dark-tremor-content mb-2 mt-2 text-lg",children:["Project Spend ",new Date().toLocaleString("default",{month:"long"})," 1 -"," ",new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate()]}),(0,a.jsx)(y.default,{userSpend:eb,selectedTeam:null,userMaxBudget:null})]}),(0,a.jsx)(T.Col,{numColSpan:2,children:(0,a.jsxs)(m.Card,{children:[(0,a.jsx)(u.Title,{children:"Monthly Spend"}),(0,a.jsx)(t.BarChart,{data:O,index:"date",categories:["spend"],colors:["cyan"],valueFormatter:e=>`$ ${(0,G.formatNumberWithCommas)(e,2)}`,yAxisWidth:100,tickGap:5})]})}),(0,a.jsx)(T.Col,{numColSpan:1,children:(0,a.jsxs)(m.Card,{className:"h-full",children:[(0,a.jsx)(u.Title,{children:"Top Virtual Keys"}),(0,a.jsx)(V.default,{topKeys:R,teams:null,topKeysLimit:5,setTopKeysLimit:()=>{}})]})}),(0,a.jsx)(T.Col,{numColSpan:1,children:(0,a.jsxs)(m.Card,{className:"h-full",children:[(0,a.jsx)(u.Title,{children:"Top Models"}),(0,a.jsx)(t.BarChart,{className:"mt-4 h-40",data:$,index:"key",categories:["spend"],colors:["cyan"],yAxisWidth:200,layout:"vertical",showXAxis:!1,showLegend:!1,valueFormatter:e=>`\xa5${(0,G.formatNumberWithCommas)(e)}`})]})}),(0,a.jsx)(T.Col,{numColSpan:1}),(0,a.jsx)(T.Col,{numColSpan:2,children:(0,a.jsxs)(m.Card,{className:"mb-2",children:[(0,a.jsx)(u.Title,{children:"Spend by Provider"}),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(S.Grid,{numItems:2,children:[(0,a.jsx)(T.Col,{numColSpan:1,children:(0,a.jsx)(I.DonutChart,{className:"mt-4 h-40",variant:"pie",data:es,index:"provider",category:"spend",colors:["cyan"],valueFormatter:e=>`\xa5${(0,G.formatNumberWithCommas)(e)}`})}),(0,a.jsx)(T.Col,{numColSpan:1,children:(0,a.jsxs)(h.Table,{children:[(0,a.jsx)(x.TableHead,{children:(0,a.jsxs)(p.TableRow,{children:[(0,a.jsx)(g.TableHeaderCell,{children:"Provider"}),(0,a.jsx)(g.TableHeaderCell,{children:"Spend"})]})}),(0,a.jsx)(f.TableBody,{children:es.map(e=>(0,a.jsxs)(p.TableRow,{children:[(0,a.jsx)(j.TableCell,{children:e.provider}),(0,a.jsx)(j.TableCell,{children:1e-5>parseFloat(e.spend.toFixed(2))?"less than 0.00":(0,G.formatNumberWithCommas)(e.spend,2)})]},e.provider))})]})})]})})]})})]})}),(0,a.jsx)(v.TabPanel,{children:(0,a.jsxs)(S.Grid,{numItems:1,className:"gap-2 h-[75vh] w-full",children:[(0,a.jsxs)(m.Card,{children:[(0,a.jsx)(u.Title,{children:"All Up"}),(0,a.jsxs)(S.Grid,{numItems:2,children:[(0,a.jsxs)(T.Col,{children:[(0,a.jsxs)(b.Subtitle,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["API Requests ",ev(eo.sum_api_requests)]}),(0,a.jsx)(F.AreaChart,{className:"h-40",data:eo.daily_data,valueFormatter:ev,index:"date",colors:["cyan"],categories:["api_requests"],onValueChange:e=>console.log(e)})]}),(0,a.jsxs)(T.Col,{children:[(0,a.jsxs)(b.Subtitle,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Tokens ",ev(eo.sum_total_tokens)]}),(0,a.jsx)(t.BarChart,{className:"h-40",data:eo.daily_data,valueFormatter:ev,index:"date",colors:["cyan"],categories:["total_tokens"],onValueChange:e=>console.log(e)})]})]})]}),(0,a.jsx)(a.Fragment,{children:ed.map((e,l)=>(0,a.jsxs)(m.Card,{children:[(0,a.jsx)(u.Title,{children:e.model}),(0,a.jsxs)(S.Grid,{numItems:2,children:[(0,a.jsxs)(T.Col,{children:[(0,a.jsxs)(b.Subtitle,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["API Requests ",ev(e.sum_api_requests)]}),(0,a.jsx)(F.AreaChart,{className:"h-40",data:e.daily_data,index:"date",colors:["cyan"],categories:["api_requests"],valueFormatter:ev,onValueChange:e=>console.log(e)})]}),(0,a.jsxs)(T.Col,{children:[(0,a.jsxs)(b.Subtitle,{style:{fontSize:"15px",fontWeight:"normal",color:"#535452"},children:["Tokens ",ev(e.sum_total_tokens)]}),(0,a.jsx)(t.BarChart,{className:"h-40",data:e.daily_data,index:"date",colors:["cyan"],categories:["total_tokens"],valueFormatter:ev,onValueChange:e=>console.log(e)})]})]})]},l))})]})})]})]})}),(0,a.jsx)(v.TabPanel,{children:(0,a.jsxs)(S.Grid,{numItems:2,className:"gap-2 h-[75vh] w-full",children:[(0,a.jsxs)(T.Col,{numColSpan:2,children:[(0,a.jsxs)(m.Card,{className:"mb-2",children:[(0,a.jsx)(u.Title,{children:"Total Spend Per Team"}),(0,a.jsx)(c,{data:el})]}),(0,a.jsxs)(m.Card,{children:[(0,a.jsx)(u.Title,{children:"Daily Spend Per Team"}),(0,a.jsx)(t.BarChart,{className:"h-72",data:z,showLegend:!0,index:"date",categories:ea,yAxisWidth:80,stack:!0})]})]}),(0,a.jsx)(T.Col,{numColSpan:2})]})}),(0,a.jsxs)(v.TabPanel,{children:[(0,a.jsxs)("p",{className:"mb-2 text-gray-500 italic text-[12px]",children:["Customers of your LLM API calls. Tracked when a `user` param is passed in your LLM calls"," ",(0,a.jsx)("a",{className:"text-blue-500",href:"https://docs.litellm.ai/docs/proxy/users",target:"_blank",children:"docs here"})]}),(0,a.jsxs)(S.Grid,{numItems:2,children:[(0,a.jsx)(T.Col,{children:(0,a.jsx)(C.default,{value:eg,onValueChange:e=>{ep(e),ek(e.from,e.to,null)}})}),(0,a.jsxs)(T.Col,{children:[(0,a.jsx)(w.Text,{children:"Select Key"}),(0,a.jsxs)(D.Select,{defaultValue:"all-keys",children:[(0,a.jsx)(M.SelectItem,{value:"all-keys",onClick:()=>{ek(eg.from,eg.to,null)},children:"All Keys"},"all-keys"),o?.map((e,t)=>e&&null!==e.key_alias&&e.key_alias.length>0?(0,a.jsx)(M.SelectItem,{value:String(t),onClick:()=>{ek(eg.from,eg.to,e.token)},children:e.key_alias},t):null)]})]})]}),(0,a.jsx)(m.Card,{className:"mt-4",children:(0,a.jsxs)(h.Table,{className:"max-h-[70vh] min-h-[500px]",children:[(0,a.jsx)(x.TableHead,{children:(0,a.jsxs)(p.TableRow,{children:[(0,a.jsx)(g.TableHeaderCell,{children:"Customer"}),(0,a.jsx)(g.TableHeaderCell,{children:"Spend"}),(0,a.jsx)(g.TableHeaderCell,{children:"Total Events"})]})}),(0,a.jsx)(f.TableBody,{children:q?.map((e,t)=>(0,a.jsxs)(p.TableRow,{children:[(0,a.jsx)(j.TableCell,{children:e.end_user}),(0,a.jsx)(j.TableCell,{children:(0,G.formatNumberWithCommas)(e.total_spend,2)}),(0,a.jsx)(j.TableCell,{children:e.total_count})]},t))})]})})]}),(0,a.jsxs)(v.TabPanel,{children:[(0,a.jsxs)(S.Grid,{numItems:2,children:[(0,a.jsx)(T.Col,{numColSpan:1,children:(0,a.jsx)(C.default,{className:"mb-4",value:eg,onValueChange:e=>{ep(e),eN(e.from,e.to)}})}),(0,a.jsx)(T.Col,{children:i?(0,a.jsx)("div",{children:(0,a.jsxs)(A.MultiSelect,{value:eh,onValueChange:e=>ex(e),children:[(0,a.jsx)(L.MultiSelectItem,{value:"all-tags",onClick:()=>ex(["all-tags"]),children:"All Tags"},"all-tags"),Z&&Z.filter(e=>"all-tags"!==e).map((e,t)=>(0,a.jsx)(L.MultiSelectItem,{value:String(e),children:e},e))]})}):(0,a.jsx)("div",{children:(0,a.jsxs)(A.MultiSelect,{value:eh,onValueChange:e=>ex(e),children:[(0,a.jsx)(L.MultiSelectItem,{value:"all-tags",onClick:()=>ex(["all-tags"]),children:"All Tags"},"all-tags"),Z&&Z.filter(e=>"all-tags"!==e).map((e,t)=>(0,a.jsxs)(M.SelectItem,{value:String(e),disabled:!0,children:["âœ¨ ",e," (Enterprise only Feature)"]},e))]})})})]}),(0,a.jsxs)(S.Grid,{numItems:2,className:"gap-2 h-[75vh] w-full mb-4",children:[(0,a.jsx)(T.Col,{numColSpan:2,children:(0,a.jsxs)(m.Card,{children:[(0,a.jsx)(u.Title,{children:"Spend Per Tag"}),(0,a.jsxs)(w.Text,{children:["Get Started by Tracking cost per tag"," ",(0,a.jsx)("a",{className:"text-blue-500",href:"https://docs.litellm.ai/docs/proxy/cost_tracking",target:"_blank",children:"here"})]}),(0,a.jsx)(t.BarChart,{className:"h-72",data:X,index:"name",categories:["spend"],colors:["cyan"]})]})}),(0,a.jsx)(T.Col,{numColSpan:2})]})]})]})]})})}],735042)},999333,e=>{"use strict";var a=e.i(843476),t=e.i(735042),l=e.i(135214),r=e.i(271645);e.s(["default",0,()=>{let{accessToken:e,token:s,userRole:n,userId:o,premiumUser:i}=(0,l.default)(),[d,c]=(0,r.useState)([]);return(0,a.jsx)(t.default,{accessToken:e,token:s,userRole:n,userID:o,keys:d,premiumUser:i})}])},601236,e=>{e.v(e=>Promise.resolve().then(()=>e(764205)))}]);