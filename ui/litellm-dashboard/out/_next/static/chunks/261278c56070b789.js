(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,105278,e=>{"use strict";var t=e.i(843476),s=e.i(135214),i=e.i(994388),l=e.i(366283),r=e.i(304967),n=e.i(269200),a=e.i(942232),o=e.i(977572),c=e.i(427612),d=e.i(64848),u=e.i(496020),m=e.i(560445),p=e.i(464571),g=e.i(808613),_=e.i(311451),h=e.i(212931),x=e.i(653496),f=e.i(898586),y=e.i(271645),j=e.i(700514),S=e.i(727749),v=e.i(764205),b=e.i(629569),I=e.i(599724),C=e.i(350967),T=e.i(779241),w=e.i(114600),k=e.i(237016),N=e.i(596239),E=e.i(438957),O=e.i(166406),F=e.i(270377);e.i(247167);var A=e.i(931067);let P={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};var M=e.i(9583),U=y.forwardRef(function(e,t){return y.createElement(M.default,(0,A.default)({},e,{ref:t,icon:P}))}),R=e.i(190702);let B=({accessToken:e,userID:s,proxySettings:n})=>{let[a]=g.Form.useForm(),[o,c]=(0,y.useState)(!1),[d,u]=(0,y.useState)(null),[m,p]=(0,y.useState)("<your_proxy_base_url>");(0,y.useEffect)(()=>{let e="<your_proxy_base_url>";p(e=n&&n.PROXY_BASE_URL&&void 0!==n.PROXY_BASE_URL?n.PROXY_BASE_URL:window.location.origin)},[n]);let _=`${m}/scim/v2`,h=async t=>{if(!e||!s)return void S.default.fromBackend("You need to be logged in to create a SCIM token");try{c(!0);let i={key_alias:t.key_alias||"SCIM Access Token",team_id:null,models:[],allowed_routes:["/scim/*"]},l=await (0,v.keyCreateCall)(e,s,i);u(l),S.default.success("SCIM token created successfully")}catch(e){console.error("Error creating SCIM token:",e),S.default.fromBackend("Failed to create SCIM token: "+(0,R.parseErrorMessage)(e))}finally{c(!1)}};return(0,t.jsx)(C.Grid,{numItems:1,children:(0,t.jsxs)(r.Card,{children:[(0,t.jsx)("div",{className:"flex items-center mb-4",children:(0,t.jsx)(b.Title,{children:"SCIM Configuration"})}),(0,t.jsx)(I.Text,{className:"text-gray-600",children:"System for Cross-domain Identity Management (SCIM) allows you to automatically provision and manage users and groups in Silinex."}),(0,t.jsx)(w.Divider,{}),(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-700 mr-2",children:"1"}),(0,t.jsxs)(b.Title,{className:"text-lg flex items-center",children:[(0,t.jsx)(N.LinkOutlined,{className:"h-5 w-5 mr-2"}),"SCIM Tenant URL"]})]}),(0,t.jsx)(I.Text,{className:"text-gray-600 mb-3",children:"Use this URL in your identity provider SCIM integration settings."}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(T.TextInput,{value:_,disabled:!0,className:"flex-grow"}),(0,t.jsx)(k.CopyToClipboard,{text:_,onCopy:()=>S.default.success("URL copied to clipboard"),children:(0,t.jsxs)(i.Button,{variant:"primary",className:"ml-2 flex items-center",children:[(0,t.jsx)(O.CopyOutlined,{className:"h-4 w-4 mr-1"}),"Copy"]})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-700 mr-2",children:"2"}),(0,t.jsxs)(b.Title,{className:"text-lg flex items-center",children:[(0,t.jsx)(E.KeyOutlined,{className:"h-5 w-5 mr-2"}),"Authentication Token"]})]}),(0,t.jsx)(l.Callout,{title:"Using SCIM",color:"blue",className:"mb-4",children:"You need a SCIM token to authenticate with the SCIM API. Create one below and use it in your SCIM provider configuration."}),d?(0,t.jsxs)(r.Card,{className:"border border-yellow-300 bg-yellow-50",children:[(0,t.jsxs)("div",{className:"flex items-center mb-2 text-yellow-800",children:[(0,t.jsx)(F.ExclamationCircleOutlined,{className:"h-5 w-5 mr-2"}),(0,t.jsx)(b.Title,{className:"text-lg text-yellow-800",children:"Your SCIM Token"})]}),(0,t.jsx)(I.Text,{className:"text-yellow-800 mb-4 font-medium",children:"Make sure to copy this token now. You will not be able to see it again."}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(T.TextInput,{value:d.key,className:"flex-grow mr-2 bg-white",type:"password",disabled:!0}),(0,t.jsx)(k.CopyToClipboard,{text:d.key,onCopy:()=>S.default.success("Token copied to clipboard"),children:(0,t.jsxs)(i.Button,{variant:"primary",className:"flex items-center",children:[(0,t.jsx)(O.CopyOutlined,{className:"h-4 w-4 mr-1"}),"Copy"]})})]}),(0,t.jsxs)(i.Button,{className:"mt-4 flex items-center",variant:"secondary",onClick:()=>u(null),children:[(0,t.jsx)(U,{className:"h-4 w-4 mr-1"}),"Create Another Token"]})]}):(0,t.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,t.jsxs)(g.Form,{form:a,onFinish:h,layout:"vertical",children:[(0,t.jsx)(g.Form.Item,{name:"key_alias",label:"Token Name",rules:[{required:!0,message:"Please enter a name for your token"}],children:(0,t.jsx)(T.TextInput,{placeholder:"SCIM Access Token"})}),(0,t.jsx)(g.Form.Item,{children:(0,t.jsxs)(i.Button,{variant:"primary",type:"submit",loading:o,className:"flex items-center",children:[(0,t.jsx)(E.KeyOutlined,{className:"h-4 w-4 mr-1"}),"Create SCIM Token"]})})]})})]})]})]})})};var z=e.i(266027),D=e.i(243652);let L=(0,D.createQueryKeys)("sso"),G=()=>{let{accessToken:e,userId:t,userRole:i}=(0,s.default)();return(0,z.useQuery)({queryKey:L.detail("settings"),queryFn:async()=>await (0,v.getSSOSettings)(e),enabled:!!(e&&t&&i)})};var V=e.i(175712),q=e.i(869216),K=e.i(770914),H=e.i(262218),W=e.i(688511),Y=e.i(918549),Y=Y,$=e.i(727612);let J={google:"https://artificialanalysis.ai/img/logos/google_small.svg",microsoft:"https://upload.wikimedia.org/wikipedia/commons/a/a8/Microsoft_Azure_Logo.svg",okta:"https://www.okta.com/sites/default/files/Okta_Logo_BrightBlue_Medium.png",generic:""},Q={google:"Google SSO",microsoft:"Microsoft SSO",okta:"Okta / Auth0 SSO",generic:"Generic SSO"},Z={internal_user_viewer:"Internal Viewer",internal_user:"Internal User",proxy_admin_viewer:"Proxy Admin Viewer",proxy_admin:"Proxy Admin"};var X=e.i(536916),ee=e.i(199133);let et={google:{envVarMap:{google_client_id:"GOOGLE_CLIENT_ID",google_client_secret:"GOOGLE_CLIENT_SECRET"},fields:[{label:"Google Client ID",name:"google_client_id"},{label:"Google Client Secret",name:"google_client_secret"}]},microsoft:{envVarMap:{microsoft_client_id:"MICROSOFT_CLIENT_ID",microsoft_client_secret:"MICROSOFT_CLIENT_SECRET",microsoft_tenant:"MICROSOFT_TENANT"},fields:[{label:"Microsoft Client ID",name:"microsoft_client_id"},{label:"Microsoft Client Secret",name:"microsoft_client_secret"},{label:"Microsoft Tenant",name:"microsoft_tenant"}]},okta:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"Generic Client ID",name:"generic_client_id"},{label:"Generic Client Secret",name:"generic_client_secret"},{label:"Authorization Endpoint",name:"generic_authorization_endpoint",placeholder:"https://your-domain/authorize"},{label:"Token Endpoint",name:"generic_token_endpoint",placeholder:"https://your-domain/token"},{label:"Userinfo Endpoint",name:"generic_userinfo_endpoint",placeholder:"https://your-domain/userinfo"}]},generic:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"Generic Client ID",name:"generic_client_id"},{label:"Generic Client Secret",name:"generic_client_secret"},{label:"Authorization Endpoint",name:"generic_authorization_endpoint"},{label:"Token Endpoint",name:"generic_token_endpoint"},{label:"Userinfo Endpoint",name:"generic_userinfo_endpoint"}]}},es=({form:e,onFormSubmit:s})=>(0,t.jsx)("div",{children:(0,t.jsxs)(g.Form,{form:e,onFinish:s,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,t.jsx)(g.Form.Item,{label:"SSO Provider",name:"sso_provider",rules:[{required:!0,message:"Please select an SSO provider"}],children:(0,t.jsx)(ee.Select,{children:Object.entries(J).map(([e,s])=>(0,t.jsx)(ee.Select.Option,{value:e,children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 0"},children:[s&&(0,t.jsx)("img",{src:s,alt:e,style:{height:24,width:24,marginRight:12,objectFit:"contain"}}),(0,t.jsx)("span",{children:Q[e]||e.charAt(0).toUpperCase()+e.slice(1)+" SSO"})]})},e))})}),(0,t.jsx)(g.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.sso_provider!==t.sso_provider,children:({getFieldValue:e})=>{let s,i=e("sso_provider");return i&&(s=et[i])?s.fields.map(e=>(0,t.jsx)(g.Form.Item,{label:e.label,name:e.name,rules:[{required:!0,message:`Please enter the ${e.label.toLowerCase()}`}],children:e.name.includes("client")?(0,t.jsx)(_.Input.Password,{}):(0,t.jsx)(T.TextInput,{placeholder:e.placeholder})},e.name)):null}}),(0,t.jsx)(g.Form.Item,{label:"Proxy Admin Email",name:"user_email",rules:[{required:!0,message:"Please enter the email of the proxy admin"}],children:(0,t.jsx)(T.TextInput,{})}),(0,t.jsx)(g.Form.Item,{label:"Proxy Base URL",name:"proxy_base_url",normalize:e=>e?.trim(),rules:[{required:!0,message:"Please enter the proxy base url"},{pattern:/^https?:\/\/.+/,message:"URL must start with http:// or https://"},{validator:(e,t)=>t&&/^https?:\/\/.+/.test(t)&&t.endsWith("/")?Promise.reject("URL must not end with a trailing slash"):Promise.resolve()}],children:(0,t.jsx)(T.TextInput,{placeholder:"https://example.com"})}),(0,t.jsx)(g.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.sso_provider!==t.sso_provider,children:({getFieldValue:e})=>{let s=e("sso_provider");return"okta"===s||"generic"===s?(0,t.jsx)(g.Form.Item,{label:"Use Role Mappings",name:"use_role_mappings",valuePropName:"checked",children:(0,t.jsx)(X.Checkbox,{})}):null}}),(0,t.jsx)(g.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.use_role_mappings!==t.use_role_mappings||e.sso_provider!==t.sso_provider,children:({getFieldValue:e})=>{let s=e("use_role_mappings"),i=e("sso_provider");return s&&("okta"===i||"generic"===i)?(0,t.jsx)(g.Form.Item,{label:"Group Claim",name:"group_claim",rules:[{required:!0,message:"Please enter the group claim"}],children:(0,t.jsx)(T.TextInput,{})}):null}}),(0,t.jsx)(g.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.use_role_mappings!==t.use_role_mappings||e.sso_provider!==t.sso_provider,children:({getFieldValue:e})=>{let s=e("use_role_mappings"),i=e("sso_provider");return s&&("okta"===i||"generic"===i)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Form.Item,{label:"Default Role",name:"default_role",initialValue:"Internal User",children:(0,t.jsxs)(ee.Select,{children:[(0,t.jsx)(ee.Select.Option,{value:"internal_user_viewer",children:"Internal Viewer"}),(0,t.jsx)(ee.Select.Option,{value:"internal_user",children:"Internal User"}),(0,t.jsx)(ee.Select.Option,{value:"proxy_admin_viewer",children:"Admin Viewer"}),(0,t.jsx)(ee.Select.Option,{value:"proxy_admin",children:"Proxy Admin"})]})}),(0,t.jsx)(g.Form.Item,{label:"Proxy Admin Teams",name:"proxy_admin_teams",children:(0,t.jsx)(T.TextInput,{})}),(0,t.jsx)(g.Form.Item,{label:"Admin Viewer Teams",name:"admin_viewer_teams",children:(0,t.jsx)(T.TextInput,{})}),(0,t.jsx)(g.Form.Item,{label:"Internal User Teams",name:"internal_user_teams",children:(0,t.jsx)(T.TextInput,{})}),(0,t.jsx)(g.Form.Item,{label:"Internal Viewer Teams",name:"internal_viewer_teams",children:(0,t.jsx)(T.TextInput,{})})]}):null}}),(0,t.jsx)(g.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.sso_provider!==t.sso_provider,children:({getFieldValue:e})=>{let s=e("sso_provider");return"okta"===s||"generic"===s?(0,t.jsx)(g.Form.Item,{label:"Use Team Mappings",name:"use_team_mappings",valuePropName:"checked",children:(0,t.jsx)(X.Checkbox,{})}):null}}),(0,t.jsx)(g.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.use_team_mappings!==t.use_team_mappings||e.sso_provider!==t.sso_provider,children:({getFieldValue:e})=>{let s=e("use_team_mappings"),i=e("sso_provider");return s&&("okta"===i||"generic"===i)?(0,t.jsx)(g.Form.Item,{label:"Team IDs JWT Field",name:"team_ids_jwt_field",rules:[{required:!0,message:"Please enter the team IDs JWT field"}],children:(0,t.jsx)(T.TextInput,{})}):null}})]})});var ei=e.i(954616);let el=()=>{let{accessToken:e}=(0,s.default)();return(0,ei.useMutation)({mutationFn:async t=>{if(!e)throw Error("Access token is required");return await (0,v.updateSSOSettings)(e,t)}})},er=e=>{let{proxy_admin_teams:t,admin_viewer_teams:s,internal_user_teams:i,internal_viewer_teams:l,default_role:r,group_claim:n,use_role_mappings:a,use_team_mappings:o,team_ids_jwt_field:c,...d}=e,u={...d},m=d.sso_provider;if(a&&("okta"===m||"generic"===m)){let e=e=>e&&""!==e.trim()?e.split(",").map(e=>e.trim()).filter(e=>e.length>0):[];u.role_mappings={provider:"generic",group_claim:n,default_role:({internal_user_viewer:"internal_user_viewer",internal_user:"internal_user",proxy_admin_viewer:"proxy_admin_viewer",proxy_admin:"proxy_admin"})[r]||"internal_user",roles:{proxy_admin:e(t),proxy_admin_viewer:e(s),internal_user:e(i),internal_user_viewer:e(l)}}}return o&&("okta"===m||"generic"===m)&&(u.team_mappings={team_ids_jwt_field:c}),u},en=e=>e.google_client_id?"google":e.microsoft_client_id?"microsoft":e.generic_client_id?e.generic_authorization_endpoint?.includes("okta")||e.generic_authorization_endpoint?.includes("auth0")?"okta":"generic":null,ea=({isVisible:e,onCancel:s,onSuccess:i})=>{let[l]=g.Form.useForm(),{mutateAsync:r,isPending:n}=el(),a=async e=>{let t=er(e);await r(t,{onSuccess:()=>{S.default.success("SSO settings added successfully"),i()},onError:e=>{S.default.fromBackend("Failed to save SSO settings: "+(0,R.parseErrorMessage)(e))}})},o=()=>{l.resetFields(),s()};return(0,t.jsx)(h.Modal,{title:"Add SSO",open:e,width:800,footer:(0,t.jsxs)(K.Space,{children:[(0,t.jsx)(p.Button,{onClick:o,disabled:n,children:"Cancel"}),(0,t.jsx)(p.Button,{loading:n,onClick:()=>l.submit(),children:n?"Adding...":"Add SSO"})]}),onCancel:o,children:(0,t.jsx)(es,{form:l,onFormSubmit:a})})};var eo=e.i(127952);let ec=({isVisible:e,onCancel:s,onSuccess:i})=>{let{data:l}=G(),{mutateAsync:r,isPending:n}=el(),a=async()=>{await r({google_client_id:null,google_client_secret:null,microsoft_client_id:null,microsoft_client_secret:null,microsoft_tenant:null,generic_client_id:null,generic_client_secret:null,generic_authorization_endpoint:null,generic_token_endpoint:null,generic_userinfo_endpoint:null,proxy_base_url:null,user_email:null,sso_provider:null,role_mappings:null,team_mappings:null},{onSuccess:()=>{S.default.success("SSO settings cleared successfully"),s(),i()},onError:e=>{S.default.fromBackend("Failed to clear SSO settings: "+(0,R.parseErrorMessage)(e))}})};return(0,t.jsx)(eo.default,{isOpen:e,title:"Confirm Clear SSO Settings",alertMessage:"This action cannot be undone.",message:"Are you sure you want to clear all SSO settings? Users will no longer be able to login using SSO after this change.",resourceInformationTitle:"SSO Settings",resourceInformation:[{label:"Provider",value:l?.values&&en(l?.values)||"Generic"}],onCancel:s,onOk:a,confirmLoading:n})},ed=({isVisible:e,onCancel:s,onSuccess:i})=>{let[l]=g.Form.useForm(),r=G(),{mutateAsync:n,isPending:a}=el();(0,y.useEffect)(()=>{if(e&&r.data&&r.data.values){let e=r.data;console.log("Raw SSO data received:",e),console.log("SSO values:",e.values),console.log("user_email from API:",e.values.user_email);let t=null;e.values.google_client_id?t="google":e.values.microsoft_client_id?t="microsoft":e.values.generic_client_id&&(t=e.values.generic_authorization_endpoint?.includes("okta")||e.values.generic_authorization_endpoint?.includes("auth0")?"okta":"generic");let s={};if(e.values.role_mappings){let t=e.values.role_mappings,i=e=>e&&0!==e.length?e.join(", "):"";s={use_role_mappings:!0,group_claim:t.group_claim,default_role:t.default_role||"internal_user",proxy_admin_teams:i(t.roles?.proxy_admin),admin_viewer_teams:i(t.roles?.proxy_admin_viewer),internal_user_teams:i(t.roles?.internal_user),internal_viewer_teams:i(t.roles?.internal_user_viewer)}}let i={};e.values.team_mappings&&(i={use_team_mappings:!0,team_ids_jwt_field:e.values.team_mappings.team_ids_jwt_field});let n={sso_provider:t,...e.values,...s,...i};console.log("Setting form values:",n),l.resetFields(),setTimeout(()=>{l.setFieldsValue(n),console.log("Form values set, current form values:",l.getFieldsValue())},100)}},[e,r.data,l]);let o=async e=>{try{let t=er(e);await n(t,{onSuccess:()=>{S.default.success("SSO settings updated successfully"),i()},onError:e=>{S.default.fromBackend("Failed to save SSO settings: "+(0,R.parseErrorMessage)(e))}})}catch(e){S.default.fromBackend("Failed to process SSO settings: "+(0,R.parseErrorMessage)(e))}},c=()=>{l.resetFields(),s()};return(0,t.jsx)(h.Modal,{title:"Edit SSO Settings",open:e,width:800,footer:(0,t.jsxs)(K.Space,{children:[(0,t.jsx)(p.Button,{onClick:c,disabled:a,children:"Cancel"}),(0,t.jsx)(p.Button,{loading:a,onClick:()=>l.submit(),children:a?"Saving...":"Save"})]}),onCancel:c,children:(0,t.jsx)(es,{form:l,onFormSubmit:o})})};var eu=e.i(286536),em=e.i(77705);function ep({defaultHidden:e=!0,value:s}){let[i,l]=(0,y.useState)(e);return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-mono text-gray-600 flex-1",children:s?i?"â€¢".repeat(s.length):s:(0,t.jsx)("span",{className:"text-gray-400 italic",children:"Not configured"})}),s&&(0,t.jsx)(p.Button,{type:"text",size:"small",icon:i?(0,t.jsx)(eu.Eye,{className:"w-4 h-4"}):(0,t.jsx)(em.EyeOff,{className:"w-4 h-4"}),onClick:()=>l(!i),className:"text-gray-400 hover:text-gray-600"})]})}var eg=e.i(312361),e_=e.i(291542),eh=e.i(761911);let{Title:ex,Text:ef}=f.Typography;function ey({roleMappings:e}){if(!e)return null;let s=[{title:"Role",dataIndex:"role",key:"role",render:e=>(0,t.jsx)(ef,{strong:!0,children:Z[e]})},{title:"Mapped Groups",dataIndex:"groups",key:"groups",render:e=>(0,t.jsx)(t.Fragment,{children:e.length>0?e.map((e,s)=>(0,t.jsx)(H.Tag,{color:"blue",children:e},s)):(0,t.jsx)(ef,{className:"text-gray-400 italic",children:"No groups mapped"})})}];return(0,t.jsxs)(V.Card,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(eh.Users,{className:"w-6 h-6 text-gray-400 mb-2"}),(0,t.jsx)(ex,{level:3,children:"Role Mappings"})]}),(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(ex,{level:5,children:"Group Claim"}),(0,t.jsx)("div",{children:(0,t.jsx)(ef,{code:!0,children:e.group_claim})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ex,{level:5,children:"Default Role"}),(0,t.jsx)("div",{children:(0,t.jsx)(ef,{strong:!0,children:Z[e.default_role]})})]})]}),(0,t.jsx)(eg.Divider,{}),(0,t.jsx)(e_.Table,{columns:s,dataSource:Object.entries(e.roles).map(([e,t])=>({role:e,groups:t})),pagination:!1,bordered:!0,size:"small",className:"w-full"})]})]})}var ej=e.i(21548);let{Title:eS,Paragraph:ev}=f.Typography;function eb({onAdd:e}){return(0,t.jsx)("div",{className:"bg-white p-12 rounded-lg border border-dashed border-gray-300 text-center w-full",children:(0,t.jsx)(ej.Empty,{image:ej.Empty.PRESENTED_IMAGE_SIMPLE,description:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(eS,{level:4,children:"No SSO Configuration Found"}),(0,t.jsx)(ev,{type:"secondary",className:"max-w-md mx-auto",children:"Configure Single Sign-On (SSO) to enable seamless authentication for your team members using your identity provider."})]}),children:(0,t.jsx)(p.Button,{type:"primary",size:"large",onClick:e,className:"flex items-center gap-2 mx-auto mt-4",children:"Configure SSO"})})})}var eI=e.i(981339),Y=Y;let{Title:eC,Text:eT}=f.Typography;function ew(){return(0,t.jsx)(V.Card,{children:(0,t.jsxs)(K.Space,{direction:"vertical",size:"large",className:"w-full",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(Y.default,{className:"w-6 h-6 text-gray-400"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(eC,{level:3,children:"SSO Configuration"}),(0,t.jsx)(eT,{type:"secondary",children:"Manage Single Sign-On authentication settings"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(eI.Skeleton.Button,{active:!0,size:"default",style:{width:170,height:32}}),(0,t.jsx)(eI.Skeleton.Button,{active:!0,size:"default",style:{width:190,height:32}})]})]}),(0,t.jsxs)(q.Descriptions,{bordered:!0,...{column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1}},children:[(0,t.jsx)(q.Descriptions.Item,{label:(0,t.jsx)(eI.Skeleton.Node,{active:!0,style:{width:80,height:16}}),children:(0,t.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:(0,t.jsx)(eI.Skeleton.Node,{active:!0,style:{width:100,height:16}})})}),(0,t.jsx)(q.Descriptions.Item,{label:(0,t.jsx)(eI.Skeleton.Node,{active:!0,style:{width:80,height:16}}),children:(0,t.jsx)(eI.Skeleton.Node,{active:!0,style:{width:200,height:16}})}),(0,t.jsx)(q.Descriptions.Item,{label:(0,t.jsx)(eI.Skeleton.Node,{active:!0,style:{width:80,height:16}}),children:(0,t.jsx)(eI.Skeleton.Node,{active:!0,style:{width:250,height:16}})}),(0,t.jsx)(q.Descriptions.Item,{label:(0,t.jsx)(eI.Skeleton.Node,{active:!0,style:{width:80,height:16}}),children:(0,t.jsx)(eI.Skeleton.Node,{active:!0,style:{width:180,height:16}})}),(0,t.jsx)(q.Descriptions.Item,{label:(0,t.jsx)(eI.Skeleton.Node,{active:!0,style:{width:80,height:16}}),children:(0,t.jsx)(eI.Skeleton.Node,{active:!0,style:{width:220,height:16}})})]})]})})}let{Title:ek,Text:eN}=f.Typography;function eE(){let{data:e,refetch:s,isLoading:i}=G(),[l,r]=(0,y.useState)(!1),[n,a]=(0,y.useState)(!1),[o,c]=(0,y.useState)(!1),d=!!e?.values.google_client_id||!!e?.values.microsoft_client_id||!!e?.values.generic_client_id,u=e?.values?en(e.values):null,m=!!e?.values.role_mappings,g=!!e?.values.team_mappings,_=e=>(0,t.jsx)(eN,{className:"font-mono text-gray-600 text-sm",copyable:!!e,children:e||"-"}),h=e=>e||(0,t.jsx)("span",{className:"text-gray-400 italic",children:"Not configured"}),x=e=>e.team_mappings?.team_ids_jwt_field?(0,t.jsx)(H.Tag,{children:e.team_mappings.team_ids_jwt_field}):(0,t.jsx)("span",{className:"text-gray-400 italic",children:"Not configured"}),f={column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1}},j={google:{providerText:Q.google,fields:[{label:"Client ID",render:e=>(0,t.jsx)(ep,{value:e.google_client_id})},{label:"Client Secret",render:e=>(0,t.jsx)(ep,{value:e.google_client_secret})},{label:"Proxy Base URL",render:e=>h(e.proxy_base_url)}]},microsoft:{providerText:Q.microsoft,fields:[{label:"Client ID",render:e=>(0,t.jsx)(ep,{value:e.microsoft_client_id})},{label:"Client Secret",render:e=>(0,t.jsx)(ep,{value:e.microsoft_client_secret})},{label:"Tenant",render:e=>h(e.microsoft_tenant)},{label:"Proxy Base URL",render:e=>h(e.proxy_base_url)}]},okta:{providerText:Q.okta,fields:[{label:"Client ID",render:e=>(0,t.jsx)(ep,{value:e.generic_client_id})},{label:"Client Secret",render:e=>(0,t.jsx)(ep,{value:e.generic_client_secret})},{label:"Authorization Endpoint",render:e=>_(e.generic_authorization_endpoint)},{label:"Token Endpoint",render:e=>_(e.generic_token_endpoint)},{label:"User Info Endpoint",render:e=>_(e.generic_userinfo_endpoint)},{label:"Proxy Base URL",render:e=>h(e.proxy_base_url)},g?{label:"Team IDs JWT Field",render:e=>x(e)}:null]},generic:{providerText:Q.generic,fields:[{label:"Client ID",render:e=>(0,t.jsx)(ep,{value:e.generic_client_id})},{label:"Client Secret",render:e=>(0,t.jsx)(ep,{value:e.generic_client_secret})},{label:"Authorization Endpoint",render:e=>_(e.generic_authorization_endpoint)},{label:"Token Endpoint",render:e=>_(e.generic_token_endpoint)},{label:"User Info Endpoint",render:e=>_(e.generic_userinfo_endpoint)},{label:"Proxy Base URL",render:e=>h(e.proxy_base_url)},g?{label:"Team IDs JWT Field",render:e=>x(e)}:null]}};return(0,t.jsxs)(t.Fragment,{children:[i?(0,t.jsx)(ew,{}):(0,t.jsxs)(K.Space,{direction:"vertical",size:"large",className:"w-full",children:[(0,t.jsx)(V.Card,{children:(0,t.jsxs)(K.Space,{direction:"vertical",size:"large",className:"w-full",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(Y.default,{className:"w-6 h-6 text-gray-400"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ek,{level:3,children:"SSO Configuration"}),(0,t.jsx)(eN,{type:"secondary",children:"Manage Single Sign-On authentication settings"})]})]}),(0,t.jsx)("div",{className:"flex items-center gap-3",children:d&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Button,{icon:(0,t.jsx)(W.Edit,{className:"w-4 h-4"}),onClick:()=>c(!0),children:"Edit SSO Settings"}),(0,t.jsx)(p.Button,{danger:!0,icon:(0,t.jsx)($.Trash2,{className:"w-4 h-4"}),onClick:()=>r(!0),children:"Delete SSO Settings"})]})})]}),d?(()=>{if(!e?.values||!u)return null;let{values:s}=e,i=j[u];return i?(0,t.jsxs)(q.Descriptions,{bordered:!0,...f,children:[(0,t.jsx)(q.Descriptions.Item,{label:"Provider",children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[J[u]&&(0,t.jsx)("img",{src:J[u],alt:u,style:{height:24,width:24,objectFit:"contain"}}),(0,t.jsx)("span",{children:i.providerText})]})}),i.fields.map((e,i)=>e&&(0,t.jsx)(q.Descriptions.Item,{label:e.label,children:e.render(s)},i))]}):null})():(0,t.jsx)(eb,{onAdd:()=>a(!0)})]})}),m&&(0,t.jsx)(ey,{roleMappings:e?.values.role_mappings})]}),(0,t.jsx)(ec,{isVisible:l,onCancel:()=>r(!1),onSuccess:()=>s()}),(0,t.jsx)(ea,{isVisible:n,onCancel:()=>a(!1),onSuccess:()=>{a(!1),s()}}),(0,t.jsx)(ed,{isVisible:o,onCancel:()=>c(!1),onSuccess:()=>{c(!1),s()}})]})}var eO=e.i(292639),eF=e.i(912598);let eA=(0,D.createQueryKeys)("uiSettings");var eP=e.i(111672);let eM={"api-keys":"Manage virtual keys for API access and authentication","llm-playground":"Interactive playground for testing LLM requests",models:"Configure and manage LLM models and endpoints",agents:"Create and manage AI agents","mcp-servers":"Configure Model Context Protocol servers",guardrails:"Set up content moderation and safety guardrails",policies:"Define access control and usage policies","search-tools":"Configure RAG search and retrieval tools","vector-stores":"Manage vector databases for embeddings",new_usage:"View usage analytics and metrics",logs:"Access request and response logs","guardrails-monitor":"Monitor guardrail performance and view logs",users:"Manage internal user accounts and permissions",teams:"Create and manage teams for access control",organizations:"Manage organizations and their members","access-groups":"Manage access groups for role-based permissions",budgets:"Set and monitor spending budgets",api_ref:"Browse API documentation and endpoints","model-hub-table":"Explore available AI models and providers","learning-resources":"Access tutorials and documentation",caching:"Configure response caching settings","transform-request":"Set up request transformation rules","cost-tracking":"Track and analyze API costs","ui-theme":"Customize dashboard appearance","tag-management":"Organize resources with tags",prompts:"Manage and version prompt templates","claude-code-plugins":"Configure Claude Code plugins",usage:"View legacy usage dashboard","router-settings":"Configure routing and load balancing settings","logging-and-alerts":"Set up logging and alert configurations","admin-panel":"Access admin panel and settings"};var eU=e.i(708347);let eR=e=>!e||0===e.length||e.some(e=>eU.internalUserRoles.includes(e));var eB=e.i(362024);function ez({enabledPagesInternalUsers:e,enabledPagesPropertyDescription:s,isUpdating:i,onUpdate:l}){let r=null!=e,n=(0,y.useMemo)(()=>{let e;return e=[],eP.menuGroups.forEach(t=>{t.items.forEach(s=>{if(s.page&&"tools"!==s.page&&"experimental"!==s.page&&"settings"!==s.page&&eR(s.roles)){let i="string"==typeof s.label?s.label:s.key;e.push({page:s.page,label:i,group:t.groupLabel,description:eM[s.page]||"No description available"})}if(s.children){let i="string"==typeof s.label?s.label:s.key;s.children.forEach(s=>{if(eR(s.roles)){let l="string"==typeof s.label?s.label:s.key;e.push({page:s.page,label:l,group:`${t.groupLabel} > ${i}`,description:eM[s.page]||"No description available"})}})}})}),e},[]),a=(0,y.useMemo)(()=>{let e={};return n.forEach(t=>{e[t.group]||(e[t.group]=[]),e[t.group].push(t)}),e},[n]),[o,c]=(0,y.useState)(e||[]);return(0,y.useMemo)(()=>{e?c(e):c([])},[e]),(0,t.jsxs)(K.Space,{direction:"vertical",size:"middle",style:{width:"100%"},children:[(0,t.jsxs)(K.Space,{direction:"vertical",size:4,children:[(0,t.jsxs)(K.Space,{align:"center",children:[(0,t.jsx)(f.Typography.Text,{strong:!0,children:"Internal User Page Visibility"}),!r&&(0,t.jsx)(H.Tag,{color:"default",style:{marginLeft:"8px"},children:"Not set (all pages visible)"}),r&&(0,t.jsxs)(H.Tag,{color:"blue",style:{marginLeft:"8px"},children:[o.length," page",1!==o.length?"s":""," selected"]})]}),s&&(0,t.jsx)(f.Typography.Text,{type:"secondary",children:s}),(0,t.jsx)(f.Typography.Text,{type:"secondary",style:{fontSize:"12px",fontStyle:"italic"},children:"By default, all pages are visible to internal users. Select specific pages to restrict visibility."}),(0,t.jsx)(f.Typography.Text,{type:"secondary",style:{fontSize:"12px",color:"#8b5cf6"},children:"Note: Only pages accessible to internal user roles are shown here. Admin-only pages are excluded as they cannot be made visible to internal users regardless of this setting."})]}),(0,t.jsx)(eB.Collapse,{items:[{key:"page-visibility",label:"Configure Page Visibility",children:(0,t.jsxs)(K.Space,{direction:"vertical",size:"middle",style:{width:"100%"},children:[(0,t.jsx)(X.Checkbox.Group,{value:o,onChange:c,style:{width:"100%"},children:(0,t.jsx)(K.Space,{direction:"vertical",size:"middle",style:{width:"100%"},children:Object.entries(a).map(([e,s])=>(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Typography.Text,{strong:!0,style:{fontSize:"11px",color:"#6b7280",letterSpacing:"0.05em",display:"block",marginBottom:"8px"},children:e}),(0,t.jsx)(K.Space,{direction:"vertical",size:"small",style:{marginLeft:"16px",width:"100%"},children:s.map(e=>(0,t.jsx)("div",{style:{marginBottom:"4px"},children:(0,t.jsx)(X.Checkbox,{value:e.page,children:(0,t.jsxs)(K.Space,{direction:"vertical",size:0,children:[(0,t.jsx)(f.Typography.Text,{children:e.label}),(0,t.jsx)(f.Typography.Text,{type:"secondary",style:{fontSize:"12px"},children:e.description})]})})},e.page))})]},e))})}),(0,t.jsxs)(K.Space,{children:[(0,t.jsx)(p.Button,{type:"primary",onClick:()=>{l({enabled_ui_pages_internal_users:o.length>0?o:null})},loading:i,disabled:i,children:"Save Page Visibility Settings"}),r&&(0,t.jsx)(p.Button,{onClick:()=>{c([]),l({enabled_ui_pages_internal_users:null})},loading:i,disabled:i,children:"Reset to Default (All Pages)"})]})]})}]})]})}var eD=e.i(790848);function eL(){let e,{accessToken:i}=(0,s.default)(),{data:l,isLoading:r,isError:n,error:a}=(0,eO.useUISettings)(),{mutate:o,isPending:c,error:d}=(e=(0,eF.useQueryClient)(),(0,ei.useMutation)({mutationFn:async e=>{if(!i)throw Error("Access token is required");return(0,v.updateUiSettings)(i,e)},onSuccess:()=>{e.invalidateQueries({queryKey:eA.all})}})),u=l?.field_schema,p=u?.properties?.disable_model_add_for_internal_users,g=u?.properties?.disable_team_admin_delete_team_user,_=u?.properties?.require_auth_for_public_ai_hub,h=u?.properties?.forward_client_headers_to_llm_api,x=u?.properties?.enabled_ui_pages_internal_users,y=l?.values??{},j=!!y.disable_model_add_for_internal_users,b=!!y.disable_team_admin_delete_team_user;return(0,t.jsx)(V.Card,{title:"UI Settings",children:r?(0,t.jsx)(eI.Skeleton,{active:!0}):n?(0,t.jsx)(m.Alert,{type:"error",message:"Could not load UI settings",description:a instanceof Error?a.message:void 0}):(0,t.jsxs)(K.Space,{direction:"vertical",size:"large",style:{width:"100%"},children:[u?.description&&(0,t.jsx)(f.Typography.Paragraph,{style:{marginBottom:0},children:u.description}),d&&(0,t.jsx)(m.Alert,{type:"error",message:"Could not update UI settings",description:d instanceof Error?d.message:void 0}),(0,t.jsxs)(K.Space,{align:"start",size:"middle",children:[(0,t.jsx)(eD.Switch,{checked:j,disabled:c,loading:c,onChange:e=>{o({disable_model_add_for_internal_users:e},{onSuccess:()=>{S.default.success("UI settings updated successfully")},onError:e=>{S.default.fromBackend(e)}})},"aria-label":p?.description??"Disable model add for internal users"}),(0,t.jsxs)(K.Space,{direction:"vertical",size:4,children:[(0,t.jsx)(f.Typography.Text,{strong:!0,children:"Disable model add for internal users"}),p?.description&&(0,t.jsx)(f.Typography.Text,{type:"secondary",children:p.description})]})]}),(0,t.jsxs)(K.Space,{align:"start",size:"middle",children:[(0,t.jsx)(eD.Switch,{checked:b,disabled:c,loading:c,onChange:e=>{o({disable_team_admin_delete_team_user:e},{onSuccess:()=>{S.default.success("UI settings updated successfully")},onError:e=>{S.default.fromBackend(e)}})},"aria-label":g?.description??"Disable team admin delete team user"}),(0,t.jsxs)(K.Space,{direction:"vertical",size:4,children:[(0,t.jsx)(f.Typography.Text,{strong:!0,children:"Disable team admin delete team user"}),g?.description&&(0,t.jsx)(f.Typography.Text,{type:"secondary",children:g.description})]})]}),(0,t.jsxs)(K.Space,{align:"start",size:"middle",children:[(0,t.jsx)(eD.Switch,{checked:y.require_auth_for_public_ai_hub,disabled:c,loading:c,onChange:e=>{o({require_auth_for_public_ai_hub:e},{onSuccess:()=>{S.default.success("UI settings updated successfully")},onError:e=>{S.default.fromBackend(e)}})},"aria-label":_?.description??"Require authentication for public AI Hub"}),(0,t.jsxs)(K.Space,{direction:"vertical",size:4,children:[(0,t.jsx)(f.Typography.Text,{strong:!0,children:"Require authentication for public AI Hub"}),_?.description&&(0,t.jsx)(f.Typography.Text,{type:"secondary",children:_.description})]})]}),(0,t.jsxs)(K.Space,{align:"start",size:"middle",children:[(0,t.jsx)(eD.Switch,{checked:!!y.forward_client_headers_to_llm_api,disabled:c,loading:c,onChange:e=>{o({forward_client_headers_to_llm_api:e},{onSuccess:()=>{S.default.success("UI settings updated successfully")},onError:e=>{S.default.fromBackend(e)}})},"aria-label":h?.description??"Forward client headers to LLM API"}),(0,t.jsxs)(K.Space,{direction:"vertical",size:4,children:[(0,t.jsx)(f.Typography.Text,{strong:!0,children:"Forward client headers to LLM API"}),(0,t.jsx)(f.Typography.Text,{type:"secondary",children:h?.description??"If enabled, forwards client headers (e.g. Authorization) to the LLM API. Required for Claude Code with Max subscription."})]})]}),(0,t.jsx)(eg.Divider,{}),(0,t.jsx)(ez,{enabledPagesInternalUsers:y.enabled_ui_pages_internal_users,enabledPagesPropertyDescription:x?.description,isUpdating:c,onUpdate:e=>{o(e,{onSuccess:()=>{S.default.success("Page visibility settings updated successfully")},onError:e=>{S.default.fromBackend(e)}})}})]})})}let eG={google:"https://artificialanalysis.ai/img/logos/google_small.svg",microsoft:"https://upload.wikimedia.org/wikipedia/commons/a/a8/Microsoft_Azure_Logo.svg",okta:"https://www.okta.com/sites/default/files/Okta_Logo_BrightBlue_Medium.png",generic:""},eV={google:{envVarMap:{google_client_id:"GOOGLE_CLIENT_ID",google_client_secret:"GOOGLE_CLIENT_SECRET"},fields:[{label:"Google Client ID",name:"google_client_id"},{label:"Google Client Secret",name:"google_client_secret"}]},microsoft:{envVarMap:{microsoft_client_id:"MICROSOFT_CLIENT_ID",microsoft_client_secret:"MICROSOFT_CLIENT_SECRET",microsoft_tenant:"MICROSOFT_TENANT"},fields:[{label:"Microsoft Client ID",name:"microsoft_client_id"},{label:"Microsoft Client Secret",name:"microsoft_client_secret"},{label:"Microsoft Tenant",name:"microsoft_tenant"}]},okta:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"Generic Client ID",name:"generic_client_id"},{label:"Generic Client Secret",name:"generic_client_secret"},{label:"Authorization Endpoint",name:"generic_authorization_endpoint",placeholder:"https://your-domain/authorize"},{label:"Token Endpoint",name:"generic_token_endpoint",placeholder:"https://your-domain/token"},{label:"Userinfo Endpoint",name:"generic_userinfo_endpoint",placeholder:"https://your-domain/userinfo"}]},generic:{envVarMap:{generic_client_id:"GENERIC_CLIENT_ID",generic_client_secret:"GENERIC_CLIENT_SECRET",generic_authorization_endpoint:"GENERIC_AUTHORIZATION_ENDPOINT",generic_token_endpoint:"GENERIC_TOKEN_ENDPOINT",generic_userinfo_endpoint:"GENERIC_USERINFO_ENDPOINT"},fields:[{label:"Generic Client ID",name:"generic_client_id"},{label:"Generic Client Secret",name:"generic_client_secret"},{label:"Authorization Endpoint",name:"generic_authorization_endpoint"},{label:"Token Endpoint",name:"generic_token_endpoint"},{label:"Userinfo Endpoint",name:"generic_userinfo_endpoint"}]}},eq=({isAddSSOModalVisible:e,isInstructionsModalVisible:s,handleAddSSOOk:i,handleAddSSOCancel:l,handleShowInstructions:r,handleInstructionsOk:n,handleInstructionsCancel:a,form:o,accessToken:c,ssoConfigured:d=!1})=>{let[u,m]=(0,y.useState)(!1);(0,y.useEffect)(()=>{(async()=>{if(e&&c)try{let e=await (0,v.getSSOSettings)(c);if(console.log("Raw SSO data received:",e),e&&e.values){console.log("SSO values:",e.values),console.log("user_email from API:",e.values.user_email);let t=null;e.values.google_client_id?t="google":e.values.microsoft_client_id?t="microsoft":e.values.generic_client_id&&(t=e.values.generic_authorization_endpoint?.includes("okta")||e.values.generic_authorization_endpoint?.includes("auth0")?"okta":"generic");let s={};if(e.values.role_mappings){let t=e.values.role_mappings,i=e=>e&&0!==e.length?e.join(", "):"";s={use_role_mappings:!0,group_claim:t.group_claim,default_role:t.default_role||"internal_user",proxy_admin_teams:i(t.roles?.proxy_admin),admin_viewer_teams:i(t.roles?.proxy_admin_viewer),internal_user_teams:i(t.roles?.internal_user),internal_viewer_teams:i(t.roles?.internal_user_viewer)}}let i={sso_provider:t,proxy_base_url:e.values.proxy_base_url,user_email:e.values.user_email,...e.values,...s};console.log("Setting form values:",i),o.resetFields(),setTimeout(()=>{o.setFieldsValue(i),console.log("Form values set, current form values:",o.getFieldsValue())},100)}}catch(e){console.error("Failed to load SSO settings:",e)}})()},[e,c,o]);let x=async e=>{if(!c)return void S.default.fromBackend("No access token available");try{let{proxy_admin_teams:t,admin_viewer_teams:s,internal_user_teams:i,internal_viewer_teams:l,default_role:n,group_claim:a,use_role_mappings:o,...d}=e,u={...d};if(o){let e=e=>e&&""!==e.trim()?e.split(",").map(e=>e.trim()).filter(e=>e.length>0):[];u.role_mappings={provider:"generic",group_claim:a,default_role:({internal_user_viewer:"internal_user_viewer",internal_user:"internal_user",proxy_admin_viewer:"proxy_admin_viewer",proxy_admin:"proxy_admin"})[n]||"internal_user",roles:{proxy_admin:e(t),proxy_admin_viewer:e(s),internal_user:e(i),internal_user_viewer:e(l)}}}await (0,v.updateSSOSettings)(c,u),r(e)}catch(e){S.default.fromBackend("Failed to save SSO settings: "+(0,R.parseErrorMessage)(e))}},f=async()=>{if(!c)return void S.default.fromBackend("No access token available");try{await (0,v.updateSSOSettings)(c,{google_client_id:null,google_client_secret:null,microsoft_client_id:null,microsoft_client_secret:null,microsoft_tenant:null,generic_client_id:null,generic_client_secret:null,generic_authorization_endpoint:null,generic_token_endpoint:null,generic_userinfo_endpoint:null,proxy_base_url:null,user_email:null,sso_provider:null,role_mappings:null}),o.resetFields(),m(!1),i(),S.default.success("SSO settings cleared successfully")}catch(e){console.error("Failed to clear SSO settings:",e),S.default.fromBackend("Failed to clear SSO settings")}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Modal,{title:d?"Edit SSO Settings":"Add SSO",open:e,width:800,footer:null,onOk:i,onCancel:l,children:(0,t.jsxs)(g.Form,{form:o,onFinish:x,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Form.Item,{label:"SSO Provider",name:"sso_provider",rules:[{required:!0,message:"Please select an SSO provider"}],children:(0,t.jsx)(ee.Select,{children:Object.entries(eG).map(([e,s])=>(0,t.jsx)(ee.Select.Option,{value:e,children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 0"},children:[s&&(0,t.jsx)("img",{src:s,alt:e,style:{height:24,width:24,marginRight:12,objectFit:"contain"}}),(0,t.jsxs)("span",{children:["okta"===e.toLowerCase()?"Okta / Auth0":e.charAt(0).toUpperCase()+e.slice(1)," ","SSO"]})]})},e))})}),(0,t.jsx)(g.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.sso_provider!==t.sso_provider,children:({getFieldValue:e})=>{let s,i=e("sso_provider");return i&&(s=eV[i])?s.fields.map(e=>(0,t.jsx)(g.Form.Item,{label:e.label,name:e.name,rules:[{required:!0,message:`Please enter the ${e.label.toLowerCase()}`}],children:e.name.includes("client")?(0,t.jsx)(_.Input.Password,{}):(0,t.jsx)(T.TextInput,{placeholder:e.placeholder})},e.name)):null}}),(0,t.jsx)(g.Form.Item,{label:"Proxy Admin Email",name:"user_email",rules:[{required:!0,message:"Please enter the email of the proxy admin"}],children:(0,t.jsx)(T.TextInput,{})}),(0,t.jsx)(g.Form.Item,{label:"Proxy Base URL",name:"proxy_base_url",normalize:e=>e?.trim(),rules:[{required:!0,message:"Please enter the proxy base url"},{pattern:/^https?:\/\/.+/,message:"URL must start with http:// or https://"},{validator:(e,t)=>t&&/^https?:\/\/.+/.test(t)&&t.endsWith("/")?Promise.reject("URL must not end with a trailing slash"):Promise.resolve()}],children:(0,t.jsx)(T.TextInput,{placeholder:"https://example.com"})}),(0,t.jsx)(g.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.sso_provider!==t.sso_provider,children:({getFieldValue:e})=>{let s=e("sso_provider");return"okta"===s||"generic"===s?(0,t.jsx)(g.Form.Item,{label:"Use Role Mappings",name:"use_role_mappings",valuePropName:"checked",children:(0,t.jsx)(X.Checkbox,{})}):null}}),(0,t.jsx)(g.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.use_role_mappings!==t.use_role_mappings,children:({getFieldValue:e})=>e("use_role_mappings")?(0,t.jsx)(g.Form.Item,{label:"Group Claim",name:"group_claim",rules:[{required:!0,message:"Please enter the group claim"}],children:(0,t.jsx)(T.TextInput,{})}):null}),(0,t.jsx)(g.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.use_role_mappings!==t.use_role_mappings,children:({getFieldValue:e})=>e("use_role_mappings")?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Form.Item,{label:"Default Role",name:"default_role",initialValue:"Internal User",children:(0,t.jsxs)(ee.Select,{children:[(0,t.jsx)(ee.Select.Option,{value:"internal_user_viewer",children:"Internal Viewer"}),(0,t.jsx)(ee.Select.Option,{value:"internal_user",children:"Internal User"}),(0,t.jsx)(ee.Select.Option,{value:"proxy_admin_viewer",children:"Admin Viewer"}),(0,t.jsx)(ee.Select.Option,{value:"proxy_admin",children:"Proxy Admin"})]})}),(0,t.jsx)(g.Form.Item,{label:"Proxy Admin Teams",name:"proxy_admin_teams",children:(0,t.jsx)(T.TextInput,{})}),(0,t.jsx)(g.Form.Item,{label:"Admin Viewer Teams",name:"admin_viewer_teams",children:(0,t.jsx)(T.TextInput,{})}),(0,t.jsx)(g.Form.Item,{label:"Internal User Teams",name:"internal_user_teams",children:(0,t.jsx)(T.TextInput,{})}),(0,t.jsx)(g.Form.Item,{label:"Internal Viewer Teams",name:"internal_viewer_teams",children:(0,t.jsx)(T.TextInput,{})})]}):null})]}),(0,t.jsxs)("div",{style:{textAlign:"right",marginTop:"10px",display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"8px"},children:[d&&(0,t.jsx)(p.Button,{onClick:()=>m(!0),style:{backgroundColor:"#6366f1",borderColor:"#6366f1",color:"white"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#5558eb",e.currentTarget.style.borderColor="#5558eb"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#6366f1",e.currentTarget.style.borderColor="#6366f1"},children:"Clear"}),(0,t.jsx)(p.Button,{htmlType:"submit",children:"Save"})]})]})}),(0,t.jsxs)(h.Modal,{title:"Confirm Clear SSO Settings",open:u,onOk:f,onCancel:()=>m(!1),okText:"Yes, Clear",cancelText:"Cancel",okButtonProps:{danger:!0,style:{backgroundColor:"#dc2626",borderColor:"#dc2626"}},children:[(0,t.jsx)("p",{children:"Are you sure you want to clear all SSO settings? This action cannot be undone."}),(0,t.jsx)("p",{children:"Users will no longer be able to login using SSO after this change."})]}),(0,t.jsxs)(h.Modal,{title:"SSO Setup Instructions",open:s,width:800,footer:null,onOk:n,onCancel:a,children:[(0,t.jsx)("p",{children:"Follow these steps to complete the SSO setup:"}),(0,t.jsx)(I.Text,{className:"mt-2",children:"1. DO NOT Exit this TAB"}),(0,t.jsx)(I.Text,{className:"mt-2",children:"2. Open a new tab, visit your proxy base url"}),(0,t.jsx)(I.Text,{className:"mt-2",children:"3. Confirm your SSO is configured correctly and you can login on the new Tab"}),(0,t.jsx)(I.Text,{className:"mt-2",children:"4. If Step 3 is successful, you can close this tab"}),(0,t.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:(0,t.jsx)(p.Button,{onClick:n,children:"Done"})})]})]})},eK=({accessToken:e,onSuccess:s})=>{let[i]=g.Form.useForm(),[l,r]=(0,y.useState)(!1);(0,y.useEffect)(()=>{(async()=>{if(e)try{let t=await (0,v.getSSOSettings)(e);if(t&&t.values){let e=t.values.ui_access_mode,s={};e&&"object"==typeof e?s={ui_access_mode_type:e.type,restricted_sso_group:e.restricted_sso_group,sso_group_jwt_field:e.sso_group_jwt_field}:"string"==typeof e&&(s={ui_access_mode_type:e,restricted_sso_group:t.values.restricted_sso_group,sso_group_jwt_field:t.values.team_ids_jwt_field||t.values.sso_group_jwt_field}),i.setFieldsValue(s)}}catch(e){console.error("Failed to load UI access settings:",e)}})()},[e,i]);let n=async t=>{if(!e)return void S.default.fromBackend("No access token available");r(!0);try{let i;i="all_authenticated_users"===t.ui_access_mode_type?{ui_access_mode:"none"}:{ui_access_mode:{type:t.ui_access_mode_type,restricted_sso_group:t.restricted_sso_group,sso_group_jwt_field:t.sso_group_jwt_field}},await (0,v.updateSSOSettings)(e,i),s()}catch(e){console.error("Failed to save UI access settings:",e),S.default.fromBackend("Failed to save UI access settings")}finally{r(!1)}};return(0,t.jsxs)("div",{style:{padding:"16px"},children:[(0,t.jsx)("div",{style:{marginBottom:"16px"},children:(0,t.jsx)(I.Text,{style:{fontSize:"14px",color:"#6b7280"},children:"Configure who can access the UI interface and how group information is extracted from JWT tokens."})}),(0,t.jsxs)(g.Form,{form:i,onFinish:n,layout:"vertical",children:[(0,t.jsx)(g.Form.Item,{label:"UI Access Mode",name:"ui_access_mode_type",tooltip:"Controls who can access the UI interface",children:(0,t.jsxs)(ee.Select,{placeholder:"Select access mode",children:[(0,t.jsx)(ee.Select.Option,{value:"all_authenticated_users",children:"All Authenticated Users"}),(0,t.jsx)(ee.Select.Option,{value:"restricted_sso_group",children:"Restricted SSO Group"})]})}),(0,t.jsx)(g.Form.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.ui_access_mode_type!==t.ui_access_mode_type,children:({getFieldValue:e})=>"restricted_sso_group"===e("ui_access_mode_type")?(0,t.jsx)(g.Form.Item,{label:"Restricted SSO Group",name:"restricted_sso_group",rules:[{required:!0,message:"Please enter the restricted SSO group"}],children:(0,t.jsx)(T.TextInput,{placeholder:"ui-access-group"})}):null}),(0,t.jsx)(g.Form.Item,{label:"SSO Group JWT Field",name:"sso_group_jwt_field",tooltip:"JWT field name that contains team/group information. Use dot notation to access nested fields.",children:(0,t.jsx)(T.TextInput,{placeholder:"groups"})}),(0,t.jsx)("div",{style:{textAlign:"right",marginTop:"16px"},children:(0,t.jsx)(p.Button,{type:"primary",htmlType:"submit",loading:l,style:{backgroundColor:"#6366f1",borderColor:"#6366f1"},children:"Update UI Access Control"})})]})]})},{Title:eH,Paragraph:eW,Text:eY}=f.Typography;e.s(["default",0,({proxySettings:e})=>{let{premiumUser:f,accessToken:b,userId:I}=(0,s.default)(),[C]=g.Form.useForm(),[T,w]=(0,y.useState)(!1),[k,N]=(0,y.useState)(!1),[E,O]=(0,y.useState)(!1),[F,A]=(0,y.useState)(!1),[P,M]=(0,y.useState)(!1),[U,R]=(0,y.useState)(!1),[z,D]=(0,y.useState)([]),[L,G]=(0,y.useState)(null),[V,q]=(0,y.useState)(!1),K=(0,j.useBaseUrl)(),H="All IP Addresses Allowed",W=K;W+="/fallback/login";let Y=async()=>{if(b)try{let e=await (0,v.getSSOSettings)(b);if(e&&e.values){let t=e.values.google_client_id&&e.values.google_client_secret,s=e.values.microsoft_client_id&&e.values.microsoft_client_secret,i=e.values.generic_client_id&&e.values.generic_client_secret;q(t||s||i)}else q(!1)}catch(e){console.error("Error checking SSO configuration:",e),q(!1)}},$=async()=>{try{if(!0!==f)return void S.default.fromBackend("This feature is only available for premium users. Please upgrade your account.");if(b){let e=await (0,v.getAllowedIPs)(b);D(e&&e.length>0?e:[H])}else D([H])}catch(e){console.error("Error fetching allowed IPs:",e),S.default.fromBackend(`Failed to fetch allowed IPs ${e}`),D([H])}finally{!0===f&&O(!0)}},J=async e=>{try{if(b){await (0,v.addAllowedIP)(b,e.ip);let t=await (0,v.getAllowedIPs)(b);D(t),S.default.success("IP address added successfully")}}catch(e){console.error("Error adding IP:",e),S.default.fromBackend(`Failed to add IP address ${e}`)}finally{A(!1)}},Q=async e=>{G(e),M(!0)},Z=async()=>{if(L&&b)try{await (0,v.deleteAllowedIP)(b,L);let e=await (0,v.getAllowedIPs)(b);D(e.length>0?e:[H]),S.default.success("IP address deleted successfully")}catch(e){console.error("Error deleting IP:",e),S.default.fromBackend(`Failed to delete IP address ${e}`)}finally{M(!1),G(null)}};(0,y.useEffect)(()=>{Y()},[b,f,Y]);let X=()=>{R(!1)},ee=[{key:"sso-settings",label:"SSO Settings",children:(0,t.jsx)(eE,{})},{key:"security-settings",label:"Security Settings",children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(eH,{level:4,children:" âœ¨ Security Settings"}),(0,t.jsx)(m.Alert,{message:"SSO Configuration Deprecated",description:"Editing SSO Settings on this page is deprecated and will be removed in a future version. Please use the SSO Settings tab for SSO configuration.",type:"warning",showIcon:!0}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginTop:"1rem",marginLeft:"0.5rem"},children:[(0,t.jsx)("div",{children:(0,t.jsx)(i.Button,{style:{width:"150px"},onClick:()=>w(!0),children:V?"Edit SSO Settings":"Add SSO"})}),(0,t.jsx)("div",{children:(0,t.jsx)(i.Button,{style:{width:"150px"},onClick:$,children:"Allowed IPs"})}),(0,t.jsx)("div",{children:(0,t.jsx)(i.Button,{style:{width:"150px"},onClick:()=>!0===f?R(!0):S.default.fromBackend("Only premium users can configure UI access control"),children:"UI Access Control"})})]})]}),(0,t.jsxs)("div",{className:"flex justify-start mb-4",children:[(0,t.jsx)(eq,{isAddSSOModalVisible:T,isInstructionsModalVisible:k,handleAddSSOOk:()=>{w(!1),C.resetFields(),b&&f&&Y()},handleAddSSOCancel:()=>{w(!1),C.resetFields()},handleShowInstructions:e=>{w(!1),N(!0)},handleInstructionsOk:()=>{N(!1),b&&f&&Y()},handleInstructionsCancel:()=>{N(!1),b&&f&&Y()},form:C,accessToken:b,ssoConfigured:V}),(0,t.jsx)(h.Modal,{title:"Manage Allowed IP Addresses",width:800,open:E,onCancel:()=>O(!1),footer:[(0,t.jsx)(i.Button,{className:"mx-1",onClick:()=>A(!0),children:"Add IP Address"},"add"),(0,t.jsx)(i.Button,{onClick:()=>O(!1),children:"Close"},"close")],children:(0,t.jsxs)(n.Table,{children:[(0,t.jsx)(c.TableHead,{children:(0,t.jsxs)(u.TableRow,{children:[(0,t.jsx)(d.TableHeaderCell,{children:"IP Address"}),(0,t.jsx)(d.TableHeaderCell,{className:"text-right",children:"Action"})]})}),(0,t.jsx)(a.TableBody,{children:z.map((e,s)=>(0,t.jsxs)(u.TableRow,{children:[(0,t.jsx)(o.TableCell,{children:e}),(0,t.jsx)(o.TableCell,{className:"text-right",children:e!==H&&(0,t.jsx)(i.Button,{onClick:()=>Q(e),color:"red",size:"xs",children:"Delete"})})]},s))})]})}),(0,t.jsx)(h.Modal,{title:"Add Allowed IP Address",open:F,onCancel:()=>A(!1),footer:null,children:(0,t.jsxs)(g.Form,{onFinish:J,children:[(0,t.jsx)(g.Form.Item,{name:"ip",rules:[{required:!0,message:"Please enter an IP address"}],children:(0,t.jsx)(_.Input,{placeholder:"Enter IP address"})}),(0,t.jsx)(g.Form.Item,{children:(0,t.jsx)(p.Button,{htmlType:"submit",children:"Add IP Address"})})]})}),(0,t.jsx)(h.Modal,{title:"Confirm Delete",open:P,onCancel:()=>M(!1),onOk:Z,footer:[(0,t.jsx)(i.Button,{className:"mx-1",onClick:()=>Z(),children:"Yes"},"delete"),(0,t.jsx)(i.Button,{onClick:()=>M(!1),children:"Close"},"close")],children:(0,t.jsxs)(eY,{children:["Are you sure you want to delete the IP address: ",L,"?"]})}),(0,t.jsx)(h.Modal,{title:"UI Access Control Settings",open:U,width:600,footer:null,onOk:X,onCancel:()=>{R(!1)},children:(0,t.jsx)(eK,{accessToken:b,onSuccess:()=>{X(),S.default.success("UI Access Control settings updated successfully")}})})]}),(0,t.jsxs)(l.Callout,{title:"Login without SSO",color:"teal",children:["If you need to login without sso, you can access"," ",(0,t.jsxs)("a",{href:W,target:"_blank",rel:"noopener noreferrer",children:[(0,t.jsx)("b",{children:W})," "]})]})]})},{key:"scim",label:"SCIM",children:(0,t.jsx)(B,{accessToken:b,userID:I,proxySettings:e})},{key:"ui-settings",label:"UI Settings",children:(0,t.jsx)(eL,{})}];return(0,t.jsxs)("div",{className:"w-full m-2 mt-2 p-8",children:[(0,t.jsx)(eH,{level:4,children:"Admin Access "}),(0,t.jsx)(eW,{children:"Go to 'Internal Users' page to add other admins."}),(0,t.jsx)(x.Tabs,{items:ee})]})}],105278)}]);