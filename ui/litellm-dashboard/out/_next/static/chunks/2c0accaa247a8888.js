(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,903446,e=>{"use strict";let s=(0,e.i(475254).default)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["default",()=>s])},213970,657150,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(220486),l=e.i(727749),r=e.i(447593),n=e.i(955135),i=e.i(91500),o=e.i(646563),d=e.i(464571),c=e.i(311451),m=e.i(199133),u=e.i(592968),x=e.i(422233),h=e.i(761793),g=e.i(964421),p=e.i(254530),v=e.i(689020),f=e.i(921687),y=e.i(953860),j=e.i(903446),j=j,b=e.i(37727),N=e.i(475254);let k=(0,N.default)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);e.s(["default",()=>k],657150);var w=e.i(531278);let T=(0,N.default)("user-round",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]);var A=e.i(918789),S=e.i(650056),C=e.i(219470),L=e.i(843153),P=e.i(966988),M=e.i(989022),R=e.i(152401);function U({messages:e,isLoading:a}){if(0===e.length)return(0,s.jsx)("div",{className:"h-full"});let t=[],l=0;for(;l<e.length;){let s=e[l];if("user"===s.role){let a=e[l+1];if(a?.role==="assistant"){t.push({user:s,assistant:a}),l+=2;continue}t.push({user:s})}else"assistant"===s.role&&t.push({assistant:s});l+=1}let r=e=>(0,s.jsxs)("div",{className:"whitespace-pre-wrap break-words",style:{wordWrap:"break-word",overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},children:[(0,s.jsx)(L.default,{message:e}),(0,s.jsx)(A.default,{components:{code({node:e,inline:a,className:t,children:l,...r}){let n=/language-(\w+)/.exec(t||"");return!a&&n?(0,s.jsx)(S.Prism,{style:C.coy,language:n[1],PreTag:"div",className:"rounded-md my-2",wrapLines:!0,wrapLongLines:!0,...r,children:String(l).replace(/\n$/,"")}):(0,s.jsx)("code",{className:`${t} px-1.5 py-0.5 rounded bg-gray-100 text-sm font-mono`,...r,children:l})},pre:({node:e,...a})=>(0,s.jsx)("pre",{style:{overflowX:"auto",maxWidth:"100%"},...a})},children:"string"==typeof e.content?e.content:""})]});return(0,s.jsxs)("div",{className:"flex flex-col gap-6 min-w-0 w-full p-4",children:[t.map((e,l)=>{let n=e.assistant,i=n?.model||"助手";return(0,s.jsxs)("div",{className:"space-y-4",children:[e.user&&(0,s.jsxs)("div",{className:"space-y-2 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-blue-100 text-blue-600",children:(0,s.jsx)(T,{size:16})}),(0,s.jsx)("div",{className:"text-sm font-semibold text-gray-700",children:"你"})]}),r(e.user)]}),(0,s.jsx)("div",{className:"border-t border-gray-200"}),n?(0,s.jsxs)("div",{className:"space-y-3 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-gray-100 text-gray-600",children:(0,s.jsx)(k,{size:16})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-semibold text-gray-700",children:i}),n.toolName&&(0,s.jsx)("span",{className:"rounded bg-gray-100 px-2 py-0.5 text-xs text-gray-600",children:n.toolName})]})]}),n.reasoningContent&&(0,s.jsx)(P.default,{reasoningContent:n.reasoningContent}),n.searchResults&&(0,s.jsx)(R.SearchResultsDisplay,{searchResults:n.searchResults}),r(n),(n.timeToFirstToken||n.totalLatency||n.usage)&&(0,s.jsx)(M.default,{timeToFirstToken:n.timeToFirstToken,totalLatency:n.totalLatency,usage:n.usage,toolName:n.toolName})]}):a&&l===t.length-1?(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,s.jsx)(w.Loader2,{size:18,className:"animate-spin"}),(0,s.jsx)("span",{children:"正在生成响应..."})]}):(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"等待响应中..."})]},l)}),a&&0===t.length&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,s.jsx)(w.Loader2,{size:18,className:"animate-spin"}),(0,s.jsx)("span",{children:"正在生成响应..."})]})]})}var O=e.i(482725);function I({value:e,options:a,loading:t,config:l,onChange:r}){return(0,s.jsx)(m.Select,{value:e||void 0,placeholder:t?`正在加载${l.selectorLabel}...`:l.selectorPlaceholder,onChange:r,loading:t,showSearch:!0,filterOption:(e,s)=>(s?.label??"").toLowerCase().includes(e.toLowerCase()),options:a,className:"w-48 md:w-64 lg:w-72",notFoundContent:t?(0,s.jsx)("div",{className:"flex items-center justify-center py-2",children:(0,s.jsx)(O.Spin,{size:"small"})}):`暂无可用${l.selectorLabel}`})}var z=e.i(318059),_=e.i(916940),E=e.i(891547),B=e.i(536916),$=e.i(312361),D=e.i(282786),F=e.i(850627);let K="/v1/chat/completions",X="/a2a",q={[K]:{id:K,label:"/v1/chat/completions",selectorType:"model",selectorLabel:"模型",selectorPlaceholder:"选择模型",inputPlaceholder:"发送提示词以对比模型",loadingMessage:"正在汇总所有模型的响应...",validationMessage:"发送消息前请先选择模型。"},[X]:{id:X,label:"/a2a（智能体）",selectorType:"agent",selectorLabel:"智能体",selectorPlaceholder:"选择智能体",inputPlaceholder:"发送消息以对比智能体",loadingMessage:"正在汇总所有智能体的响应...",validationMessage:"发送消息前请先选择智能体。"}},H=e=>"agent"===q[e].selectorType,W=(e,s)=>H(s)?e.agent:e.model;function V({comparison:e,onUpdate:t,onRemove:l,canRemove:r,selectorOptions:n,isLoadingOptions:i,endpointConfig:o,apiKey:d}){let c=H(o.id),m=W(e,o.id),[u,x]=(0,a.useState)(!1),h=(s,a)=>{t({[s]:a},e.applyAcrossModels?{applyToAll:!0,keysToApply:[s]}:void 0)},g=e.useAdvancedParams?1:.4,p=e.useAdvancedParams?"text-gray-700":"text-gray-400",v=(0,s.jsxs)("div",{className:"w-[300px] max-h-[65vh] overflow-y-auto relative",children:[(0,s.jsx)("button",{onClick:()=>{x(!1)},className:"absolute top-0 right-0 p-1 hover:bg-gray-100 rounded transition-colors text-gray-500 hover:text-gray-700 z-10",children:(0,s.jsx)(b.X,{size:14})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(B.Checkbox,{checked:e.applyAcrossModels,onChange:s=>{s.target.checked?t({applyAcrossModels:!0,temperature:e.temperature,maxTokens:e.maxTokens,tags:[...e.tags],vectorStores:[...e.vectorStores],guardrails:[...e.guardrails],useAdvancedParams:e.useAdvancedParams},{applyToAll:!0,keysToApply:["temperature","maxTokens","tags","vectorStores","guardrails","useAdvancedParams"]}):t({applyAcrossModels:!1})},children:(0,s.jsx)("span",{className:"text-xs font-medium",children:"跨模型同步设置"})})}),(0,s.jsx)($.Divider,{className:"border-gray-200"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-wide",children:"通用设置"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-600 block mb-0.5",children:"标签"}),(0,s.jsx)(z.default,{value:e.tags,onChange:e=>h("tags",e),accessToken:d})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-600 block mb-0.5",children:"向量库"}),(0,s.jsx)(_.default,{value:e.vectorStores,onChange:e=>h("vectorStores",e),accessToken:d})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium text-gray-600 block mb-0.5",children:"护栏"}),(0,s.jsx)(E.default,{value:e.guardrails,onChange:e=>h("guardrails",e),accessToken:d})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-wide",children:"高级设置"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"flex items-center gap-2 pb-1",children:(0,s.jsx)(B.Checkbox,{checked:e.useAdvancedParams,onChange:s=>{t({useAdvancedParams:s.target.checked},e.applyAcrossModels?{applyToAll:!0,keysToApply:["useAdvancedParams"]}:void 0)},children:(0,s.jsx)("span",{className:"text-sm font-medium",children:"启用高级参数"})})}),(0,s.jsxs)("div",{className:"space-y-2 transition-opacity duration-200",style:{opacity:g},children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsx)("label",{className:`text-xs font-medium ${p}`,children:"温度"}),(0,s.jsx)("span",{className:`text-xs ${p}`,children:e.temperature.toFixed(2)})]}),(0,s.jsx)(F.Slider,{min:0,max:2,step:.01,value:e.temperature,onChange:e=>{h("temperature",Math.min(2,Math.max(0,Number((Array.isArray(e)?e[0]:e).toFixed(2)))))},disabled:!e.useAdvancedParams})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsx)("label",{className:`text-xs font-medium ${p}`,children:"最大 Tokens"}),(0,s.jsx)("span",{className:`text-xs ${p}`,children:e.maxTokens})]}),(0,s.jsx)(F.Slider,{min:1,max:32768,step:1,value:e.maxTokens,onChange:e=>{h("maxTokens",Math.min(32768,Math.max(1,Math.round(Array.isArray(e)?e[0]:e))))},disabled:!e.useAdvancedParams})]})]})]})]})]})]});return(0,s.jsxs)("div",{className:"bg-white first:border-l-0 border-l border-gray-200 flex flex-col min-h-0",children:[(0,s.jsxs)("div",{className:"border-b flex items-center justify-between gap-3 px-4 py-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,s.jsx)(I,{value:m,options:n,loading:i,config:o,onChange:e=>t(c?{agent:e}:{model:e})}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(D.Popover,{content:v,trigger:[],open:u,onOpenChange:()=>{},placement:"bottomRight",destroyOnHidden:!1,children:(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),x(e=>!e)},className:`p-2 rounded-lg transition-colors ${u?"bg-gray-200 text-gray-700":"hover:bg-gray-100 text-gray-600"}`,children:(0,s.jsx)(j.default,{size:18})})})})]}),r&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),l()},className:"p-2 hover:bg-red-50 text-red-600 rounded-lg transition-colors",children:(0,s.jsx)(b.X,{size:18})})]}),(0,s.jsx)("div",{className:"relative flex-1 flex flex-col min-h-0",children:(0,s.jsx)("div",{className:"flex-1 max-h-[calc(100vh-385px)] overflow-auto rounded-b-2xl",children:(0,s.jsx)(U,{messages:e.messages,isLoading:e.isLoading})})})]})}var Y=e.i(132104);let{TextArea:G}=c.Input;function J({value:e,onChange:a,onSend:t,disabled:l,hasAttachment:r,uploadComponent:n}){let i=!l&&(e.trim().length>0||!!r);return(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("div",{className:"flex items-center flex-1 bg-white border border-gray-300 rounded-xl px-3 py-1 min-h-[44px]",children:[n&&(0,s.jsx)("div",{className:"flex-shrink-0 mr-2",children:n}),(0,s.jsx)(G,{value:e,onChange:e=>a(e.target.value),onKeyDown:e=>{"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),i&&t())},placeholder:"输入你的消息...（Shift+Enter 换行）",disabled:l,className:"flex-1",autoSize:{minRows:1,maxRows:4},style:{resize:"none",border:"none",boxShadow:"none",background:"transparent",padding:"4px 0",fontSize:"14px",lineHeight:"20px"}}),(0,s.jsx)(d.Button,{onClick:t,disabled:!i,icon:(0,s.jsx)(Y.ArrowUpOutlined,{}),shape:"circle"})]})})}let Q=["请总结关键要点。","你做了哪些假设？","下一步建议是什么？"],Z=["写一首诗","解释一下量子计算","帮我起草一封礼貌的会议邀请邮件"];function ee({accessToken:e,disabledPersonalKeyCreation:t}){let[j,b]=(0,a.useState)([{id:"1",model:"",agent:"",messages:[],isLoading:!1,tags:[],mcpTools:[],vectorStores:[],guardrails:[],temperature:1,maxTokens:2048,applyAcrossModels:!1,useAdvancedParams:!1},{id:"2",model:"",agent:"",messages:[],isLoading:!1,tags:[],mcpTools:[],vectorStores:[],guardrails:[],temperature:1,maxTokens:2048,applyAcrossModels:!1,useAdvancedParams:!1}]),[N,k]=(0,a.useState)([]),[w,T]=(0,a.useState)([]),[A,S]=(0,a.useState)(!1),[C,L]=(0,a.useState)(!1),[P,M]=(0,a.useState)(K),R=q[P],U=H(P),O=U?w.map(e=>({value:e.agent_name,label:e.agent_name||e.agent_id})):N.map(e=>({value:e,label:e})),I=U?C:A,[z,_]=(0,a.useState)(""),[E,B]=(0,a.useState)(null),[$,D]=(0,a.useState)(null),[F,X]=(0,a.useState)(t?"custom":"session"),[Y,G]=(0,a.useState)(""),[ee,es]=(0,a.useState)(""),[ea]=(0,a.useState)(()=>sessionStorage.getItem("customProxyBaseUrl")||"");(0,a.useEffect)(()=>{let e=setTimeout(()=>{es(Y)},300);return()=>clearTimeout(e)},[Y]),(0,a.useEffect)(()=>()=>{$&&URL.revokeObjectURL($)},[$]);let et=(0,a.useMemo)(()=>"session"===F?e||"":ee.trim(),[F,e,ee]),el=(0,a.useMemo)(()=>j.length>0&&j.every(e=>!e.isLoading&&e.messages.some(e=>"assistant"===e.role)),[j]);(0,a.useEffect)(()=>{let e=!0;return(async()=>{if(!et)return k([]);S(!0);try{let s=await (0,v.fetchAvailableModels)(et);if(!e)return;let a=Array.from(new Set(s.map(e=>e.model_group)));k(a)}catch(s){console.error("CompareUI: failed to fetch models",s),e&&k([])}finally{e&&S(!1)}})(),()=>{e=!1}},[et]),(0,a.useEffect)(()=>{let e=!0;return(async()=>{if(!et||!U)return T([]);L(!0);try{let s=await (0,f.fetchAvailableAgents)(et,ea||void 0);if(!e)return;T(s)}catch(s){console.error("CompareUI: failed to fetch agents",s),e&&T([])}finally{e&&L(!1)}})(),()=>{e=!1}},[et,U]),(0,a.useEffect)(()=>{0!==N.length&&b(e=>e.map((e,s)=>({...e,temperature:e.temperature??1,maxTokens:e.maxTokens??2048,applyAcrossModels:e.applyAcrossModels??!1,useAdvancedParams:e.useAdvancedParams??!1,...e.model?{}:{model:N[s%N.length]??""}})))},[N]);let er=()=>{$&&URL.revokeObjectURL($),B(null),D(null)},en=(e,s)=>{b(a=>a.map(a=>{if(a.id!==e)return a;let t=[...a.messages],l=t[t.length-1];return l&&"assistant"===l.role?t[t.length-1]={...l,timeToFirstToken:s}:l&&"user"===l.role&&t.push({role:"assistant",content:"",timeToFirstToken:s}),{...a,messages:t}}))},ei=(e,s)=>{b(a=>a.map(a=>{if(a.id!==e)return a;let t=[...a.messages],l=t[t.length-1];return l&&"assistant"===l.role?t[t.length-1]={...l,totalLatency:s}:l&&"user"===l.role&&t.push({role:"assistant",content:"",totalLatency:s}),{...a,messages:t}}))},eo=!!e,ed=async e=>{let s=e.trim(),a=!!E;if(!s&&!a)return;if(!et)return void l.default.fromBackend("请提供虚拟密钥，或选择“当前 UI 会话”");if(0===j.length)return;if(j.some(e=>{let s;return!((s=W(e,P))&&s.trim())}))return void l.default.fromBackend(R.validationMessage);let t=a?await (0,g.createChatMultimodalMessage)(s,E):{role:"user",content:s},r=(0,g.createChatDisplayMessage)(s,a,$||void 0,E?.name),n=new Map;j.forEach(e=>{let a=e.traceId??(0,x.v4)(),l=[...e.messages.map(({role:e,content:s})=>({role:e,content:Array.isArray(s)||"string"==typeof s?s:""})),t];n.set(e.id,{id:e.id,model:e.model,agent:e.agent,inputMessage:s,traceId:a,tags:e.tags,vectorStores:e.vectorStores,guardrails:e.guardrails,temperature:e.temperature,maxTokens:e.maxTokens,displayMessages:[...e.messages,r],apiChatHistory:l})}),0!==n.size&&(b(e=>e.map(e=>{let s=n.get(e.id);return s?{...e,traceId:s.traceId,messages:s.displayMessages,isLoading:!0}:e})),_(""),er(),n.forEach(e=>{let s=e.tags.length>0?e.tags:void 0,a=e.vectorStores.length>0?e.vectorStores:void 0,t=e.guardrails.length>0?e.guardrails:void 0,r=j.find(s=>s.id===e.id),n=r?.useAdvancedParams??!1;(U?(0,y.makeA2AStreamMessageRequest)(e.agent,e.inputMessage,(s,a)=>{b(t=>t.map(t=>{if(t.id!==e.id)return t;let l=[...t.messages],r=l[l.length-1];return r&&"assistant"===r.role?l[l.length-1]={...r,content:s,model:r.model??a}:l.push({role:"assistant",content:s,model:a}),{...t,messages:l}}))},et,void 0,s=>en(e.id,s),s=>ei(e.id,s),void 0,ea||void 0):(0,p.makeOpenAIChatCompletionRequest)(e.apiChatHistory,(s,a)=>{var t;return t=e.id,void(s&&b(e=>e.map(e=>{if(e.id!==t)return e;let l=[...e.messages],r=l[l.length-1];if(r&&"assistant"===r.role){let e="string"==typeof r.content?r.content:"";l[l.length-1]={...r,content:e+s,model:r.model??a}}else l.push({role:"assistant",content:s,model:a});return{...e,messages:l}})))},e.model,et,s,void 0,s=>{var a;return a=e.id,void(s&&b(e=>e.map(e=>{if(e.id!==a)return e;let t=[...e.messages],l=t[t.length-1];return l&&"assistant"===l.role?t[t.length-1]={...l,reasoningContent:(l.reasoningContent||"")+s}:l&&"user"===l.role&&t.push({role:"assistant",content:"",reasoningContent:s}),{...e,messages:t}})))},s=>en(e.id,s),s=>{var a;return a=e.id,void b(e=>e.map(e=>{if(e.id!==a)return e;let t=[...e.messages],l=t[t.length-1];return l&&"assistant"===l.role&&(t[t.length-1]={...l,usage:s,toolName:void 0}),{...e,messages:t}}))},e.traceId,a,t,void 0,void 0,void 0,s=>{var a;return a=e.id,void(s&&b(e=>e.map(e=>{if(e.id!==a)return e;let t=[...e.messages],l=t[t.length-1];return l&&"assistant"===l.role&&(t[t.length-1]={...l,searchResults:s}),{...e,messages:t}})))},n?e.temperature:void 0,n?e.maxTokens:void 0,s=>ei(e.id,s),ea||void 0)).catch(s=>{let a=s instanceof Error?s.message:String(s);console.error("CompareUI: failed to fetch response",s),l.default.fromBackend(a),b(s=>s.map(s=>{if(s.id!==e.id)return s;let t=[...s.messages],l=t[t.length-1],r=l&&"assistant"===l.role&&"string"==typeof l.content?l.content:"";return l&&"assistant"===l.role?t[t.length-1]={...l,content:r?`${r}
获取响应失败：${a}`:`获取响应失败：${a}`}:t.push({role:"assistant",content:`获取响应失败：${a}`}),{...s,messages:t}}))}).finally(()=>{b(s=>s.map(s=>s.id===e.id?{...s,isLoading:!1}:s))})}))},ec=e=>{_(e)},em=j.some(e=>e.messages.length>0),eu=j.some(e=>e.isLoading),ex=!!E,eh=!!E?.name.toLowerCase().endsWith(".pdf"),eg=!em&&!eu&&!ex;return(0,s.jsx)("div",{className:"w-full h-full p-4 bg-white",children:(0,s.jsxs)("div",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm min-h-[calc(100vh-160px)] flex flex-col",children:[(0,s.jsx)("div",{className:"border-b px-4 py-2",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"虚拟密钥来源"}),(0,s.jsxs)(m.Select,{value:F,onChange:e=>X(e),disabled:t,className:"w-48",children:[(0,s.jsx)(m.Select.Option,{value:"session",disabled:!eo,children:"当前 UI 会话"}),(0,s.jsx)(m.Select.Option,{value:"custom",children:"虚拟密钥"})]}),"custom"===F&&(0,s.jsx)(c.Input.Password,{value:Y,onChange:e=>G(e.target.value),placeholder:"输入虚拟密钥",className:"w-56"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"端点"}),(0,s.jsx)(m.Select,{value:P,onChange:e=>M(e),className:"w-56",children:Object.values(q).map(e=>({value:e.id,label:e.label})).map(e=>(0,s.jsx)(m.Select.Option,{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(d.Button,{onClick:()=>{b(e=>e.map(e=>({...e,messages:[],traceId:void 0,isLoading:!1}))),_(""),er()},disabled:!em,icon:(0,s.jsx)(r.ClearOutlined,{}),children:"清空全部对话"}),(0,s.jsx)(u.Tooltip,{title:j.length>=3?"最多可同时对比 3 个模型":"添加一个对比栏",children:(0,s.jsx)(d.Button,{onClick:()=>{if(j.length>=3)return;let e=N[j.length%(N.length||1)]??"",s=w[j.length%(w.length||1)]?.agent_name??"",a={id:Date.now().toString(),model:e,agent:s,messages:[],isLoading:!1,tags:[],mcpTools:[],vectorStores:[],guardrails:[],temperature:1,maxTokens:2048,applyAcrossModels:!1,useAdvancedParams:!1};b(e=>[...e,a])},disabled:j.length>=3,icon:(0,s.jsx)(o.PlusOutlined,{}),children:"添加对比"})})]})]})}),(0,s.jsx)("div",{className:"grid flex-1 min-h-0 auto-rows-[minmax(0,1fr)]",style:{gridTemplateColumns:`repeat(${j.length}, minmax(0, 1fr))`},children:j.map(e=>(0,s.jsx)(V,{comparison:e,onUpdate:(s,a)=>{var t;return t=e.id,void b(e=>{if(a?.applyToAll&&a.keysToApply?.length){let l={};a.keysToApply.forEach(e=>{let a=s[e];void 0!==a&&(l[e]=Array.isArray(a)?[...a]:a)});let r=Object.keys(l).length>0;return e.map(e=>e.id===t?{...e,...s}:r?{...e,...l}:e)}return e.map(e=>e.id===t?{...e,...s}:e)})},onRemove:()=>{var s;return s=e.id,void(j.length>1&&b(e=>e.filter(e=>e.id!==s)))},canRemove:j.length>1,selectorOptions:O,isLoadingOptions:I,endpointConfig:R,apiKey:et},e.id))}),(0,s.jsx)("div",{className:"flex justify-center pb-4",children:(0,s.jsx)("div",{className:"w-full max-w-3xl px-4",children:(0,s.jsxs)("div",{className:"border border-gray-200 shadow-lg rounded-xl bg-white p-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-between gap-4 mb-3 min-h-8",children:ex?(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"附件已就绪，可发送"}):eg?(0,s.jsx)("div",{className:"flex items-center gap-2 overflow-x-auto",children:Z.map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>ec(e),className:"shrink-0 rounded-full border border-gray-200 px-3 py-1 text-xs font-medium text-gray-600 transition-colors hover:bg-gray-100 cursor-pointer",children:e},e))}):el&&!ex?(0,s.jsx)("div",{className:"flex items-center gap-2 overflow-x-auto",children:Q.map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>ec(e),className:"shrink-0 rounded-full border border-gray-200 px-3 py-1 text-xs font-medium text-gray-600 transition-colors hover:bg-gray-100 cursor-pointer",children:e},e))}):eu?(0,s.jsxs)("span",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,s.jsx)("span",{className:"h-2 w-2 rounded-full bg-blue-500 animate-pulse","aria-hidden":!0}),R.loadingMessage]}):(0,s.jsx)("span",{className:"text-sm text-gray-500",children:R.inputPlaceholder})}),E&&(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,s.jsx)("div",{className:"relative inline-block",children:eh?(0,s.jsx)("div",{className:"w-10 h-10 rounded-md bg-red-500 flex items-center justify-center",children:(0,s.jsx)(i.FilePdfOutlined,{style:{fontSize:"16px",color:"white"}})}):(0,s.jsx)("img",{src:$||"",alt:"Upload preview",className:"w-10 h-10 rounded-md border border-gray-200 object-cover"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:E.name}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:eh?"PDF":"图片"})]}),(0,s.jsx)("button",{className:"flex items-center justify-center w-6 h-6 text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded-full transition-colors",onClick:er,children:(0,s.jsx)(n.DeleteOutlined,{style:{fontSize:"12px"}})})]})}),(0,s.jsx)(J,{value:z,onChange:e=>{_(e)},onSend:()=>{ed(z)},disabled:0===j.length||j.every(e=>e.isLoading),hasAttachment:ex,uploadComponent:(0,s.jsx)(h.default,{chatUploadedImage:E,chatImagePreviewUrl:$,onImageUpload:e=>($&&URL.revokeObjectURL($),B(e),D(URL.createObjectURL(e)),!1),onRemoveImage:er})})]})})})]})})}var es=e.i(653824),ea=e.i(881073),et=e.i(197647),el=e.i(723731),er=e.i(404206),en=e.i(135214),ei=e.i(62478),eo=e.i(213548);function ed(){let{accessToken:e,userRole:l,userId:r,disabledPersonalKeyCreation:n,token:i}=(0,en.default)(),o=(0,eo.buildTranslationsForLocale)("zh-CN"),d=(0,eo.buildTranslationsForLocale)("en-US"),c=(e,s)=>{let a=s.split("."),t=e;for(let e of a)if(!t||"object"!=typeof t||!(e in t))return null;else t=t[e];return"string"==typeof t?t:null},m=(e,s)=>c(o,e)||c(d,e)||s,[u,x]=(0,a.useState)(void 0);return(0,a.useEffect)(()=>{(async()=>{if(e){let s=await (0,ei.fetchProxySettings)(e);s&&x({PROXY_BASE_URL:s.PROXY_BASE_URL,LITELLM_UI_API_DOC_BASE_URL:s.LITELLM_UI_API_DOC_BASE_URL})}})()},[e]),(0,s.jsxs)(es.TabGroup,{className:"h-full w-full",children:[(0,s.jsxs)(ea.TabList,{className:"mb-0",children:[(0,s.jsx)(et.Tab,{children:m("playground.tabs.chat","Chat")}),(0,s.jsx)(et.Tab,{children:m("playground.tabs.compare","Compare")})]}),(0,s.jsxs)(el.TabPanels,{className:"h-full",children:[(0,s.jsx)(er.TabPanel,{className:"h-full",children:(0,s.jsx)(t.default,{accessToken:e,token:i,userRole:l,userID:r,disabledPersonalKeyCreation:n,proxySettings:u})}),(0,s.jsx)(er.TabPanel,{className:"h-full",children:(0,s.jsx)(ee,{accessToken:e,disabledPersonalKeyCreation:n})})]})]})}e.s(["default",()=>ed],213970)}]);